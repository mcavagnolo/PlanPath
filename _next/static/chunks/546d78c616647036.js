(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,72906,e=>{"use strict";let t,r,i;var n,s,a,o,l,h,u,c,d,f,p,g,m,y,v,_,w,E,b,I,T=e.i(43476),S=e.i(71645),C=e.i(47167);let A=function(e){let t=[],r=0;for(let i=0;i<e.length;i++){let n=e.charCodeAt(i);n<128?t[r++]=n:(n<2048?t[r++]=n>>6|192:((64512&n)==55296&&i+1<e.length&&(64512&e.charCodeAt(i+1))==56320?(n=65536+((1023&n)<<10)+(1023&e.charCodeAt(++i)),t[r++]=n>>18|240,t[r++]=n>>12&63|128):t[r++]=n>>12|224,t[r++]=n>>6&63|128),t[r++]=63&n|128)}return t},k=function(e){let t=[],r=0,i=0;for(;r<e.length;){let n=e[r++];if(n<128)t[i++]=String.fromCharCode(n);else if(n>191&&n<224){let s=e[r++];t[i++]=String.fromCharCode((31&n)<<6|63&s)}else if(n>239&&n<365){let s=((7&n)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++])-65536;t[i++]=String.fromCharCode(55296+(s>>10)),t[i++]=String.fromCharCode(56320+(1023&s))}else{let s=e[r++],a=e[r++];t[i++]=String.fromCharCode((15&n)<<12|(63&s)<<6|63&a)}}return t.join("")},R={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();let r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let t=0;t<e.length;t+=3){let n=e[t],s=t+1<e.length,a=s?e[t+1]:0,o=t+2<e.length,l=o?e[t+2]:0,h=n>>2,u=(3&n)<<4|a>>4,c=(15&a)<<2|l>>6,d=63&l;!o&&(d=64,s||(c=64)),i.push(r[h],r[u],r[c],r[d])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(A(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):k(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();let r=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let t=0;t<e.length;){let n=r[e.charAt(t++)],s=t<e.length?r[e.charAt(t)]:0,a=++t<e.length?r[e.charAt(t)]:64,o=++t<e.length?r[e.charAt(t)]:64;if(++t,null==n||null==s||null==a||null==o)throw new N;let l=n<<2|s>>4;if(i.push(l),64!==a){let e=s<<4&240|a>>2;if(i.push(e),64!==o){let e=a<<6&192|o;i.push(e)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class N extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}let O=function(e){let t=A(e);return R.encodeByteArray(t,!0)},P=function(e){return O(e).replace(/\./g,"")},D=function(e){try{return R.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null},x=()=>{try{return("undefined"!=typeof self?self:"undefined"!=typeof window?window:e.g).__FIREBASE_DEFAULTS__||(()=>{if(void 0===C.default||void 0===C.default.env)return;let e=C.default.env.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)})()||(()=>{let e;if("undefined"==typeof document)return;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}let t=e&&D(e[1]);return t&&JSON.parse(t)})()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},L=e=>x()?.emulatorHosts?.[e],M=e=>{let t=L(e);if(!t)return;let r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw Error(`Invalid host ${t} with no separate hostname and port!`);let i=parseInt(t.substring(r+1),10);return"["===t[0]?[t.substring(1,r-1),i]:[t.substring(0,r),i]},U=()=>x()?.config,V=e=>x()?.[`_${e}`];class F{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,r))}}}function j(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch{return!1}}async function B(e){return(await fetch(e,{credentials:"include"})).ok}function $(e,t){if(e.uid)throw Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let r=t||"demo-project",i=e.iat||0,n=e.sub||e.user_id;if(!n)throw Error("mockUserToken must contain 'sub' or 'user_id' field!");let s={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:n,user_id:n,firebase:{sign_in_provider:"custom",identities:{}},...e};return[P(JSON.stringify({alg:"none",type:"JWT"})),P(JSON.stringify(s)),""].join(".")}let H={},z=!1;function q(e,t){if("undefined"==typeof window||"undefined"==typeof document||!j(window.location.host)||H[e]===t||H[e]||z)return;function r(e){return`__firebase__banner__${e}`}H[e]=t;let i="__firebase__banner",n=function(){let e={prod:[],emulator:[]};for(let t of Object.keys(H))H[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function s(){let e,t,s=(e=document.getElementById(i),t=!1,e||((e=document.createElement("div")).setAttribute("id",i),t=!0),{created:t,element:e}),a=r("text"),o=document.getElementById(a)||document.createElement("span"),l=r("learnmore"),h=document.getElementById(l)||document.createElement("a"),u=r("preprendIcon"),c=document.getElementById(u)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(s.created){let e,t=s.element;t.style.display="flex",t.style.background="#7faaf0",t.style.position="fixed",t.style.bottom="5px",t.style.left="5px",t.style.padding=".5em",t.style.borderRadius="5px",t.style.alignItems="center",h.setAttribute("id",l),h.innerText="Learn more",h.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",h.setAttribute("target","__blank"),h.style.paddingLeft="5px",h.style.textDecoration="underline";let r=((e=document.createElement("span")).style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{let e;z=!0,(e=document.getElementById(i))&&e.remove()},e);c.setAttribute("width","24"),c.setAttribute("id",u),c.setAttribute("height","24"),c.setAttribute("viewBox","0 0 24 24"),c.setAttribute("fill","none"),c.style.marginLeft="-6px",t.append(c,o,h,r),document.body.appendChild(t)}n?(o.innerText="Preview backend disconnected.",c.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(c.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,o.innerText="Preview backend running in this workspace."),o.setAttribute("id",a)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",s):s()}function K(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function W(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}class G extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name="FirebaseError",Object.setPrototypeOf(this,G.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,J.prototype.create)}}class J{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){var r,i;let n=t[0]||{},s=`${this.service}/${e}`,a=this.errors[e],o=a?(r=a,i=n,r.replace(X,(e,t)=>{let r=i[t];return null!=r?String(r):`<${t}?>`})):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new G(s,l,n)}}let X=/\{\$([^}]+)}/g;function Q(e,t){if(e===t)return!0;let r=Object.keys(e),i=Object.keys(t);for(let n of r){if(!i.includes(n))return!1;let r=e[n],s=t[n];if(Y(r)&&Y(s)){if(!Q(r,s))return!1}else if(r!==s)return!1}for(let e of i)if(!r.includes(e))return!1;return!0}function Y(e){return null!==e&&"object"==typeof e}function Z(e){let t=[];for(let[r,i]of Object.entries(e))Array.isArray(i)?i.forEach(e=>{t.push(encodeURIComponent(r)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(r)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}function ee(e){let t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){let[r,i]=e.split("=");t[decodeURIComponent(r)]=decodeURIComponent(i)}}),t}function et(e){let t=e.indexOf("?");if(!t)return"";let r=e.indexOf("#",t);return e.substring(t,r>0?r:void 0)}class er{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(void 0===e&&void 0===t&&void 0===r)throw Error("Missing Observer.");void 0===(i=!function(e,t){if("object"!=typeof e||null===e)return!1;for(let r of t)if(r in e&&"function"==typeof e[r])return!0;return!1}(e,["next","error","complete"])?{next:e,error:t,complete:r}:e).next&&(i.next=ei),void 0===i.error&&(i.error=ei),void 0===i.complete&&(i.complete=ei);let n=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(e){}}),this.observers.push(i),n}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ei(){}function en(e){return e&&e._delegate?e._delegate:e}class es{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}let ea="[DEFAULT]";class eo{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let e=new F;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{let r=this.getOrInitializeService({instanceIdentifier:t});r&&e.resolve(r)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){let t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(e){if(r)return null;throw e}if(r)return null;throw Error(`Service ${this.name} is not available`)}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if("EAGER"===e.instantiationMode)try{this.getOrInitializeService({instanceIdentifier:ea})}catch(e){}for(let[e,t]of this.instancesDeferred.entries()){let r=this.normalizeInstanceIdentifier(e);try{let e=this.getOrInitializeService({instanceIdentifier:r});t.resolve(e)}catch(e){}}}}clearInstance(e=ea){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(e=ea){return this.instances.has(e)}getOptions(e=ea){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[e,t]of this.instancesDeferred.entries())r===this.normalizeInstanceIdentifier(e)&&t.resolve(i);return i}onInit(e,t){let r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);let n=this.instances.get(r);return n&&e(n,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){var r;let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e)===ea?void 0:r,options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=ea){return this.component?this.component.multipleInstances?e:ea:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class el{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new eo(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}let eh=[];(n=l||(l={}))[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT";let eu={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},ec=l.INFO,ed={[l.DEBUG]:"log",[l.VERBOSE]:"log",[l.INFO]:"info",[l.WARN]:"warn",[l.ERROR]:"error"},ef=(e,t,...r)=>{if(t<e.logLevel)return;let i=new Date().toISOString(),n=ed[t];if(n)console[n](`[${i}]  ${e.name}:`,...r);else throw Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class ep{constructor(e){this.name=e,this._logLevel=ec,this._logHandler=ef,this._userLogHandler=null,eh.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in l))throw TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?eu[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,l.DEBUG,...e),this._logHandler(this,l.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,l.VERBOSE,...e),this._logHandler(this,l.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,l.INFO,...e),this._logHandler(this,l.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,l.WARN,...e),this._logHandler(this,l.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,l.ERROR,...e),this._logHandler(this,l.ERROR,...e)}}let eg=new WeakMap,em=new WeakMap,ey=new WeakMap,ev=new WeakMap,e_=new WeakMap,ew={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return em.get(e);if("objectStoreNames"===t)return e.objectStoreNames||ey.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return eE(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function eE(e){if(e instanceof IDBRequest){let t;return(t=new Promise((t,r)=>{let i=()=>{e.removeEventListener("success",n),e.removeEventListener("error",s)},n=()=>{t(eE(e.result)),i()},s=()=>{r(e.error),i()};e.addEventListener("success",n),e.addEventListener("error",s)})).then(t=>{t instanceof IDBCursor&&eg.set(t,e)}).catch(()=>{}),e_.set(t,e),t}if(ev.has(e))return ev.get(e);let i=function(e){if("function"==typeof e)return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(r||(r=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(eb(this),t),eE(eg.get(this))}:function(...t){return eE(e.apply(eb(this),t))}:function(t,...r){let i=e.call(eb(this),t,...r);return ey.set(i,t.sort?t.sort():[t]),eE(i)};return e instanceof IDBTransaction&&function(e){if(em.has(e))return;let t=new Promise((t,r)=>{let i=()=>{e.removeEventListener("complete",n),e.removeEventListener("error",s),e.removeEventListener("abort",s)},n=()=>{t(),i()},s=()=>{r(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",n),e.addEventListener("error",s),e.addEventListener("abort",s)});em.set(e,t)}(e),(t||(t=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(t=>e instanceof t)?new Proxy(e,ew):e}(e);return i!==e&&(ev.set(e,i),e_.set(i,e)),i}let eb=e=>e_.get(e),eI=["get","getKey","getAll","getAllKeys","count"],eT=["put","add","delete","clear"],eS=new Map;function eC(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(eS.get(t))return eS.get(t);let r=t.replace(/FromIndex$/,""),i=t!==r,n=eT.includes(r);if(!(r in(i?IDBIndex:IDBObjectStore).prototype)||!(n||eI.includes(r)))return;let s=async function(e,...t){let s=this.transaction(e,n?"readwrite":"readonly"),a=s.store;return i&&(a=a.index(t.shift())),(await Promise.all([a[r](...t),n&&s.done]))[0]};return eS.set(t,s),s}ew={...i=ew,get:(e,t,r)=>eC(e,t)||i.get(e,t,r),has:(e,t)=>!!eC(e,t)||i.has(e,t)};class eA{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{let t;if(t=e.getComponent(),t?.type!=="VERSION")return null;{let t=e.getImmediate();return`${t.library}/${t.version}`}}).filter(e=>e).join(" ")}}let ek="@firebase/app",eR="0.14.6",eN=new ep("@firebase/app"),eO="[DEFAULT]",eP={[ek]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/data-connect":"fire-data-connect","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","@firebase/ai":"fire-vertex","fire-js":"fire-js",firebase:"fire-js-all"},eD=new Map,ex=new Map,eL=new Map;function eM(e,t){try{e.container.addComponent(t)}catch(r){eN.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,r)}}function eU(e,t){e.container.addOrOverwriteComponent(t)}function eV(e){let t=e.name;if(eL.has(t))return eN.debug(`There were multiple attempts to register component ${t}.`),!1;for(let r of(eL.set(t,e),eD.values()))eM(r,e);for(let t of ex.values())eM(t,e);return!0}function eF(e,t){let r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}function ej(e,t,r=eO){eF(e,t).clearInstance(r)}function eB(e){return void 0!==e.options}function e$(e){return!eB(e)&&("authIdToken"in e||"appCheckToken"in e||"releaseOnDeref"in e||"automaticDataCollectionEnabled"in e)}function eH(e){return null!=e&&void 0!==e.settings}function ez(){eL.clear()}let eq=new J("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class eK{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new es("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw eq.create("app-deleted",{appName:this._name})}}function eW(e,t){let r=D(e.split(".")[1]);null===r?console.error(`FirebaseServerApp ${t} is invalid: second part could not be parsed.`):void 0===JSON.parse(r).exp?console.error(`FirebaseServerApp ${t} is invalid: expiration claim could not be parsed`):1e3*JSON.parse(r).exp-new Date().getTime()<=0&&console.error(`FirebaseServerApp ${t} is invalid: the token has expired.`)}class eG extends eK{constructor(e,t,r,i){const n=void 0===t.automaticDataCollectionEnabled||t.automaticDataCollectionEnabled,s={name:r,automaticDataCollectionEnabled:n};void 0!==e.apiKey?super(e,s,i):super(e.options,s,i),this._serverConfig={automaticDataCollectionEnabled:n,...t},this._serverConfig.authIdToken&&eW(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&eW(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,"undefined"!=typeof FinalizationRegistry&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,e1(ek,eR,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,void 0!==e&&null!==this._finalizationRegistry&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){e0(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw eq.create("server-app-deleted")}}let eJ="12.6.0";function eX(e,t={}){let r=e;"object"!=typeof t&&(t={name:t});let i={name:eO,automaticDataCollectionEnabled:!0,...t},n=i.name;if("string"!=typeof n||!n)throw eq.create("bad-app-name",{appName:String(n)});if(r||(r=U()),!r)throw eq.create("no-options");let s=eD.get(n);if(s)if(Q(r,s.options)&&Q(i,s.config))return s;else throw eq.create("duplicate-app",{appName:n});let a=new el(n);for(let e of eL.values())a.addComponent(e);let o=new eK(r,i,a);return eD.set(n,o),o}function eQ(e,t={}){let r;if(("undefined"!=typeof window||W())&&!W())throw eq.create("invalid-server-app-environment");let i=t||{};if(e&&(eB(e)?r=e.options:e$(e)?i=e:r=e),void 0===i.automaticDataCollectionEnabled&&(i.automaticDataCollectionEnabled=!0),r||(r=U()),!r)throw eq.create("no-options");let n={...i,...r};if(void 0!==n.releaseOnDeref&&delete n.releaseOnDeref,void 0!==i.releaseOnDeref&&"undefined"==typeof FinalizationRegistry)throw eq.create("finalization-registry-not-supported",{});let s=""+[...JSON.stringify(n)].reduce((e,t)=>Math.imul(31,e)+t.charCodeAt(0)|0,0),a=ex.get(s);if(a)return a.incRefCount(i.releaseOnDeref),a;let o=new el(s);for(let e of eL.values())o.addComponent(e);let l=new eG(r,i,s,o);return ex.set(s,l),l}function eY(e=eO){let t=eD.get(e);if(!t&&e===eO&&U())return eX();if(!t)throw eq.create("no-app",{appName:e});return t}function eZ(){return Array.from(eD.values())}async function e0(e){let t=!1,r=e.name;eD.has(r)?(t=!0,eD.delete(r)):ex.has(r)&&0>=e.decRefCount()&&(ex.delete(r),t=!0),t&&(await Promise.all(e.container.getProviders().map(e=>e.delete())),e.isDeleted=!0)}function e1(e,t,r){let i=eP[e]??e;r&&(i+=`-${r}`);let n=i.match(/\s|\//),s=t.match(/\s|\//);if(n||s){let e=[`Unable to register library "${i}" with version "${t}":`];n&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),n&&s&&e.push("and"),s&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),eN.warn(e.join(" "));return}eV(new es(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}function e2(e,t){if(null!==e&&"function"!=typeof e)throw eq.create("invalid-log-argument");for(let r of eh){let i=null;t&&t.level&&(i=eu[t.level]),null===e?r.userLogHandler=null:r.userLogHandler=(t,r,...n)=>{let s=n.map(e=>{if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}}).filter(e=>e).join(" ");r>=(i??t.logLevel)&&e({level:l[r].toLowerCase(),message:s,args:n,type:t.name})}}}function e6(e){eh.forEach(t=>{t.setLogLevel(e)})}let e3="firebase-heartbeat-store",e4=null;function e5(){return e4||(e4=(function(e,t,{blocked:r,upgrade:i,blocking:n,terminated:s}={}){let a=indexedDB.open(e,1),o=eE(a);return i&&a.addEventListener("upgradeneeded",e=>{i(eE(a.result),e.oldVersion,e.newVersion,eE(a.transaction),e)}),r&&a.addEventListener("blocked",e=>r(e.oldVersion,e.newVersion,e)),o.then(e=>{s&&e.addEventListener("close",()=>s()),n&&e.addEventListener("versionchange",e=>n(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o})("firebase-heartbeat-database",0,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(e3)}catch(e){console.warn(e)}}}).catch(e=>{throw eq.create("idb-open",{originalErrorMessage:e.message})})),e4}async function e8(e){try{let t=(await e5()).transaction(e3),r=await t.objectStore(e3).get(e9(e));return await t.done,r}catch(e){if(e instanceof G)eN.warn(e.message);else{let t=eq.create("idb-get",{originalErrorMessage:e?.message});eN.warn(t.message)}}}async function e7(e,t){try{let r=(await e5()).transaction(e3,"readwrite"),i=r.objectStore(e3);await i.put(t,e9(e)),await r.done}catch(e){if(e instanceof G)eN.warn(e.message);else{let t=eq.create("idb-set",{originalErrorMessage:e?.message});eN.warn(t.message)}}}function e9(e){return`${e.name}!${e.options.appId}`}class te{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new tr(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){try{let e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=tt();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===t||this._heartbeatsCache.heartbeats.some(e=>e.date===t))return;if(this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats.length>30){let e=function(e){if(0===e.length)return -1;let t=0,r=e[0].date;for(let i=1;i<e.length;i++)e[i].date<r&&(r=e[i].date,t=i);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){eN.warn(e)}}async getHeartbeatsHeader(){try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||0===this._heartbeatsCache.heartbeats.length)return"";let e=tt(),{heartbeatsToSend:t,unsentEntries:r}=function(e,t=1024){let r=[],i=e.slice();for(let n of e){let e=r.find(e=>e.agent===n.agent);if(e){if(e.dates.push(n.date),ti(r)>t){e.dates.pop();break}}else if(r.push({agent:n.agent,dates:[n.date]}),ti(r)>t){r.pop();break}i=i.slice(1)}return{heartbeatsToSend:r,unsentEntries:i}}(this._heartbeatsCache.heartbeats),i=P(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return eN.warn(e),""}}}function tt(){return new Date().toISOString().substring(0,10)}class tr{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!function(){try{return"object"==typeof indexedDB}catch(e){return!1}}()&&new Promise((e,t)=>{try{let r=!0,i="validate-browser-context-for-indexeddb-analytics-module",n=self.indexedDB.open(i);n.onsuccess=()=>{n.result.close(),r||self.indexedDB.deleteDatabase(i),e(!0)},n.onupgradeneeded=()=>{r=!1},n.onerror=()=>{t(n.error?.message||"")}}catch(e){t(e)}}).then(()=>!0).catch(()=>!1)}async read(){if(!await this._canUseIndexedDBPromise)return{heartbeats:[]};{let e=await e8(this.app);return e?.heartbeats?e:{heartbeats:[]}}}async overwrite(e){if(await this._canUseIndexedDBPromise){let t=await this.read();return e7(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){if(await this._canUseIndexedDBPromise){let t=await this.read();return e7(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:[...t.heartbeats,...e.heartbeats]})}}}function ti(e){return P(JSON.stringify({version:2,heartbeats:e})).length}eV(new es("platform-logger",e=>new eA(e),"PRIVATE")),eV(new es("heartbeat",e=>new te(e),"PRIVATE")),e1(ek,eR,""),e1(ek,eR,"esm2020"),e1("fire-js",""),e.s(["SDK_VERSION",()=>eJ,"_DEFAULT_ENTRY_NAME",()=>eO,"_addComponent",()=>eM,"_addOrOverwriteComponent",()=>eU,"_apps",()=>eD,"_clearComponents",()=>ez,"_components",()=>eL,"_getProvider",()=>eF,"_isFirebaseApp",()=>eB,"_isFirebaseServerApp",()=>eH,"_isFirebaseServerAppSettings",()=>e$,"_registerComponent",()=>eV,"_removeServiceInstance",()=>ej,"_serverApps",()=>ex,"deleteApp",()=>e0,"getApp",()=>eY,"getApps",()=>eZ,"initializeApp",()=>eX,"initializeServerApp",()=>eQ,"onLog",()=>e2,"registerVersion",()=>e1,"setLogLevel",()=>e6],92953);let tn="firebasestorage.googleapis.com",ts="storageBucket";class ta extends G{constructor(e,t,r=0){super(to(e),`Firebase Storage: ${t} (${to(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ta.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return to(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}function to(e){return"storage/"+e}function tl(){return new ta(h.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function th(e){return new ta(h.INVALID_ARGUMENT,e)}function tu(){return new ta(h.APP_DELETED,"The Firebase app was deleted.")}function tc(e,t){return new ta(h.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function td(e){throw new ta(h.INTERNAL_ERROR,"Internal error: "+e)}(s=h||(h={})).UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment";class tf{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=tf.makeFromUrl(e,t)}catch(t){return new tf(e,"")}if(""===r.path)return r;throw new ta(h.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}static makeFromUrl(e,t){let r=null,i="([A-Za-z0-9.\\-_]+)",n=RegExp("^gs://"+i+"(/(.*))?$","i");function s(e){e.path_=decodeURIComponent(e.path)}let a=t.replace(/[.]/g,"\\."),o=RegExp(`^https?://${a}/v[A-Za-z0-9_]+/b/${i}/o(/([^?#]*).*)?$`,"i"),l=t===tn?"(?:storage.googleapis.com|storage.cloud.google.com)":t,u=[{regex:n,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:o,indices:{bucket:1,path:3},postModify:s},{regex:RegExp(`^https?://${l}/${i}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:s}];for(let t=0;t<u.length;t++){let i=u[t],n=i.regex.exec(e);if(n){let e=n[i.indices.bucket],t=n[i.indices.path];t||(t=""),r=new tf(e,t),i.postModify(r);break}}if(null==r)throw new ta(h.INVALID_URL,"Invalid URL '"+e+"'.");return r}}class tp{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function tg(e){return"string"==typeof e||e instanceof String}function tm(e){return ty()&&e instanceof Blob}function ty(){return"undefined"!=typeof Blob}function tv(e,t,r,i){if(i<t)throw th(`Invalid value for '${e}'. Expected ${t} or greater.`);if(i>r)throw th(`Invalid value for '${e}'. Expected ${r} or less.`)}(a=u||(u={}))[a.NO_ERROR=0]="NO_ERROR",a[a.NETWORK_ERROR=1]="NETWORK_ERROR",a[a.ABORT=2]="ABORT";class t_{constructor(e,t,r,i,n,s,a,o,l,h,u,c=!0,d=!1){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=n,this.additionalRetryCodes_=s,this.callback_=a,this.errorCallback_=o,this.timeout_=l,this.progressCallback_=h,this.connectionFactory_=u,this.retry=c,this.isUsingEmulator=d,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()})}start_(){let e=(e,t)=>{if(t)return void e(!1,new tw(!1,null,!0));let r=this.connectionFactory_();this.pendingConnection_=r;let i=e=>{let t=e.loaded,r=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,r)};null!==this.progressCallback_&&r.addUploadProgressListener(i),r.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{var t;let n,s,a;null!==this.progressCallback_&&r.removeUploadProgressListener(i),this.pendingConnection_=null;let o=r.getErrorCode()===u.NO_ERROR,l=r.getStatus();!o||(t=this.additionalRetryCodes_,n=l>=500&&l<600,s=-1!==[408,429].indexOf(l),a=-1!==t.indexOf(l),(n||s||a)&&this.retry)?e(!1,new tw(!1,null,r.getErrorCode()===u.ABORT)):e(!0,new tw(-1!==this.successCodes_.indexOf(l),r))})},t=(e,t)=>{let r=this.resolve_,i=this.reject_,n=t.connection;if(t.wasSuccessCode)try{let e=this.callback_(n,n.getResponse());void 0!==e?r(e):r()}catch(e){i(e)}else if(null!==n){let e=tl();e.serverResponse=n.getErrorText(),i(this.errorCallback_?this.errorCallback_(n,e):e)}else i(t.canceled?this.appDelete_?tu():new ta(h.CANCELED,"User canceled the upload/download."):new ta(h.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again."))};this.canceled_?t(!1,new tw(!1,null,!0)):this.backoffId_=function(e,t,r){let i=1,n=null,s=null,a=!1,o=0,l=!1;function h(...e){l||(l=!0,t.apply(null,e))}function u(t){n=setTimeout(()=>{n=null,e(d,2===o)},t)}function c(){s&&clearTimeout(s)}function d(e,...t){let r;if(l)return void c();if(e||2===o||a){c(),h.call(null,e,...t);return}i<64&&(i*=2),1===o?(o=2,r=0):r=(i+Math.random())*1e3,u(r)}let f=!1;function p(e){f||(f=!0,c(),!l&&(null!==n?(e||(o=2),clearTimeout(n),u(0)):e||(o=1)))}return u(0),s=setTimeout(()=>{a=!0,p(!0)},r),p}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class tw{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function tE(...e){let t="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0;if(void 0!==t){let r=new t;for(let t=0;t<e.length;t++)r.append(e[t]);return r.getBlob()}if(ty())return new Blob(e);throw new ta(h.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}let tb="base64",tI="base64url",tT="data_url";class tS{constructor(e,t){this.data=e,this.contentType=t||null}}function tC(e){let t=[];for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<=127?t.push(i):i<=2047?t.push(192|i>>6,128|63&i):(64512&i)==55296?r<e.length-1&&(64512&e.charCodeAt(r+1))==56320?(i=65536|(1023&i)<<10|1023&e.charCodeAt(++r),t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i)):t.push(239,191,189):(64512&i)==56320?t.push(239,191,189):t.push(224|i>>12,128|i>>6&63,128|63&i)}return new Uint8Array(t)}function tA(e,t){let r;switch(e){case tb:{let r=-1!==t.indexOf("-"),i=-1!==t.indexOf("_");if(r||i)throw tc(e,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case tI:{let r=-1!==t.indexOf("+"),i=-1!==t.indexOf("/");if(r||i)throw tc(e,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/")}}try{r=function(e){if("undefined"==typeof atob)throw new ta(h.UNSUPPORTED_ENVIRONMENT,"base-64 is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.");return atob(e)}(t)}catch(t){if(t.message.includes("polyfill"))throw t;throw tc(e,"Invalid character found")}let i=new Uint8Array(r.length);for(let e=0;e<r.length;e++)i[e]=r.charCodeAt(e);return i}class tk{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw tc(tT,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=t[1]||null;null!=r&&(this.base64=function(e,t){return e.length>=t.length&&e.substring(e.length-t.length)===t}(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}class tR{constructor(e,t){let r=0,i="";tm(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(!tm(this.data_))return new tR(new Uint8Array(this.data_.buffer,e,t-e),!0);{var r,i,n;let s=(r=this.data_,i=e,n=t,r.webkitSlice?r.webkitSlice(i,n):r.mozSlice?r.mozSlice(i,n):r.slice?r.slice(i,n):null);return null===s?null:new tR(s)}}static getBlob(...e){if(ty()){let t=e.map(e=>e instanceof tR?e.data_:e);return new tR(tE.apply(null,t))}{let t=e.map(e=>tg(e)?function(e,t){return new tS(tC(t))}("raw",e).data:e.data_),r=0;t.forEach(e=>{r+=e.byteLength});let i=new Uint8Array(r),n=0;return t.forEach(e=>{for(let t=0;t<e.length;t++)i[n++]=e[t]}),new tR(i,!0)}}uploadData(){return this.data_}}function tN(e){let t=e.lastIndexOf("/",e.length-2);return -1===t?e:e.slice(t+1)}function tO(e,t){return t}class tP{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||tO}}let tD=null;class tx{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}class tL{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=u.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=u.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=u.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i,n){if(this.sent_)throw td("cannot .send() more than once");if(j(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==n)for(let e in n)n.hasOwnProperty(e)&&this.xhr_.setRequestHeader(e,n[e].toString());return void 0!==i?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw td("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw td("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return -1}}getResponse(){if(!this.sent_)throw td("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw td("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class tM extends tL{initXhr(){this.xhr_.responseType="text"}}function tU(){return new tM}class tV{constructor(e,t){this._service=e,t instanceof tf?this._location=t:this._location=tf.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new tV(e,t)}get root(){let e=new tf(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return tN(this._location.path)}get storage(){return this._service}get parent(){let e=function(e){if(0===e.length)return null;let t=e.lastIndexOf("/");return -1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;let t=new tf(this._location.bucket,e);return new tV(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw new ta(h.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}}function tF(e,t){let r=t?.[ts];return null==r?null:tf.makeFromBucketSpec(r,e)}class tj{constructor(e,t,r,i,n,s=!1){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=n,this._isUsingEmulator=s,this._bucket=null,this._host=tn,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,null!=i?this._bucket=tf.makeFromBucketSpec(i,this._host):this._bucket=tF(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=tf.makeFromBucketSpec(this._url,e):this._bucket=tF(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){tv("time",0,1/0,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){tv("time",0,1/0,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){if(eH(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new tV(this,e)}_makeRequest(e,t,r,i,n=!0){if(this._deleted)return new tp(tu());{let s=function(e,t,r,i,n,s,a=!0,o=!1){let l=function(e){let t=encodeURIComponent,r="?";for(let i in e)e.hasOwnProperty(i)&&(r=r+(t(i)+"=")+t(e[i])+"&");return r.slice(0,-1)}(e.urlParams),h=e.url+l,u=Object.assign({},e.headers);return t&&(u["X-Firebase-GMPID"]=t),null!==r&&r.length>0&&(u.Authorization="Firebase "+r),u["X-Firebase-Storage-Version"]="webjs/"+(s??"AppManager"),null!==i&&(u["X-Firebase-AppCheck"]=i),new t_(h,e.method,u,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,n,a,o)}(e,this._appId,r,i,t,this._firebaseVersion,n,this._isUsingEmulator);return this._requests.add(s),s.getPromise().then(()=>this._requests.delete(s),()=>this._requests.delete(s)),s}}async makeRequestWithTokens(e,t){let[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()}}let tB="@firebase/storage",t$="0.14.0",tH="storage";function tz(e,t,r){var i;let n;return i=e=en(e),i._throwIfRoot("uploadBytes"),n=function(e,t,r,i,n){var s,a;let o,l,u=t.bucketOnlyServerUrl(),c={"X-Goog-Upload-Protocol":"multipart"},d=function(){let e="";for(let t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();c["Content-Type"]="multipart/related; boundary="+d;let f=((o=Object.assign({},n)).fullPath=t.path,o.size=i.size(),o.contentType||(o.contentType=i&&i.type()||"application/octet-stream"),o),p="--"+d+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+function(e,t){let r={},i=t.length;for(let n=0;n<i;n++){let i=t[n];i.writable&&(r[i.server]=e[i.local])}return JSON.stringify(r)}(f,r)+"\r\n--"+d+"\r\nContent-Type: "+f.contentType+"\r\n\r\n",g=tR.getBlob(p,i,"\r\n--"+d+"--");if(null===g)throw new ta(h.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.");let m={name:f.fullPath},y=(s=e.host,a=e._protocol,l=s,null==a&&(l=`https://${s}`),`${a}://${l}/v0${u}`),v=e.maxUploadRetryTime,_=new tx(y,"POST",function(t,i){let n,s=null===(n=function(e){var t;let r;try{r=JSON.parse(e)}catch(e){return null}return"object"!=typeof(t=r)||Array.isArray(t)?null:r}(i))?null:function(e,t,r){let i={};i.type="file";let n=r.length;for(let e=0;e<n;e++){let n=r[e];i[n.local]=n.xform(i,t[n.server])}return Object.defineProperty(i,"ref",{get:function(){let t=new tf(i.bucket,i.fullPath);return e._makeStorageReference(t)}}),i}(e,n,r);if(null===s)throw tl();return s},v);return _.urlParams=m,_.headers=c,_.body=g.uploadData(),_.errorHandler=function(e,r){var i,n;let s;return 401===e.getStatus()?s=e.getErrorText().includes("Firebase App Check token is invalid")?new ta(h.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project."):new ta(h.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===e.getStatus()?(i=t.bucket,s=new ta(h.QUOTA_EXCEEDED,"Quota for bucket '"+i+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===e.getStatus()?(n=t.path,s=new ta(h.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")):s=r,s.status=e.getStatus(),s.serverResponse=r.serverResponse,s},_}(i.storage,i._location,function(){if(tD)return tD;let e=[];e.push(new tP("bucket")),e.push(new tP("generation")),e.push(new tP("metageneration")),e.push(new tP("name","fullPath",!0));let t=new tP("name");t.xform=function(e,t){return!tg(t)||t.length<2?t:tN(t)},e.push(t);let r=new tP("size");return r.xform=function(e,t){return void 0!==t?Number(t):t},e.push(r),e.push(new tP("timeCreated")),e.push(new tP("updated")),e.push(new tP("md5Hash",null,!0)),e.push(new tP("cacheControl",null,!0)),e.push(new tP("contentDisposition",null,!0)),e.push(new tP("contentEncoding",null,!0)),e.push(new tP("contentLanguage",null,!0)),e.push(new tP("contentType",null,!0)),e.push(new tP("metadata","customMetadata",!0)),tD=e}(),new tR(t,!0),r),i.storage.makeRequestWithTokens(n,tU).then(e=>({metadata:e,ref:i}))}function tq(e,t){var r=e=en(e);if(!(t&&/^[A-Za-z]+:\/\//.test(t)))return function e(t,r){var i;let n,s,a;if(t instanceof tj){if(null==t._bucket)throw new ta(h.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+ts+"' property when initializing the app?");let i=new tV(t,t._bucket);return null!=r?e(i,r):i}if(void 0===r)return t;return i=t._location.path,n=r.split("/").filter(e=>e.length>0).join("/"),s=0===i.length?n:i+"/"+n,a=new tf(t._location.bucket,s),new tV(t.storage,a)}(r,t);if(r instanceof tj)return new tV(r,t);throw th("To use ref(service, url), the first argument must be a Storage instance.")}eV(new es(tH,function(e,{instanceIdentifier:t}){return new tj(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t,eJ)},"PUBLIC").setMultipleInstances(!0)),e1(tB,t$,""),e1(tB,t$,"esm2020"),e1("firebase","12.6.0","app"),e.i(92953),e.i(67034);var tK="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:e.g,tW={};(function(){function e(){this.blockSize=-1,this.blockSize=64,this.g=[,,,,],this.C=Array(this.blockSize),this.o=this.h=0,this.u()}var t=function(){this.blockSize=-1};function r(){}function i(e,t,r){r||(r=0);let i=Array(16);if("string"==typeof t)for(var n=0;n<16;++n)i[n]=t.charCodeAt(r++)|t.charCodeAt(r++)<<8|t.charCodeAt(r++)<<16|t.charCodeAt(r++)<<24;else for(n=0;n<16;++n)i[n]=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24;t=e.g[0],r=e.g[1],n=e.g[2];let s=e.g[3],a;a=t+(s^r&(n^s))+i[0]+0xd76aa478|0,a=s+(n^(t=r+(a<<7|a>>>25))&(r^n))+i[1]+0xe8c7b756|0,a=n+(r^(s=t+(a<<12|a>>>20))&(t^r))+i[2]+0x242070db|0,a=r+(t^(n=s+(a<<17|a>>>15))&(s^t))+i[3]+0xc1bdceee|0,a=t+(s^(r=n+(a<<22|a>>>10))&(n^s))+i[4]+0xf57c0faf|0,a=s+(n^(t=r+(a<<7|a>>>25))&(r^n))+i[5]+0x4787c62a|0,a=n+(r^(s=t+(a<<12|a>>>20))&(t^r))+i[6]+0xa8304613|0,a=r+(t^(n=s+(a<<17|a>>>15))&(s^t))+i[7]+0xfd469501|0,a=t+(s^(r=n+(a<<22|a>>>10))&(n^s))+i[8]+0x698098d8|0,a=s+(n^(t=r+(a<<7|a>>>25))&(r^n))+i[9]+0x8b44f7af|0,a=n+(r^(s=t+(a<<12|a>>>20))&(t^r))+i[10]+0xffff5bb1|0,a=r+(t^(n=s+(a<<17|a>>>15))&(s^t))+i[11]+0x895cd7be|0,a=t+(s^(r=n+(a<<22|a>>>10))&(n^s))+i[12]+0x6b901122|0,a=s+(n^(t=r+(a<<7|a>>>25))&(r^n))+i[13]+0xfd987193|0,a=n+(r^(s=t+(a<<12|a>>>20))&(t^r))+i[14]+0xa679438e|0,a=r+(t^(n=s+(a<<17|a>>>15))&(s^t))+i[15]+0x49b40821|0,r=n+(a<<22|a>>>10),a=t+(n^s&(r^n))+i[1]+0xf61e2562|0,t=r+(a<<5|a>>>27),a=s+(r^n&(t^r))+i[6]+0xc040b340|0,s=t+(a<<9|a>>>23),a=n+(t^r&(s^t))+i[11]+0x265e5a51|0,n=s+(a<<14|a>>>18),a=r+(s^t&(n^s))+i[0]+0xe9b6c7aa|0,r=n+(a<<20|a>>>12),a=t+(n^s&(r^n))+i[5]+0xd62f105d|0,t=r+(a<<5|a>>>27),a=s+(r^n&(t^r))+i[10]+0x2441453|0,s=t+(a<<9|a>>>23),a=n+(t^r&(s^t))+i[15]+0xd8a1e681|0,n=s+(a<<14|a>>>18),a=r+(s^t&(n^s))+i[4]+0xe7d3fbc8|0,r=n+(a<<20|a>>>12),a=t+(n^s&(r^n))+i[9]+0x21e1cde6|0,t=r+(a<<5|a>>>27),a=s+(r^n&(t^r))+i[14]+0xc33707d6|0,s=t+(a<<9|a>>>23),a=n+(t^r&(s^t))+i[3]+0xf4d50d87|0,n=s+(a<<14|a>>>18),a=r+(s^t&(n^s))+i[8]+0x455a14ed|0,r=n+(a<<20|a>>>12),a=t+(n^s&(r^n))+i[13]+0xa9e3e905|0,t=r+(a<<5|a>>>27),a=s+(r^n&(t^r))+i[2]+0xfcefa3f8|0,s=t+(a<<9|a>>>23),a=n+(t^r&(s^t))+i[7]+0x676f02d9|0,n=s+(a<<14|a>>>18),a=r+(s^t&(n^s))+i[12]+0x8d2a4c8a|0,a=t+((r=n+(a<<20|a>>>12))^n^s)+i[5]+0xfffa3942|0,a=s+((t=r+(a<<4|a>>>28))^r^n)+i[8]+0x8771f681|0,a=n+((s=t+(a<<11|a>>>21))^t^r)+i[11]+0x6d9d6122|0,a=r+((n=s+(a<<16|a>>>16))^s^t)+i[14]+0xfde5380c|0,a=t+((r=n+(a<<23|a>>>9))^n^s)+i[1]+0xa4beea44|0,a=s+((t=r+(a<<4|a>>>28))^r^n)+i[4]+0x4bdecfa9|0,a=n+((s=t+(a<<11|a>>>21))^t^r)+i[7]+0xf6bb4b60|0,a=r+((n=s+(a<<16|a>>>16))^s^t)+i[10]+0xbebfbc70|0,a=t+((r=n+(a<<23|a>>>9))^n^s)+i[13]+0x289b7ec6|0,a=s+((t=r+(a<<4|a>>>28))^r^n)+i[0]+0xeaa127fa|0,a=n+((s=t+(a<<11|a>>>21))^t^r)+i[3]+0xd4ef3085|0,a=r+((n=s+(a<<16|a>>>16))^s^t)+i[6]+0x4881d05|0,a=t+((r=n+(a<<23|a>>>9))^n^s)+i[9]+0xd9d4d039|0,a=s+((t=r+(a<<4|a>>>28))^r^n)+i[12]+0xe6db99e5|0,a=n+((s=t+(a<<11|a>>>21))^t^r)+i[15]+0x1fa27cf8|0,a=r+((n=s+(a<<16|a>>>16))^s^t)+i[2]+0xc4ac5665|0,r=n+(a<<23|a>>>9),a=t+(n^(r|~s))+i[0]+0xf4292244|0,t=r+(a<<6|a>>>26),a=s+(r^(t|~n))+i[7]+0x432aff97|0,s=t+(a<<10|a>>>22),a=n+(t^(s|~r))+i[14]+0xab9423a7|0,n=s+(a<<15|a>>>17),a=r+(s^(n|~t))+i[5]+0xfc93a039|0,r=n+(a<<21|a>>>11),a=t+(n^(r|~s))+i[12]+0x655b59c3|0,t=r+(a<<6|a>>>26),a=s+(r^(t|~n))+i[3]+0x8f0ccc92|0,s=t+(a<<10|a>>>22),a=n+(t^(s|~r))+i[10]+0xffeff47d|0,n=s+(a<<15|a>>>17),a=r+(s^(n|~t))+i[1]+0x85845dd1|0,r=n+(a<<21|a>>>11),a=t+(n^(r|~s))+i[8]+0x6fa87e4f|0,t=r+(a<<6|a>>>26),a=s+(r^(t|~n))+i[15]+0xfe2ce6e0|0,s=t+(a<<10|a>>>22),a=n+(t^(s|~r))+i[6]+0xa3014314|0,n=s+(a<<15|a>>>17),a=r+(s^(n|~t))+i[13]+0x4e0811a1|0,r=n+(a<<21|a>>>11),a=t+(n^(r|~s))+i[4]+0xf7537e82|0,t=r+(a<<6|a>>>26),a=s+(r^(t|~n))+i[11]+0xbd3af235|0,s=t+(a<<10|a>>>22),a=n+(t^(s|~r))+i[2]+0x2ad7d2bb|0,n=s+(a<<15|a>>>17),a=r+(s^(n|~t))+i[9]+0xeb86d391|0,e.g[0]=e.g[0]+t|0,e.g[1]=e.g[1]+(n+(a<<21|a>>>11))|0,e.g[2]=e.g[2]+n|0,e.g[3]=e.g[3]+s|0}function n(e,t){this.h=t;let r=[],i=!0;for(let n=e.length-1;n>=0;n--){let s=0|e[n];i&&s==t||(r[n]=s,i=!1)}this.g=r}r.prototype=t.prototype,e.F=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.D=function(e,r,i){for(var n=Array(arguments.length-2),s=2;s<arguments.length;s++)n[s-2]=arguments[s];return t.prototype[r].apply(e,n)},e.prototype.u=function(){this.g[0]=0x67452301,this.g[1]=0xefcdab89,this.g[2]=0x98badcfe,this.g[3]=0x10325476,this.o=this.h=0},e.prototype.v=function(e,t){void 0===t&&(t=e.length);let r=t-this.blockSize,n=this.C,s=this.h,a=0;for(;a<t;){if(0==s)for(;a<=r;)i(this,e,a),a+=this.blockSize;if("string"==typeof e){for(;a<t;)if(n[s++]=e.charCodeAt(a++),s==this.blockSize){i(this,n),s=0;break}}else for(;a<t;)if(n[s++]=e[a++],s==this.blockSize){i(this,n),s=0;break}}this.h=s,this.o+=t},e.prototype.A=function(){var e=Array((this.h<56?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;t=8*this.o;for(var r=e.length-8;r<e.length;++r)e[r]=255&t,t/=256;for(this.v(e),e=Array(16),t=0,r=0;r<4;++r)for(let i=0;i<32;i+=8)e[t++]=this.g[r]>>>i&255;return e};var s,a={};function o(e){var t;return -128<=e&&e<128?(t=function(e){return new n([0|e],e<0?-1:0)},Object.prototype.hasOwnProperty.call(a,e)?a[e]:a[e]=t(e)):new n([0|e],e<0?-1:0)}function l(e){if(isNaN(e)||!isFinite(e))return h;if(e<0)return g(l(-e));let t=[],r=1;for(let i=0;e>=r;i++)t[i]=e/r|0,r*=0x100000000;return new n(t,0)}var h=o(0),u=o(1),d=o(0x1000000);function f(e){if(0!=e.h)return!1;for(let t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function p(e){return -1==e.h}function g(e){let t=e.g.length,r=[];for(let i=0;i<t;i++)r[i]=~e.g[i];return new n(r,~e.h).add(u)}function m(e,t){return e.add(g(t))}function y(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function v(e,t){this.g=e,this.h=t}function _(e,t){if(f(t))throw Error("division by zero");if(f(e))return new v(h,h);if(p(e))return t=_(g(e),t),new v(g(t.g),g(t.h));if(p(t))return t=_(e,g(t)),new v(g(t.g),t.h);if(e.g.length>30){if(p(e)||p(t))throw Error("slowDivide_ only works with positive integers.");for(var r=u,i=t;0>=i.l(e);)r=w(r),i=w(i);var n=E(r,1),s=E(i,1);for(i=E(i,2),r=E(r,2);!f(i);){var a=s.add(i);0>=a.l(e)&&(n=n.add(r),s=a),i=E(i,1),r=E(r,1)}return t=m(e,n.j(t)),new v(n,t)}for(n=h;e.l(t)>=0;){for(i=(i=Math.ceil(Math.log(r=Math.max(1,Math.floor(e.m()/t.m())))/Math.LN2))<=48?1:Math.pow(2,i-48),a=(s=l(r)).j(t);p(a)||a.l(e)>0;)r-=i,a=(s=l(r)).j(t);f(s)&&(s=u),n=n.add(s),e=m(e,a)}return new v(n,e)}function w(e){let t=e.g.length+1,r=[];for(let i=0;i<t;i++)r[i]=e.i(i)<<1|e.i(i-1)>>>31;return new n(r,e.h)}function E(e,t){let r=t>>5;t%=32;let i=e.g.length-r,s=[];for(let n=0;n<i;n++)s[n]=t>0?e.i(n+r)>>>t|e.i(n+r+1)<<32-t:e.i(n+r);return new n(s,e.h)}(s=n.prototype).m=function(){if(p(this))return-g(this).m();let e=0,t=1;for(let r=0;r<this.g.length;r++){let i=this.i(r);e+=(i>=0?i:0x100000000+i)*t,t*=0x100000000}return e},s.toString=function(e){if((e=e||10)<2||36<e)throw Error("radix out of range: "+e);if(f(this))return"0";if(p(this))return"-"+g(this).toString(e);let t=l(Math.pow(e,6));var r=this;let i="";for(;;){let n=_(r,t).g,s=(((r=m(r,n.j(t))).g.length>0?r.g[0]:r.h)>>>0).toString(e);if(f(r=n))return s+i;for(;s.length<6;)s="0"+s;i=s+i}},s.i=function(e){return e<0?0:e<this.g.length?this.g[e]:this.h},s.l=function(e){return p(e=m(this,e))?-1:+!f(e)},s.abs=function(){return p(this)?g(this):this},s.add=function(e){let t=Math.max(this.g.length,e.g.length),r=[],i=0;for(let n=0;n<=t;n++){let t=i+(65535&this.i(n))+(65535&e.i(n)),s=(t>>>16)+(this.i(n)>>>16)+(e.i(n)>>>16);i=s>>>16,t&=65535,s&=65535,r[n]=s<<16|t}return new n(r,-0x80000000&r[r.length-1]?-1:0)},s.j=function(e){if(f(this)||f(e))return h;if(p(this))return p(e)?g(this).j(g(e)):g(g(this).j(e));if(p(e))return g(this.j(g(e)));if(0>this.l(d)&&0>e.l(d))return l(this.m()*e.m());let t=this.g.length+e.g.length,r=[];for(var i=0;i<2*t;i++)r[i]=0;for(i=0;i<this.g.length;i++)for(let t=0;t<e.g.length;t++){let n=this.i(i)>>>16,s=65535&this.i(i),a=e.i(t)>>>16,o=65535&e.i(t);r[2*i+2*t]+=s*o,y(r,2*i+2*t),r[2*i+2*t+1]+=n*o,y(r,2*i+2*t+1),r[2*i+2*t+1]+=s*a,y(r,2*i+2*t+1),r[2*i+2*t+2]+=n*a,y(r,2*i+2*t+2)}for(e=0;e<t;e++)r[e]=r[2*e+1]<<16|r[2*e];for(e=t;e<2*t;e++)r[e]=0;return new n(r,0)},s.B=function(e){return _(this,e).h},s.and=function(e){let t=Math.max(this.g.length,e.g.length),r=[];for(let i=0;i<t;i++)r[i]=this.i(i)&e.i(i);return new n(r,this.h&e.h)},s.or=function(e){let t=Math.max(this.g.length,e.g.length),r=[];for(let i=0;i<t;i++)r[i]=this.i(i)|e.i(i);return new n(r,this.h|e.h)},s.xor=function(e){let t=Math.max(this.g.length,e.g.length),r=[];for(let i=0;i<t;i++)r[i]=this.i(i)^e.i(i);return new n(r,this.h^e.h)},e.prototype.digest=e.prototype.A,e.prototype.reset=e.prototype.u,e.prototype.update=e.prototype.v,tW.Md5=e,n.prototype.add=n.prototype.add,n.prototype.multiply=n.prototype.j,n.prototype.modulo=n.prototype.B,n.prototype.compare=n.prototype.l,n.prototype.toNumber=n.prototype.m,n.prototype.toString=n.prototype.toString,n.prototype.getBits=n.prototype.i,n.fromNumber=l,n.fromString=function e(t,r){if(0==t.length)throw Error("number format error: empty string");if((r=r||10)<2||36<r)throw Error("radix out of range: "+r);if("-"==t.charAt(0))return g(e(t.substring(1),r));if(t.indexOf("-")>=0)throw Error('number format error: interior "-" character');let i=l(Math.pow(r,8)),n=h;for(let e=0;e<t.length;e+=8){var s=Math.min(8,t.length-e);let a=parseInt(t.substring(e,e+s),r);s<8?(s=l(Math.pow(r,s)),n=n.j(s).add(l(a))):n=(n=n.j(i)).add(l(a))}return n},c=tW.Integer=n}).apply(void 0!==tK?tK:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var tG="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:e.g,tJ={};(function(){var e,t,r=Object.defineProperty,i=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof tG&&tG];for(var t=0;t<e.length;++t){var r=e[t];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")}(this);function n(e,t){if(t)e:{var n=i;e=e.split(".");for(var s=0;s<e.length-1;s++){var a=e[s];if(!(a in n))break e;n=n[a]}(t=t(s=n[e=e[e.length-1]]))!=s&&null!=t&&r(n,e,{configurable:!0,writable:!0,value:t})}}n("Symbol.dispose",function(e){return e||Symbol("Symbol.dispose")}),n("Array.prototype.values",function(e){return e||function(){return this[Symbol.iterator]()}}),n("Object.entries",function(e){return e||function(e){var t,r=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&r.push([t,e[t]]);return r}});var s=s||{},a=this||self;function o(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function l(e,t,r){return e.call.apply(e.bind,arguments)}function h(e,t,r){return(h=l).apply(null,arguments)}function u(e,t){var r=Array.prototype.slice.call(arguments,1);return function(){var t=r.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function c(e,t){function r(){}r.prototype=t.prototype,e.Z=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.Ob=function(e,r,i){for(var n=Array(arguments.length-2),s=2;s<arguments.length;s++)n[s-2]=arguments[s];return t.prototype[r].apply(e,n)}}var w="undefined"!=typeof AsyncContext&&"function"==typeof AsyncContext.Snapshot?e=>e&&AsyncContext.Snapshot.wrap(e):e=>e;function E(e){let t=e.length;if(t>0){let r=Array(t);for(let i=0;i<t;i++)r[i]=e[i];return r}return[]}function b(e,t){for(let t=1;t<arguments.length;t++){let i=arguments[t];var r=typeof i;if("array"==(r="object"!=r?r:i?Array.isArray(i)?"array":r:"null")||"object"==r&&"number"==typeof i.length){r=e.length||0;let t=i.length||0;e.length=r+t;for(let n=0;n<t;n++)e[r+n]=i[n]}else e.push(i)}}var I=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return this.h>0?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new T,e=>e.reset());class T{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let S,C=!1,A=new class{constructor(){this.h=this.g=null}add(e,t){let r=I.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}},k=()=>{let e=Promise.resolve(void 0);S=()=>{e.then(R)}};function R(){let e;for(var t;e=null,A.g&&(e=A.g,A.g=A.g.next,A.g||(A.h=null),e.next=null),t=e;){try{t.h.call(t.g)}catch(e){!function(e){a.setTimeout(()=>{throw e},0)}(e)}I.j(t),I.h<100&&(I.h++,t.next=I.g,I.g=t)}C=!1}function N(){this.u=this.u,this.C=this.C}function O(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}N.prototype.u=!1,N.prototype.dispose=function(){this.u||(this.u=!0,this.N())},N.prototype[Symbol.dispose]=function(){this.dispose()},N.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},O.prototype.h=function(){this.defaultPrevented=!0};var P=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{let e=()=>{};a.addEventListener("test",e,t),a.removeEventListener("test",e,t)}catch(e){}return e}();function D(e){return/^[\s\xa0]*$/.test(e)}function x(e,t){O.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e&&this.init(e,t)}c(x,O),x.prototype.init=function(e,t){let r=this.type=e.type,i=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;this.target=e.target||e.srcElement,this.g=t,(t=e.relatedTarget)||("mouseover"==r?t=e.fromElement:"mouseout"==r&&(t=e.toElement)),this.relatedTarget=t,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=e.pointerType,this.state=e.state,this.i=e,e.defaultPrevented&&x.Z.h.call(this)},x.prototype.h=function(){x.Z.h.call(this);let e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var L="closure_listenable_"+(1e6*Math.random()|0),M=0;function U(e,t,r,i,n){this.listener=e,this.proxy=null,this.src=t,this.type=r,this.capture=!!i,this.ha=n,this.key=++M,this.da=this.fa=!1}function V(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function F(e,t,r){for(let i in e)t.call(r,e[i],i,e)}function j(e){let t={};for(let r in e)t[r]=e[r];return t}let B="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function $(e,t){let r,i;for(let t=1;t<arguments.length;t++){for(r in i=arguments[t])e[r]=i[r];for(let t=0;t<B.length;t++)r=B[t],Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}}function H(e){this.src=e,this.g={},this.h=0}function z(e,t){let r=t.type;if(r in e.g){var i,n=e.g[r],s=Array.prototype.indexOf.call(n,t,void 0);(i=s>=0)&&Array.prototype.splice.call(n,s,1),i&&(V(t),0==e.g[r].length&&(delete e.g[r],e.h--))}}function q(e,t,r,i){for(let n=0;n<e.length;++n){let s=e[n];if(!s.da&&s.listener==t&&!!r==s.capture&&s.ha==i)return n}return -1}H.prototype.add=function(e,t,r,i,n){let s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);let a=q(e,t,i,n);return a>-1?(t=e[a],r||(t.fa=!1)):((t=new U(t,this.src,s,!!i,n)).fa=r,e.push(t)),t};var K="closure_lm_"+(1e6*Math.random()|0),W={};function G(e,t,r,i,n,s){if(!t)throw Error("Invalid event type");let a=o(n)?!!n.capture:!!n,l=Y(e);if(l||(e[K]=l=new H(e)),(r=l.add(t,r,i,a,s)).proxy)return r;if(i=function e(t){return Q.call(e.src,e.listener,t)},r.proxy=i,i.src=e,i.listener=r,e.addEventListener)P||(n=a),void 0===n&&(n=!1),e.addEventListener(t.toString(),i,n);else if(e.attachEvent)e.attachEvent(X(t.toString()),i);else if(e.addListener&&e.removeListener)e.addListener(i);else throw Error("addEventListener and attachEvent are unavailable.");return r}function J(e){if("number"!=typeof e&&e&&!e.da){var t=e.src;if(t&&t[L])z(t.i,e);else{var r=e.type,i=e.proxy;t.removeEventListener?t.removeEventListener(r,i,e.capture):t.detachEvent?t.detachEvent(X(r),i):t.addListener&&t.removeListener&&t.removeListener(i),(r=Y(t))?(z(r,e),0==r.h&&(r.src=null,t[K]=null)):V(e)}}}function X(e){return e in W?W[e]:W[e]="on"+e}function Q(e,t){if(e.da)e=!0;else{t=new x(t,this);let r=e.listener,i=e.ha||e.src;e.fa&&J(e),e=r.call(i,t)}return e}function Y(e){return(e=e[K])instanceof H?e:null}var Z="__closure_events_fn_"+(1e9*Math.random()>>>0);function ee(e){return"function"==typeof e?e:(e[Z]||(e[Z]=function(t){return e.handleEvent(t)}),e[Z])}function et(){N.call(this),this.i=new H(this),this.M=this,this.G=null}function er(e,t){let r,i;var n,s=e.G;if(s)for(n=[];s;s=s.G)n.push(s);if(e=e.M,s=t.type||t,"string"==typeof t)t=new O(t,e);else if(t instanceof O)t.target=t.target||e;else{var a=t;$(t=new O(s,e),a)}if(a=!0,n)for(i=n.length-1;i>=0;i--)a=ei(r=t.g=n[i],s,!0,t)&&a;if(a=ei(r=t.g=e,s,!0,t)&&a,a=ei(r,s,!1,t)&&a,n)for(i=0;i<n.length;i++)a=ei(r=t.g=n[i],s,!1,t)&&a}function ei(e,t,r,i){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();let n=!0;for(let s=0;s<t.length;++s){let a=t[s];if(a&&!a.da&&a.capture==r){let t=a.listener,r=a.ha||a.src;a.fa&&z(e.i,a),n=!1!==t.call(r,i)&&n}}return n&&!i.defaultPrevented}c(et,N),et.prototype[L]=!0,et.prototype.removeEventListener=function(e,t,r,i){!function e(t,r,i,n,s){if(Array.isArray(r))for(var a=0;a<r.length;a++)e(t,r[a],i,n,s);else(n=o(n)?!!n.capture:!!n,i=ee(i),t&&t[L])?(t=t.i,(a=String(r).toString())in t.g&&(i=q(r=t.g[a],i,n,s))>-1&&(V(r[i]),Array.prototype.splice.call(r,i,1),0==r.length&&(delete t.g[a],t.h--))):t&&(t=Y(t))&&(r=t.g[r.toString()],t=-1,r&&(t=q(r,i,n,s)),(i=t>-1?r[t]:null)&&J(i))}(this,e,t,r,i)},et.prototype.N=function(){if(et.Z.N.call(this),this.i){var e=this.i;for(let t in e.g){let r=e.g[t];for(let e=0;e<r.length;e++)V(r[e]);delete e.g[t],e.h--}}this.G=null},et.prototype.J=function(e,t,r,i){return this.i.add(String(e),t,!1,r,i)},et.prototype.K=function(e,t,r,i){return this.i.add(String(e),t,!0,r,i)};class en extends N{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:function e(t){t.g=function(e,t){if("function"!=typeof e)if(e&&"function"==typeof e.handleEvent)e=h(e.handleEvent,e);else throw Error("Invalid listener argument");return Number(t)>0x7fffffff?-1:a.setTimeout(e,t||0)}(()=>{t.g=null,t.i&&(t.i=!1,e(t))},t.l);let r=t.h;t.h=null,t.m.apply(null,r)}(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function es(e){N.call(this),this.h=e,this.g={}}c(es,N);var ea=[];function eo(e){F(e.g,function(e,t){this.g.hasOwnProperty(t)&&J(e)},e),e.g={}}es.prototype.N=function(){es.Z.N.call(this),eo(this)},es.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var el=a.JSON.stringify,eh=a.JSON.parse,eu=class{stringify(e){return a.JSON.stringify(e,void 0)}parse(e){return a.JSON.parse(e,void 0)}};function ec(){}function ed(){}var ef={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ep(){O.call(this,"d")}function eg(){O.call(this,"c")}c(ep,O),c(eg,O);var em={},ey=null;function ev(){return ey=ey||new et}function e_(e){O.call(this,em.Ia,e)}function ew(e){let t=ev();er(t,new e_(t))}function eE(e,t){O.call(this,em.STAT_EVENT,e),this.stat=t}function eb(e){let t=ev();er(t,new eE(t,e))}function eI(e,t){O.call(this,em.Ja,e),this.size=t}function eT(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){e()},t)}function eS(){this.g=!0}function eC(e,t,r,i){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{let s=JSON.parse(t);if(s){for(e=0;e<s.length;e++)if(Array.isArray(s[e])){var r=s[e];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){var n=i[0];if("noop"!=n&&"stop"!=n&&"close"!=n)for(let e=1;e<i.length;e++)i[e]=""}}}}return el(s)}catch(e){return t}}(e,r)+(i?" "+i:"")})}em.Ia="serverreachability",c(e_,O),em.STAT_EVENT="statevent",c(eE,O),em.Ja="timingevent",c(eI,O),eS.prototype.ua=function(){this.g=!1},eS.prototype.info=function(){};var eA={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ek={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"};function eR(){}function eN(e){return encodeURIComponent(String(e))}function eO(e,t,r,i){this.j=e,this.i=t,this.l=r,this.S=i||1,this.V=new es(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new eP}function eP(){this.i=null,this.g="",this.h=!1}c(eR,ec),eR.prototype.g=function(){return new XMLHttpRequest},e=new eR;var eD={},ex={};function eL(e,t,r){e.M=1,e.A=e4(e0(t)),e.u=r,e.R=!0,eM(e,null)}function eM(e,t){e.F=Date.now(),eV(e),e.B=e0(e.A);var r,i,n,s,a,l,u=e.B,c=e.S;Array.isArray(c)||(c=[String(c)]),th(u.i,"t",c),e.C=0,u=e.j.L,e.h=new eP,e.g=tQ(e.j,u?t:null,!e.u),e.P>0&&(e.O=new en(h(e.Y,e,e.g),e.P)),t=e.V,u=e.g,c=e.ba;var d="readystatechange";Array.isArray(d)||(d&&(ea[0]=d.toString()),d=ea);for(let e=0;e<d.length;e++){let r=function e(t,r,i,n,s){if(n&&n.once)return function e(t,r,i,n,s){if(Array.isArray(r)){for(let a=0;a<r.length;a++)e(t,r[a],i,n,s);return null}return i=ee(i),t&&t[L]?t.K(r,i,o(n)?!!n.capture:!!n,s):G(t,r,i,!0,n,s)}(t,r,i,n,s);if(Array.isArray(r)){for(let a=0;a<r.length;a++)e(t,r[a],i,n,s);return null}return i=ee(i),t&&t[L]?t.J(r,i,o(n)?!!n.capture:!!n,s):G(t,r,i,!1,n,s)}(u,d[e],c||t.handleEvent,!1,t.h||t);if(!r)break;t.g[r.key]=r}t=e.J?j(e.J):{},e.u?(e.v||(e.v="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.B,e.v,e.u,t)):(e.v="GET",e.g.ea(e.B,e.v,null,t)),ew(),r=e.i,i=e.v,n=e.B,s=e.l,a=e.S,l=e.u,r.info(function(){if(r.g)if(l){var e="",t=l.split("&");for(let r=0;r<t.length;r++){var o=t[r].split("=");if(o.length>1){let t=o[0];o=o[1];let r=t.split("_");e=r.length>=2&&"type"==r[1]?e+(t+"=")+o+"&":e+(t+"=redacted&")}}}else e=null;else e=l;return"XMLHTTP REQ ("+s+") [attempt "+a+"]: "+i+"\n"+n+"\n"+e})}function eU(e){return!!e.g&&"GET"==e.v&&2!=e.M&&e.j.Aa}function eV(e){e.T=Date.now()+e.H,eF(e,e.H)}function eF(e,t){if(null!=e.D)throw Error("WatchDog timer not null");e.D=eT(h(e.aa,e),t)}function ej(e){e.D&&(a.clearTimeout(e.D),e.D=null)}function eB(e){0==e.j.I||e.K||tz(e.j,e)}function e$(e){ej(e);var t=e.O;t&&"function"==typeof t.dispose&&t.dispose(),e.O=null,eo(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.dispose())}function eH(e,t){try{var r=e.j;if(0!=r.I&&(r.g==e||eG(r.h,e))){if(!e.L&&eG(r.h,e)&&3==r.I){try{var i=r.Ba.g.parse(t)}catch(e){i=null}if(Array.isArray(i)&&3==i.length){var n=i;if(0==n[0]){e:if(!r.v){if(r.g)if(r.g.F+3e3<e.F)tH(r),tD(r);else break e;tj(r),eb(18)}}else r.xa=n[1],0<r.xa-r.K&&n[2]<37500&&r.F&&0==r.A&&!r.C&&(r.C=eT(h(r.Va,r),6e3));1>=eW(r.h)&&r.ta&&(r.ta=void 0)}else tK(r,11)}else if((e.L||r.g==e)&&tH(r),!D(t))for(n=r.Ba.g.parse(t),t=0;t<n.length;t++){let o=n[t],l=o[0];if(!(l<=r.K))if(r.K=l,o=o[1],2==r.I)if("c"==o[0]){r.M=o[1],r.ba=o[2];let t=o[3];null!=t&&(r.ka=t,r.j.info("VER="+r.ka));let n=o[4];null!=n&&(r.za=n,r.j.info("SVER="+r.za));let l=o[5];null!=l&&"number"==typeof l&&l>0&&(r.O=i=1.5*l,r.j.info("backChannelRequestTimeoutMs_="+i)),i=r;let h=e.g;if(h){let e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=i.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(eJ(s,s.h),s.h=null))}if(i.G){let e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(i.wa=e,e3(i.J,i.G,e))}}if(r.I=3,r.l&&r.l.ra(),r.aa&&(r.T=Date.now()-e.F,r.j.info("Handshake RTT: "+r.T+"ms")),(i=r).na=tX(i,i.L?i.ba:null,i.W),e.L){eX(i.h,e);var a=i.O;a&&(e.H=a),e.D&&(ej(e),eV(e)),i.g=e}else tF(i);r.i.length>0&&tL(r)}else"stop"!=o[0]&&"close"!=o[0]||tK(r,7);else 3==r.I&&("stop"==o[0]||"close"==o[0]?"stop"==o[0]?tK(r,7):tP(r):"noop"!=o[0]&&r.l&&r.l.qa(o),r.A=0)}}ew(4)}catch(e){}}eO.prototype.ba=function(e){e=e.target;let t=this.O;t&&3==tk(e)?t.j():this.Y(e)},eO.prototype.Y=function(e){try{if(e==this.g)e:{let f=tk(this.g),p=this.g.ya(),g=this.g.ca();if(!(f<3)&&(3!=f||this.g&&(this.h.h||this.g.la()||tR(this.g)))){this.K||4!=f||7==p||(8==p||g<=0?ew(3):ew(2)),ej(this);var t=this.g.ca();this.X=t;var r=function(e){if(!eU(e))return e.g.la();let t=tR(e.g);if(""===t)return"";let r="",i=t.length,n=4==tk(e.g);if(!e.h.i){if("undefined"==typeof TextDecoder)return e$(e),eB(e),"";e.h.i=new a.TextDecoder}for(let s=0;s<i;s++)e.h.h=!0,r+=e.h.i.decode(t[s],{stream:!(n&&s==i-1)});return t.length=0,e.h.g+=r,e.C=0,e.h.g}(this);if(this.o=200==t,i=this.i,n=this.v,s=this.B,o=this.l,l=this.S,i.info(function(){return"XMLHTTP RESP ("+o+") [ attempt "+l+"]: "+n+"\n"+s+"\n"+f+" "+t}),this.o){if(this.U&&!this.L){t:{if(this.g){var i,n,s,o,l,h,u=this.g;if((h=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!D(h)){var c=h;break t}}c=null}if(e=c)eC(this.i,this.l,e,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,eH(this,e);else{this.o=!1,this.m=3,eb(12),e$(this),eB(this);break e}}if(this.R){let t;for(e=!0;!this.K&&this.C<r.length;)if((t=function(e,t){var r=e.C,i=t.indexOf("\n",r);return -1==i?ex:isNaN(r=Number(t.substring(r,i)))?eD:(i+=1)+r>t.length?ex:(t=t.slice(i,i+r),e.C=i+r,t)}(this,r))==ex){4==f&&(this.m=4,eb(14),e=!1),eC(this.i,this.l,null,"[Incomplete Response]");break}else if(t==eD){this.m=4,eb(15),eC(this.i,this.l,r,"[Invalid Chunk]"),e=!1;break}else eC(this.i,this.l,t,null),eH(this,t);if(eU(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=f||0!=r.length||this.h.h||(this.m=1,eb(16),e=!1),this.o=this.o&&e,e){if(r.length>0&&!this.W){this.W=!0;var d=this.j;d.g==this&&d.aa&&!d.P&&(d.j.info("Great, no buffering proxy detected. Bytes received: "+r.length),tB(d),d.P=!0,eb(11))}}else eC(this.i,this.l,r,"[Invalid Chunked Response]"),e$(this),eB(this)}else eC(this.i,this.l,r,null),eH(this,r);4==f&&e$(this),this.o&&!this.K&&(4==f?tz(this.j,this):(this.o=!1,eV(this)))}else(function(e){let t={};e=(e.g&&tk(e)>=2&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<e.length;i++){if(D(e[i]))continue;var r=function(e){var t=1;e=e.split(":");let r=[];for(;t>0&&e.length;)r.push(e.shift()),t--;return e.length&&r.push(e.join(":")),r}(e[i]);let n=r[0];if("string"!=typeof(r=r[1]))continue;r=r.trim();let s=t[n]||[];t[n]=s,s.push(r)}var i=function(e){return e.join(", ")};for(let e in t)i.call(void 0,t[e],e,t)})(this.g),400==t&&r.indexOf("Unknown SID")>0?(this.m=3,eb(12)):(this.m=0,eb(13)),e$(this),eB(this)}}}catch(e){}finally{}},eO.prototype.cancel=function(){this.K=!0,e$(this)},eO.prototype.aa=function(){var e,t;this.D=null;let r=Date.now();r-this.T>=0?(e=this.i,t=this.B,e.info(function(){return"TIMEOUT: "+t}),2!=this.M&&(ew(),eb(17)),e$(this),this.m=2,eB(this)):eF(this,this.T-r)};var ez=class{constructor(e,t){this.g=e,this.map=t}};function eq(e){this.l=e||10,e=a.PerformanceNavigationTiming?(e=a.performance.getEntriesByType("navigation")).length>0&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function eK(e){return!!e.h||!!e.g&&e.g.size>=e.j}function eW(e){return e.h?1:e.g?e.g.size:0}function eG(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function eJ(e,t){e.g?e.g.add(t):e.h=t}function eX(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function eQ(e){if(null!=e.h)return e.i.concat(e.h.G);if(null!=e.g&&0!==e.g.size){let t=e.i;for(let r of e.g.values())t=t.concat(r.G);return t}return E(e.i)}eq.prototype.cancel=function(){if(this.i=eQ(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(let e of this.g.values())e.cancel();this.g.clear()}};var eY=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function eZ(e){let t;this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1,e instanceof eZ?(this.l=e.l,e1(this,e.j),this.o=e.o,this.g=e.g,e2(this,e.u),this.h=e.h,e6(this,tu(e.i)),this.m=e.m):e&&(t=String(e).match(eY))?(this.l=!1,e1(this,t[1]||"",!0),this.o=e5(t[2]||""),this.g=e5(t[3]||"",!0),e2(this,t[4]),this.h=e5(t[5]||"",!0),e6(this,t[6]||"",!0),this.m=e5(t[7]||"")):(this.l=!1,this.i=new tn(null,this.l))}function e0(e){return new eZ(e)}function e1(e,t,r){e.j=r?e5(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function e2(e,t){if(t){if(isNaN(t=Number(t))||t<0)throw Error("Bad port number "+t);e.u=t}else e.u=null}function e6(e,t,r){var i,n;t instanceof tn?(e.i=t,i=e.i,(n=e.l)&&!i.j&&(ts(i),i.i=null,i.g.forEach(function(e,t){let r=t.toLowerCase();t!=r&&(ta(this,t),th(this,r,e))},i)),i.j=n):(r||(t=e8(t,tr)),e.i=new tn(t,e.l))}function e3(e,t,r){e.i.set(t,r)}function e4(e){return e3(e,"zx",Math.floor(0x80000000*Math.random()).toString(36)+Math.abs(Math.floor(0x80000000*Math.random())^Date.now()).toString(36)),e}function e5(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function e8(e,t,r){return"string"==typeof e?(e=encodeURI(e).replace(t,e7),r&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function e7(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}eZ.prototype.toString=function(){let e=[];var t=this.j;t&&e.push(e8(t,e9,!0),":");var r=this.g;return(r||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(e8(t,e9,!0),"@"),e.push(eN(r).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(r=this.u)&&e.push(":",String(r))),(r=this.h)&&(this.g&&"/"!=r.charAt(0)&&e.push("/"),e.push(e8(r,"/"==r.charAt(0)?tt:te,!0))),(r=this.i.toString())&&e.push("?",r),(r=this.m)&&e.push("#",e8(r,ti)),e.join("")},eZ.prototype.resolve=function(e){let t=e0(this),r=!!e.j;r?e1(t,e.j):r=!!e.o,r?t.o=e.o:r=!!e.g,r?t.g=e.g:r=null!=e.u;var i=e.h;if(r)e2(t,e.u);else if(r=!!e.h){if("/"!=i.charAt(0))if(this.g&&!this.h)i="/"+i;else{var n=t.h.lastIndexOf("/");-1!=n&&(i=t.h.slice(0,n+1)+i)}if(".."==(n=i)||"."==n)i="";else if(-1!=n.indexOf("./")||-1!=n.indexOf("/.")){i=0==n.lastIndexOf("/",0),n=n.split("/");let e=[];for(let t=0;t<n.length;){let r=n[t++];"."==r?i&&t==n.length&&e.push(""):".."==r?((e.length>1||1==e.length&&""!=e[0])&&e.pop(),i&&t==n.length&&e.push("")):(e.push(r),i=!0)}i=e.join("/")}else i=n}return r?t.h=i:r=""!==e.i.toString(),r?e6(t,tu(e.i)):r=!!e.m,r&&(t.m=e.m),t};var e9=/[#\/\?@]/g,te=/[#\?:]/g,tt=/[#\?]/g,tr=/[#\?@]/g,ti=/#/g;function tn(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function ts(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(let r=0;r<e.length;r++){let i=e[r].indexOf("="),n,s=null;i>=0?(n=e[r].substring(0,i),s=e[r].substring(i+1)):n=e[r],t(n,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(e.i,function(t,r){e.add(decodeURIComponent(t.replace(/\+/g," ")),r)}))}function ta(e,t){ts(e),t=tc(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function to(e,t){return ts(e),t=tc(e,t),e.g.has(t)}function tl(e,t){ts(e);let r=[];if("string"==typeof t)to(e,t)&&(r=r.concat(e.g.get(tc(e,t))));else for(e=Array.from(e.g.values()),t=0;t<e.length;t++)r=r.concat(e[t]);return r}function th(e,t,r){ta(e,t),r.length>0&&(e.i=null,e.g.set(tc(e,t),E(r)),e.h+=r.length)}function tu(e){let t=new tn;return t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),t}function tc(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function td(e,t,r,i,n){try{n&&(n.onload=null,n.onerror=null,n.onabort=null,n.ontimeout=null),i(r)}catch(e){}}function tf(){this.g=new eu}function tp(e){this.i=e.Sb||null,this.h=e.ab||!1}function tg(e,t){et.call(this),this.H=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}function tm(e){e.j.read().then(e.Ma.bind(e)).catch(e.ga.bind(e))}function ty(e){e.readyState=4,e.l=null,e.j=null,e.B=null,tv(e)}function tv(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function t_(e){let t="";return F(e,function(e,r){t+=r,t+=":",t+=e,t+="\r\n"}),t}function tw(e,t,r){e:{for(i in r){var i=!1;break e}i=!0}i||(r=t_(r),"string"==typeof e?null!=r&&eN(r):e3(e,t,r))}function tE(e){et.call(this),this.headers=new Map,this.L=e||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}(t=tn.prototype).add=function(e,t){ts(this),this.i=null,e=tc(this,e);let r=this.g.get(e);return r||this.g.set(e,r=[]),r.push(t),this.h+=1,this},t.forEach=function(e,t){ts(this),this.g.forEach(function(r,i){r.forEach(function(r){e.call(t,r,i,this)},this)},this)},t.set=function(e,t){return ts(this),this.i=null,to(this,e=tc(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},t.get=function(e,t){return e&&(e=tl(this,e)).length>0?String(e[0]):t},t.toString=function(){if(this.i)return this.i;if(!this.g)return"";let e=[],t=Array.from(this.g.keys());for(let i=0;i<t.length;i++){var r=t[i];let n=eN(r);r=tl(this,r);for(let t=0;t<r.length;t++){let i=n;""!==r[t]&&(i+="="+eN(r[t])),e.push(i)}}return this.i=e.join("&")},c(tp,ec),tp.prototype.g=function(){return new tg(this.i,this.h)},c(tg,et),(t=tg.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.F=e,this.D=t,this.readyState=1,tv(this)},t.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;let t={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};e&&(t.body=e),(this.H||a).fetch(new Request(this.D,t)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&4!=this.readyState&&(this.g=!1,ty(this)),this.readyState=0},t.Pa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,tv(this)),this.g&&(this.readyState=3,tv(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(void 0!==a.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;tm(this)}else e.text().then(this.Oa.bind(this),this.ga.bind(this))},t.Ma=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.B.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?ty(this):tv(this),3==this.readyState&&tm(this)}},t.Oa=function(e){this.g&&(this.response=this.responseText=e,ty(this))},t.Na=function(e){this.g&&(this.response=e,ty(this))},t.ga=function(){this.g&&ty(this)},t.setRequestHeader=function(e,t){this.A.append(e,t)},t.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";let e=[],t=this.h.entries();for(var r=t.next();!r.done;)e.push((r=r.value)[0]+": "+r[1]),r=t.next();return e.join("\r\n")},Object.defineProperty(tg.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),c(tE,et);var tb=/^https?$/i,tI=["POST","PUT"];function tT(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.o=5,tS(e),tA(e)}function tS(e){e.A||(e.A=!0,er(e,"complete"),er(e,"error"))}function tC(e){if(e.h&&void 0!==s){if(e.v&&4==tk(e))setTimeout(e.Ca.bind(e),0);else if(er(e,"readystatechange"),4==tk(e)){e.h=!1;try{let s=e.ca();switch(s){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t,r,i=!0;break;default:i=!1}if(!(t=i)){if(r=0===s){let t=String(e.D).match(eY)[1]||null;!t&&a.self&&a.self.location&&(t=a.self.location.protocol.slice(0,-1)),r=!tb.test(t?t.toLowerCase():"")}t=r}if(t)er(e,"complete"),er(e,"success");else{e.o=6;try{var n=tk(e)>2?e.g.statusText:""}catch(e){n=""}e.l=n+" ["+e.ca()+"]",tS(e)}}finally{tA(e)}}}}function tA(e,t){if(e.g){e.m&&(clearTimeout(e.m),e.m=null);let r=e.g;e.g=null,t||er(e,"ready");try{r.onreadystatechange=null}catch(e){}}}function tk(e){return e.g?e.g.readyState:0}function tR(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.F){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function tN(e,t,r){return r&&r.internalChannelParams&&r.internalChannelParams[e]||t}function tO(e){this.za=0,this.i=[],this.j=new eS,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=tN("failFast",!1,e),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=tN("baseRetryDelayMs",5e3,e),this.Za=tN("retryDelaySeedMs",1e4,e),this.Ta=tN("forwardChannelMaxRetries",2,e),this.va=tN("forwardChannelRequestTimeoutMs",2e4,e),this.ma=e&&e.xmlHttpFactory||void 0,this.Ua=e&&e.Rb||void 0,this.Aa=e&&e.useFetchStreams||!1,this.O=void 0,this.L=e&&e.supportsCrossDomainXhr||!1,this.M="",this.h=new eq(e&&e.concurrentRequestLimit),this.Ba=new tf,this.S=e&&e.fastHandshake||!1,this.R=e&&e.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=e&&e.Pb||!1,e&&e.ua&&this.j.ua(),e&&e.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&e&&e.detectBufferingProxy||!1,this.ia=void 0,e&&e.longPollingTimeout&&e.longPollingTimeout>0&&(this.ia=e.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}function tP(e){if(tx(e),3==e.I){var t=e.V++,r=e0(e.J);if(e3(r,"SID",e.M),e3(r,"RID",t),e3(r,"TYPE","terminate"),tU(e,r),(t=new eO(e,e.j,t)).M=2,t.A=e4(e0(r)),r=!1,a.navigator&&a.navigator.sendBeacon)try{r=a.navigator.sendBeacon(t.A.toString(),"")}catch(e){}!r&&a.Image&&((new Image).src=t.A,r=!0),r||(t.g=tQ(t.j,null),t.g.ea(t.A)),t.F=Date.now(),eV(t)}tW(e)}function tD(e){e.g&&(tB(e),e.g.cancel(),e.g=null)}function tx(e){tD(e),e.v&&(a.clearTimeout(e.v),e.v=null),tH(e),e.h.cancel(),e.m&&("number"==typeof e.m&&a.clearTimeout(e.m),e.m=null)}function tL(e){if(!eK(e.h)&&!e.m){e.m=!0;var t=e.Ea;S||k(),C||(S(),C=!0),A.add(t,e),e.D=0}}function tM(e,t){var r;r=t?t.l:e.V++;let i=e0(e.J);e3(i,"SID",e.M),e3(i,"RID",r),e3(i,"AID",e.K),tU(e,i),e.u&&e.o&&tw(i,e.u,e.o),r=new eO(e,e.j,r,e.D+1),null===e.u&&(r.J=e.o),t&&(e.i=t.G.concat(e.i)),t=tV(e,r,1e3),r.H=Math.round(.5*e.va)+Math.round(.5*e.va*Math.random()),eJ(e.h,r),eL(r,i,t)}function tU(e,t){e.H&&F(e.H,function(e,r){e3(t,r,e)}),e.l&&F({},function(e,r){e3(t,r,e)})}function tV(e,t,r){r=Math.min(e.i.length,r);let i=e.l?h(e.l.Ka,e.l,e):null;e:{var n=e.i;let t=-1;for(;;){let e=["count="+r];-1==t?r>0?(t=n[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let l=!0;for(let h=0;h<r;h++){var s=n[h].g;let r=n[h].map;if((s-=t)<0)t=Math.max(0,n[h].g-100),l=!1;else try{s="req"+s+"_";try{var a=r instanceof Map?r:Object.entries(r);for(let[t,r]of a){let i=r;o(r)&&(i=el(r)),e.push(s+t+"="+encodeURIComponent(i))}}catch(t){throw e.push(s+"type="+encodeURIComponent("_badmap")),t}}catch(e){i&&i(r)}}if(l){a=e.join("&");break e}}a=void 0}return t.G=e=e.i.splice(0,r),a}function tF(e){if(!e.g&&!e.v){e.Y=1;var t=e.Da;S||k(),C||(S(),C=!0),A.add(t,e),e.A=0}}function tj(e){return!e.g&&!e.v&&!(e.A>=3)&&(e.Y++,e.v=eT(h(e.Da,e),tq(e,e.A)),e.A++,!0)}function tB(e){null!=e.B&&(a.clearTimeout(e.B),e.B=null)}function t$(e){e.g=new eO(e,e.j,"rpc",e.Y),null===e.u&&(e.g.J=e.o),e.g.P=0;var t=e0(e.na);e3(t,"RID","rpc"),e3(t,"SID",e.M),e3(t,"AID",e.K),e3(t,"CI",e.F?"0":"1"),!e.F&&e.ia&&e3(t,"TO",e.ia),e3(t,"TYPE","xmlhttp"),tU(e,t),e.u&&e.o&&tw(t,e.u,e.o),e.O&&(e.g.H=e.O);var r=e.g;e=e.ba,r.M=1,r.A=e4(e0(t)),r.u=null,r.R=!0,eM(r,e)}function tH(e){null!=e.C&&(a.clearTimeout(e.C),e.C=null)}function tz(e,t){var r,i=null;if(e.g==t){tH(e),tB(e),e.g=null;var n=2}else{if(!eG(e.h,t))return;i=t.G,eX(e.h,t),n=1}if(0!=e.I){if(t.o)if(1==n){i=t.u?t.u.length:0,t=Date.now()-t.F;var s=e.D;er(n=ev(),new eI(n,i)),tL(e)}else tF(e);else if(3==(s=t.m)||0==s&&t.X>0||!(1==n&&(r=t,!(eW(e.h)>=e.h.j-!!e.m)&&(e.m?(e.i=r.G.concat(e.i),!0):1!=e.I&&2!=e.I&&!(e.D>=(e.Sa?0:e.Ta))&&(e.m=eT(h(e.Ea,e,r),tq(e,e.D)),e.D++,!0)))||2==n&&tj(e)))switch(i&&i.length>0&&((t=e.h).i=t.i.concat(i)),s){case 1:tK(e,5);break;case 4:tK(e,10);break;case 3:tK(e,6);break;default:tK(e,2)}}}function tq(e,t){let r=e.Qa+Math.floor(Math.random()*e.Za);return e.isActive()||(r*=2),r*t}function tK(e,t){if(e.j.info("Error code "+t),2==t){let t,s,o;var r,i=h(e.bb,e),n=e.Ua;let l=!n;n=new eZ(n||"//www.google.com/images/cleardot.gif"),a.location&&"http"==a.location.protocol||e1(n,"https"),e4(n),l?function(e,t){let r=new eS;if(a.Image){let i=new Image;i.onload=u(td,r,"TestLoadImage: loaded",!0,t,i),i.onerror=u(td,r,"TestLoadImage: error",!1,t,i),i.onabort=u(td,r,"TestLoadImage: abort",!1,t,i),i.ontimeout=u(td,r,"TestLoadImage: timeout",!1,t,i),a.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=e}else t(!1)}(n.toString(),i):(r=n.toString(),t=new eS,s=new AbortController,o=setTimeout(()=>{s.abort(),td(t,"TestPingServer: timeout",!1,i)},1e4),fetch(r,{signal:s.signal}).then(e=>{clearTimeout(o),e.ok?td(t,"TestPingServer: ok",!0,i):td(t,"TestPingServer: server error",!1,i)}).catch(()=>{clearTimeout(o),td(t,"TestPingServer: error",!1,i)}))}else eb(2);e.I=0,e.l&&e.l.pa(t),tW(e),tx(e)}function tW(e){if(e.I=0,e.ja=[],e.l){let t=eQ(e.h);(0!=t.length||0!=e.i.length)&&(b(e.ja,t),b(e.ja,e.i),e.h.i.length=0,E(e.i),e.i.length=0),e.l.oa()}}function tX(e,t,r){var i=r instanceof eZ?e0(r):new eZ(r);if(""!=i.g)t&&(i.g=t+"."+i.g),e2(i,i.u);else{var n=a.location;i=n.protocol,t=t?t+"."+n.hostname:n.hostname,n=+n.port;let e=new eZ(null);i&&e1(e,i),t&&(e.g=t),n&&e2(e,n),r&&(e.h=r),i=e}return r=e.G,t=e.wa,r&&t&&e3(i,r,t),e3(i,"VER",e.ka),tU(e,i),i}function tQ(e,t,r){if(t&&!e.L)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new tE(e.Aa&&!e.ma?new tp({ab:r}):e.ma)).Fa(e.L),t}function tY(){}function tZ(){}function t0(e,t){et.call(this),this.g=new tO(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.sa&&(e?e["X-WebChannel-Client-Profile"]=t.sa:e={"X-WebChannel-Client-Profile":t.sa}),this.g.U=e,(e=t&&t.Qb)&&!D(e)&&(this.g.u=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!D(t)&&(this.g.G=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new t6(this)}function t1(e){ep.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(let r in t){e=r;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function t2(){eg.call(this),this.status=1}function t6(e){this.g=e}(t=tE.prototype).Fa=function(e){this.H=e},t.ea=function(t,r,i,n){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);r=r?r.toUpperCase():"GET",this.D=t,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():e.g(),this.g.onreadystatechange=w(h(this.Ca,this));try{this.B=!0,this.g.open(r,String(t),!0),this.B=!1}catch(e){tT(this,e);return}if(t=i||"",i=new Map(this.headers),n)if(Object.getPrototypeOf(n)===Object.prototype)for(var s in n)i.set(s,n[s]);else if("function"==typeof n.keys&&"function"==typeof n.get)for(let e of n.keys())i.set(e,n.get(e));else throw Error("Unknown input type for opt_headers: "+String(n));for(let[e,o]of(n=Array.from(i.keys()).find(e=>"content-type"==e.toLowerCase()),s=a.FormData&&t instanceof a.FormData,!(Array.prototype.indexOf.call(tI,r,void 0)>=0)||n||s||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i))this.g.setRequestHeader(e,o);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(t),this.v=!1}catch(e){tT(this,e)}},t.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=e||7,er(this,"complete"),er(this,"abort"),tA(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),tA(this,!0)),tE.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?tC(this):this.Xa())},t.Xa=function(){tC(this)},t.isActive=function(){return!!this.g},t.ca=function(){try{return tk(this)>2?this.g.status:-1}catch(e){return -1}},t.la=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},t.La=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),eh(t)}},t.ya=function(){return this.o},t.Ha=function(){return"string"==typeof this.l?this.l:String(this.l)},(t=tO.prototype).ka=8,t.I=1,t.connect=function(e,t,r,i){eb(0),this.W=e,this.H=t||{},r&&void 0!==i&&(this.H.OSID=r,this.H.OAID=i),this.F=this.X,this.J=tX(this,null,this.W),tL(this)},t.Ea=function(e){if(this.m)if(this.m=null,1==this.I){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;let n=new eO(this,this.j,e),s=this.o;if(this.U&&(s?$(s=j(s),this.U):s=this.U),null!==this.u||this.R||(n.J=s,s=null),this.S)e:{for(var t=0,r=0;r<this.i.length;r++){t:{var i=this.i[r];if("__data__"in i.map&&"string"==typeof(i=i.map.__data__)){i=i.length;break t}i=void 0}if(void 0===i)break;if((t+=i)>4096){t=r;break e}if(4096===t||r===this.i.length-1){t=r+1;break e}}t=1e3}else t=1e3;t=tV(this,n,t),e3(r=e0(this.J),"RID",e),e3(r,"CVER",22),this.G&&e3(r,"X-HTTP-Session-Id",this.G),tU(this,r),s&&(this.R?t="headers="+eN(t_(s))+"&"+t:this.u&&tw(r,this.u,s)),eJ(this.h,n),this.Ra&&e3(r,"TYPE","init"),this.S?(e3(r,"$req",t),e3(r,"SID","null"),n.U=!0,eL(n,r,null)):eL(n,r,t),this.I=2}}else 3==this.I&&(e?tM(this,e):0==this.i.length||eK(this.h)||tM(this))},t.Da=function(){if(this.v=null,t$(this),this.aa&&!(this.P||null==this.g||this.T<=0)){var e=4*this.T;this.j.info("BP detection timer enabled: "+e),this.B=eT(h(this.Wa,this),e)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,eb(10),tD(this),t$(this))},t.Va=function(){null!=this.C&&(this.C=null,tD(this),tj(this),eb(19))},t.bb=function(e){e?(this.j.info("Successfully pinged google.com"),eb(2)):(this.j.info("Failed to ping google.com"),eb(1))},t.isActive=function(){return!!this.l&&this.l.isActive(this)},(t=tY.prototype).ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){},tZ.prototype.g=function(e,t){return new t0(e,t)},c(t0,et),t0.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},t0.prototype.close=function(){tP(this.g)},t0.prototype.o=function(e){var t=this.g;if("string"==typeof e){var r={};r.__data__=e,e=r}else this.v&&((r={}).__data__=el(e),e=r);t.i.push(new ez(t.Ya++,e)),3==t.I&&tL(t)},t0.prototype.N=function(){this.g.l=null,delete this.j,tP(this.g),delete this.g,t0.Z.N.call(this)},c(t1,ep),c(t2,eg),c(t6,tY),t6.prototype.ra=function(){er(this.g,"a")},t6.prototype.qa=function(e){er(this.g,new t1(e))},t6.prototype.pa=function(e){er(this.g,new t2)},t6.prototype.oa=function(){er(this.g,"b")},tZ.prototype.createWebChannel=tZ.prototype.g,t0.prototype.send=t0.prototype.o,t0.prototype.open=t0.prototype.m,t0.prototype.close=t0.prototype.close,_=tJ.createWebChannelTransport=function(){return new tZ},v=tJ.getStatEventTarget=function(){return ev()},y=tJ.Event=em,m=tJ.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},eA.NO_ERROR=0,eA.TIMEOUT=8,eA.HTTP_ERROR=6,g=tJ.ErrorCode=eA,ek.COMPLETE="complete",p=tJ.EventType=ek,ed.EventType=ef,ef.OPEN="a",ef.CLOSE="b",ef.ERROR="c",ef.MESSAGE="d",et.prototype.listen=et.prototype.J,f=tJ.WebChannel=ed,tJ.FetchXmlHttpFactory=tp,tE.prototype.listenOnce=tE.prototype.K,tE.prototype.getLastError=tE.prototype.Ha,tE.prototype.getLastErrorCode=tE.prototype.ya,tE.prototype.getStatus=tE.prototype.ca,tE.prototype.getResponseJson=tE.prototype.La,tE.prototype.getResponseText=tE.prototype.la,tE.prototype.send=tE.prototype.ea,tE.prototype.setWithCredentials=tE.prototype.Fa,d=tJ.XhrIo=tE}).apply(void 0!==tG?tG:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});let tX="@firebase/firestore",tQ="4.9.2";class tY{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}tY.UNAUTHENTICATED=new tY(null),tY.GOOGLE_CREDENTIALS=new tY("google-credentials-uid"),tY.FIRST_PARTY=new tY("first-party-uid"),tY.MOCK_USER=new tY("mock-user");let tZ="12.3.0",t0=new ep("@firebase/firestore");function t1(){return t0.logLevel}function t2(e,...t){if(t0.logLevel<=l.DEBUG){let r=t.map(t4);t0.debug(`Firestore (${tZ}): ${e}`,...r)}}function t6(e,...t){if(t0.logLevel<=l.ERROR){let r=t.map(t4);t0.error(`Firestore (${tZ}): ${e}`,...r)}}function t3(e,...t){if(t0.logLevel<=l.WARN){let r=t.map(t4);t0.warn(`Firestore (${tZ}): ${e}`,...r)}}function t4(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function t5(e,t,r){let i="Unexpected state";"string"==typeof t?i=t:r=t,t8(e,i,r)}function t8(e,t,r){let i=`FIRESTORE (${tZ}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(void 0!==r)try{i+=" CONTEXT: "+JSON.stringify(r)}catch(e){i+=" CONTEXT: "+r}throw t6(i),Error(i)}function t7(e,t,r,i){let n="Unexpected state";"string"==typeof r?n=r:i=r,e||t8(t,n,i)}let t9={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class re extends G{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class rt{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class rr{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class ri{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(tY.UNAUTHENTICATED))}shutdown(){}}class rn{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class rs{constructor(e){this.t=e,this.currentUser=tY.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){t7(void 0===this.o,42304);let r=this.i,i=e=>this.i!==r?(r=this.i,t(e)):Promise.resolve(),n=new rt;this.o=()=>{this.i++,this.currentUser=this.u(),n.resolve(),n=new rt,e.enqueueRetryable(()=>i(this.currentUser))};let s=()=>{let t=n;e.enqueueRetryable(async()=>{await t.promise,await i(this.currentUser)})},a=e=>{t2("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(e=>a(e)),setTimeout(()=>{if(!this.auth){let e=this.t.getImmediate({optional:!0});e?a(e):(t2("FirebaseAuthCredentialsProvider","Auth not yet detected"),n.resolve(),n=new rt)}},0),s()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(t2("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(t7("string"==typeof t.accessToken,31837,{l:t}),new rr(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return t7(null===e||"string"==typeof e,2055,{h:e}),new tY(e)}}class ra{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=tY.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class ro{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new ra(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(tY.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class rl{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class rh{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,eH(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){t7(void 0===this.o,3512);let r=e=>{null!=e.error&&t2("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);let r=e.token!==this.m;return this.m=e.token,t2("FirebaseAppCheckTokenProvider",`Received ${r?"new":"existing"} token.`),r?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>r(t))};let i=e=>{t2("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>i(e)),setTimeout(()=>{if(!this.appCheck){let e=this.V.getImmediate({optional:!0});e?i(e):t2("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new rl(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(t7("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new rl(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}class ru{static newId(){let e=62*Math.floor(256/62),t="";for(;t.length<20;){let r=function(e){let t="undefined"!=typeof self&&(self.crypto||self.msCrypto),r=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(r);else for(let e=0;e<40;e++)r[e]=Math.floor(256*Math.random());return r}(0);for(let i=0;i<r.length;++i)t.length<20&&r[i]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(r[i]%62))}return t}}function rc(e,t){return e<t?-1:+(e>t)}function rd(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let r=e.charAt(i),n=t.charAt(i);if(r!==n)return rf(r)===rf(n)?rc(r,n):rf(r)?1:-1}return rc(e.length,t.length)}function rf(e){let t=e.charCodeAt(0);return t>=55296&&t<=57343}function rp(e,t,r){return e.length===t.length&&e.every((e,i)=>r(e,t[i]))}let rg="__name__";class rm{constructor(e,t,r){void 0===t?t=0:t>e.length&&t5(637,{offset:t,range:e.length}),void 0===r?r=e.length-t:r>e.length-t&&t5(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===rm.comparator(this,e)}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof rm?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let r=rm.compareSegments(e.get(i),t.get(i));if(0!==r)return r}return rc(e.length,t.length)}static compareSegments(e,t){let r=rm.isNumericId(e),i=rm.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?rm.extractNumericId(e).compare(rm.extractNumericId(t)):rd(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return c.fromString(e.substring(4,e.length-2))}}class ry extends rm{construct(e,t,r){return new ry(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new re(t9.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(e=>e.length>0))}return new ry(t)}static emptyPath(){return new ry([])}}let rv=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class r_ extends rm{construct(e,t,r){return new r_(e,t,r)}static isValidIdentifier(e){return rv.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),r_.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===rg}static keyField(){return new r_([rg])}static fromServerFormat(e){let t=[],r="",i=0,n=()=>{if(0===r.length)throw new re(t9.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},s=!1;for(;i<e.length;){let t=e[i];if("\\"===t){if(i+1===e.length)throw new re(t9.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let t=e[i+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new re(t9.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=t,i+=2}else"`"===t?s=!s:"."!==t||s?r+=t:n(),i++}if(n(),s)throw new re(t9.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new r_(t)}static emptyPath(){return new r_([])}}class rw{constructor(e){this.path=e}static fromPath(e){return new rw(ry.fromString(e))}static fromName(e){return new rw(ry.fromString(e).popFirst(5))}static empty(){return new rw(ry.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===ry.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return ry.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new rw(new ry(e.slice()))}}function rE(e,t){let r={typeString:e};return t&&(r.value=t),r}function rb(e,t){let r;if("object"!=typeof e||null===e||Object.getPrototypeOf(e)!==Object.prototype&&null!==Object.getPrototypeOf(e))throw new re(t9.INVALID_ARGUMENT,"JSON must be an object");for(let i in t)if(t[i]){let n=t[i].typeString,s="value"in t[i]?{value:t[i].value}:void 0;if(!(i in e)){r=`JSON missing required field: '${i}'`;break}let a=e[i];if(n&&typeof a!==n){r=`JSON field '${i}' must be a ${n}.`;break}if(void 0!==s&&a!==s.value){r=`Expected '${i}' field to equal '${s.value}'`;break}}if(r)throw new re(t9.INVALID_ARGUMENT,r);return!0}class rI{static now(){return rI.fromMillis(Date.now())}static fromDate(e){return rI.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*1e6);return new rI(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0||t>=1e9)throw new re(t9.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-0xe7791f700||e>=0x3afff44180)throw new re(t9.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?rc(this.nanoseconds,e.nanoseconds):rc(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:rI._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(rb(e,rI._jsonSchema))return new rI(e.seconds,e.nanoseconds)}valueOf(){return String(this.seconds- -0xe7791f700).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}rI._jsonSchemaVersion="firestore/timestamp/1.0",rI._jsonSchema={type:rE("string",rI._jsonSchemaVersion),seconds:rE("number"),nanoseconds:rE("number")};class rT{static fromTimestamp(e){return new rT(e)}static min(){return new rT(new rI(0,0))}static max(){return new rT(new rI(0x3afff4417f,0x3b9ac9ff))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class rS{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new rS(rT.min(),rw.empty(),-1)}static max(){return new rS(rT.max(),rw.empty(),-1)}}class rC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}class rA{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&t5(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new rA((r,i)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(r,i)},this.catchCallback=e=>{this.wrapFailure(t,e).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof rA?t:rA.resolve(t)}catch(e){return rA.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):rA.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):rA.reject(t)}static resolve(e){return new rA((t,r)=>{t(e)})}static reject(e){return new rA((t,r)=>{r(e)})}static waitFor(e){return new rA((t,r)=>{let i=0,n=0,s=!1;e.forEach(e=>{++i,e.next(()=>{++n,s&&n===i&&t()},e=>r(e))}),s=!0,n===i&&t()})}static or(e){let t=rA.resolve(!1);for(let r of e)t=t.next(e=>e?rA.resolve(e):r());return t}static forEach(e,t){let r=[];return e.forEach((e,i)=>{r.push(t.call(this,e,i))}),this.waitFor(r)}static mapArray(e,t){return new rA((r,i)=>{let n=e.length,s=Array(n),a=0;for(let o=0;o<n;o++){let l=o;t(e[l]).next(e=>{s[l]=e,++a===n&&r(s)},e=>i(e))}})}static doWhile(e,t){return new rA((r,i)=>{let n=()=>{!0===e()?t().next(()=>{n()},i):r()};n()})}}function rk(e){return"IndexedDbTransactionError"===e.name}class rR{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ae(e),this.ue=e=>t.writeSequenceNumber(e))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){let e=++this.previousValue;return this.ue&&this.ue(e),e}}rR.ce=-1;function rN(e){return 0===e&&1/e==-1/0}function rO(e){let t=0;for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}function rP(e,t){for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])}class rD{constructor(e,t){this.comparator=e,this.root=t||rL.EMPTY}insert(e,t){return new rD(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,rL.BLACK,null,null))}remove(e){return new rD(this.comparator,this.root.remove(e,this.comparator).copy(null,null,rL.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(0===i)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return -1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new rx(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new rx(this.root,e,this.comparator,!1)}getReverseIterator(){return new rx(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new rx(this.root,e,this.comparator,!0)}}class rx{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let n=1;for(;!e.isEmpty();)if(n=t?r(e.key,t):1,t&&i&&(n*=-1),n<0)e=this.isReverse?e.left:e.right;else{if(0===n){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class rL{constructor(e,t,r,i,n){this.key=e,this.value=t,this.color=null!=r?r:rL.RED,this.left=null!=i?i:rL.EMPTY,this.right=null!=n?n:rL.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,n){return new rL(null!=e?e:this.key,null!=t?t:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=n?n:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,n=r(e,i.key);return(i=n<0?i.copy(null,null,null,i.left.insert(e,t,r),null):0===n?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r))).fixUp()}removeMin(){if(this.left.isEmpty())return rL.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()}remove(e,t){let r,i=this;if(0>t(e,i.key))i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return rL.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}rotateLeft(){let e=this.copy(null,null,rL.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,rL.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){return Math.pow(2,this.check())<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw t5(43730,{key:this.key,value:this.value});if(this.right.isRed())throw t5(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw t5(27949);return e+ +!this.isRed()}}rL.EMPTY=null,rL.RED=!0,rL.BLACK=!1,rL.EMPTY=new class{constructor(){this.size=0}get key(){throw t5(57766)}get value(){throw t5(16141)}get color(){throw t5(16727)}get left(){throw t5(29726)}get right(){throw t5(36894)}copy(e,t,r,i,n){return this}insert(e,t,r){return new rL(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class rM{constructor(e){this.comparator=e,this.data=new rD(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new rU(this.data.getIterator())}getIteratorFrom(e){return new rU(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof rM)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let e=t.getNext().key,i=r.getNext().key;if(0!==this.comparator(e,i))return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new rM(this.comparator);return t.data=e,t}}class rU{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class rV{constructor(e){this.fields=e,e.sort(r_.comparator)}static empty(){return new rV([])}unionWith(e){let t=new rM(r_.comparator);for(let e of this.fields)t=t.add(e);for(let r of e)t=t.add(r);return new rV(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return rp(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class rF extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class rj{constructor(e){this.binaryString=e}static fromBase64String(e){return new rj(function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new rF("Invalid base64 string: "+e):e}}(e))}static fromUint8Array(e){return new rj(function(e){let t="";for(let r=0;r<e.length;++r)t+=String.fromCharCode(e[r]);return t}(e))}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){var e=this.binaryString;let t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return rc(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}rj.EMPTY_BYTE_STRING=new rj("");let rB=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function r$(e){if(t7(!!e,39018),"string"==typeof e){let t=0,r=rB.exec(e);if(t7(!!r,46558,{timestamp:e}),r[1]){let e=r[1];t=Number(e=(e+"000000000").substr(0,9))}return{seconds:Math.floor(new Date(e).getTime()/1e3),nanos:t}}return{seconds:rH(e.seconds),nanos:rH(e.nanos)}}function rH(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function rz(e){return"string"==typeof e?rj.fromBase64String(e):rj.fromUint8Array(e)}let rq="server_timestamp",rK="__type__",rW="__previous_value__",rG="__local_write_time__";function rJ(e){return(e?.mapValue?.fields||{})[rK]?.stringValue===rq}function rX(e){let t=r$(e.mapValue.fields[rG].timestampValue);return new rI(t.seconds,t.nanos)}let rQ="(default)";class rY{constructor(e,t){this.projectId=e,this.database=t||rQ}static empty(){return new rY("","")}get isDefaultDatabase(){return this.database===rQ}isEqual(e){return e instanceof rY&&e.projectId===this.projectId&&e.database===this.database}}let rZ="__max__",r0={},r1="value";function r2(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?rJ(e)?4:is(e)?0x1fffffffffffff:ir(e)?10:11:t5(28295,{value:e})}function r6(e,t){if(e===t)return!0;let r=r2(e);if(r!==r2(t))return!1;switch(r){case 0:case 0x1fffffffffffff:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return rX(e).isEqual(rX(t));case 3:if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;let i=r$(e.timestampValue),n=r$(t.timestampValue);return i.seconds===n.seconds&&i.nanos===n.nanos;case 5:return e.stringValue===t.stringValue;case 6:return rz(e.bytesValue).isEqual(rz(t.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return rH(e.geoPointValue.latitude)===rH(t.geoPointValue.latitude)&&rH(e.geoPointValue.longitude)===rH(t.geoPointValue.longitude);case 2:if("integerValue"in e&&"integerValue"in t)return rH(e.integerValue)===rH(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){let r=rH(e.doubleValue),i=rH(t.doubleValue);return r===i?rN(r)===rN(i):isNaN(r)&&isNaN(i)}return!1;case 9:return rp(e.arrayValue.values||[],t.arrayValue.values||[],r6);case 10:case 11:let s=e.mapValue.fields||{},a=t.mapValue.fields||{};if(rO(s)!==rO(a))return!1;for(let e in s)if(s.hasOwnProperty(e)&&(void 0===a[e]||!r6(s[e],a[e])))return!1;return!0;default:return t5(52216,{left:e})}}function r3(e,t){return void 0!==(e.values||[]).find(e=>r6(e,t))}function r4(e,t){var r,i,n,s,a,o;if(e===t)return 0;let l=r2(e),h=r2(t);if(l!==h)return rc(l,h);switch(l){case 0:case 0x1fffffffffffff:return 0;case 1:return rc(e.booleanValue,t.booleanValue);case 2:let u,c;return u=rH(e.integerValue||e.doubleValue),u<(c=rH(t.integerValue||t.doubleValue))?-1:u>c?1:u===c?0:isNaN(u)?isNaN(c)?0:-1:1;case 3:return r5(e.timestampValue,t.timestampValue);case 4:return r5(rX(e),rX(t));case 5:return rd(e.stringValue,t.stringValue);case 6:let d,f;return r=e.bytesValue,i=t.bytesValue,d=rz(r),f=rz(i),d.compareTo(f);case 7:return function(e,t){let r=e.split("/"),i=t.split("/");for(let e=0;e<r.length&&e<i.length;e++){let t=rc(r[e],i[e]);if(0!==t)return t}return rc(r.length,i.length)}(e.referenceValue,t.referenceValue);case 8:let p;return n=e.geoPointValue,s=t.geoPointValue,0!==(p=rc(rH(n.latitude),rH(s.latitude)))?p:rc(rH(n.longitude),rH(s.longitude));case 9:return r8(e.arrayValue,t.arrayValue);case 10:let g,m,y,v,_;return a=e.mapValue,o=t.mapValue,g=a.fields||{},m=o.fields||{},y=g[r1]?.arrayValue,v=m[r1]?.arrayValue,0!==(_=rc(y?.values?.length||0,v?.values?.length||0))?_:r8(y,v);case 11:return function(e,t){if(e===r0&&t===r0)return 0;if(e===r0)return 1;if(t===r0)return -1;let r=e.fields||{},i=Object.keys(r),n=t.fields||{},s=Object.keys(n);i.sort(),s.sort();for(let e=0;e<i.length&&e<s.length;++e){let t=rd(i[e],s[e]);if(0!==t)return t;let a=r4(r[i[e]],n[s[e]]);if(0!==a)return a}return rc(i.length,s.length)}(e.mapValue,t.mapValue);default:throw t5(23264,{he:l})}}function r5(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return rc(e,t);let r=r$(e),i=r$(t),n=rc(r.seconds,i.seconds);return 0!==n?n:rc(r.nanos,i.nanos)}function r8(e,t){let r=e.values||[],i=t.values||[];for(let e=0;e<r.length&&e<i.length;++e){let t=r4(r[e],i[e]);if(t)return t}return rc(r.length,i.length)}function r7(e){var t,r;let i;return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?(i=r$(e.timestampValue),`time(${i.seconds},${i.nanos})`):"stringValue"in e?e.stringValue:"bytesValue"in e?rz(e.bytesValue).toBase64():"referenceValue"in e?(t=e.referenceValue,rw.fromName(t).toString()):"geoPointValue"in e?(r=e.geoPointValue,`geo(${r.latitude},${r.longitude})`):"arrayValue"in e?function(e){let t="[",r=!0;for(let i of e.values||[])r?r=!1:t+=",",t+=r7(i);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){let t=Object.keys(e.fields||{}).sort(),r="{",i=!0;for(let n of t)i?i=!1:r+=",",r+=`${n}:${r7(e.fields[n])}`;return r+"}"}(e.mapValue):t5(61005,{value:e})}function r9(e){return!!e&&"integerValue"in e}function ie(e){return!!e&&"arrayValue"in e}function it(e){return!!e&&"mapValue"in e}function ir(e){return(e?.mapValue?.fields||{}).__type__?.stringValue==="__vector__"}function ii(e){if(e.geoPointValue)return{geoPointValue:{...e.geoPointValue}};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:{...e.timestampValue}};if(e.mapValue){let t={mapValue:{fields:{}}};return rP(e.mapValue.fields,(e,r)=>t.mapValue.fields[e]=ii(r)),t}if(e.arrayValue){let t={arrayValue:{values:[]}};for(let r=0;r<(e.arrayValue.values||[]).length;++r)t.arrayValue.values[r]=ii(e.arrayValue.values[r]);return t}return{...e}}function is(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===rZ}class ia{constructor(e){this.value=e}static empty(){return new ia({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(!it(t=(t.mapValue.fields||{})[e.get(r)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ii(t)}setAll(e){let t=r_.emptyPath(),r={},i=[];e.forEach((e,n)=>{if(!t.isImmediateParentOf(n)){let e=this.getFieldsMap(t);this.applyChanges(e,r,i),r={},i=[],t=n.popLast()}e?r[n.lastSegment()]=ii(e):i.push(n.lastSegment())});let n=this.getFieldsMap(t);this.applyChanges(n,r,i)}delete(e){let t=this.field(e.popLast());it(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return r6(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];it(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){for(let i of(rP(t,(t,r)=>e[t]=r),r))delete e[i]}clone(){return new ia(ii(this.value))}}class io{constructor(e,t,r,i,n,s,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=n,this.data=s,this.documentState=a}static newInvalidDocument(e){return new io(e,0,rT.min(),rT.min(),rT.min(),ia.empty(),0)}static newFoundDocument(e,t,r,i){return new io(e,1,t,rT.min(),r,i,0)}static newNoDocument(e,t){return new io(e,2,t,rT.min(),rT.min(),ia.empty(),0)}static newUnknownDocument(e,t){return new io(e,3,t,rT.min(),rT.min(),ia.empty(),2)}convertToFoundDocument(e,t){return this.createTime.isEqual(rT.min())&&(2===this.documentType||0===this.documentType)&&(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ia.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ia.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=rT.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof io&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new io(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class il{constructor(e,t){this.position=e,this.inclusive=t}}function ih(e,t,r){let i=0;for(let n=0;n<e.position.length;n++){let s=t[n],a=e.position[n];if(i=s.field.isKeyField()?rw.comparator(rw.fromName(a.referenceValue),r.key):r4(a,r.data.field(s.field)),"desc"===s.dir&&(i*=-1),0!==i)break}return i}function iu(e,t){if(null===e)return null===t;if(null===t||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let r=0;r<e.position.length;r++)if(!r6(e.position[r],t.position[r]))return!1;return!0}class ic{constructor(e,t="asc"){this.field=e,this.dir=t}}class id{}class ip extends id{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,r):new iv(e,t,r):"array-contains"===t?new ib(e,r):"in"===t?new iI(e,r):"not-in"===t?new iT(e,r):"array-contains-any"===t?new iS(e,r):new ip(e,t,r)}static createKeyFieldInFilter(e,t,r){return"in"===t?new i_(e,r):new iw(e,r)}matches(e){let t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(r4(t,this.value)):null!==t&&r2(this.value)===r2(t)&&this.matchesComparison(r4(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return t5(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ig extends id{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new ig(e,t)}matches(e){return im(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.Pe||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function im(e){return"and"===e.op}function iy(e){for(let t of e.filters)if(t instanceof ig)return!1;return!0}class iv extends ip{constructor(e,t,r){super(e,t,r),this.key=rw.fromName(r.referenceValue)}matches(e){let t=rw.comparator(e.key,this.key);return this.matchesComparison(t)}}class i_ extends ip{constructor(e,t){super(e,"in",t),this.keys=iE("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class iw extends ip{constructor(e,t){super(e,"not-in",t),this.keys=iE("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function iE(e,t){return(t.arrayValue?.values||[]).map(e=>rw.fromName(e.referenceValue))}class ib extends ip{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return ie(t)&&r3(t.arrayValue,this.value)}}class iI extends ip{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return null!==t&&r3(this.value.arrayValue,t)}}class iT extends ip{constructor(e,t){super(e,"not-in",t)}matches(e){if(r3(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!r3(this.value.arrayValue,t)}}class iS extends ip{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!ie(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>r3(this.value.arrayValue,e))}}class iC{constructor(e,t=null,r=[],i=[],n=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=n,this.startAt=s,this.endAt=a,this.Te=null}}function iA(e,t=null,r=[],i=[],n=null,s=null,a=null){return new iC(e,t,r,i,n,s,a)}function ik(e){if(null===e.Te){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(e=>(function e(t){if(t instanceof ip)return t.field.canonicalString()+t.op.toString()+r7(t.value);if(iy(t)&&im(t))return t.filters.map(t=>e(t)).join(",");{let r=t.filters.map(t=>e(t)).join(",");return`${t.op}(${r})`}})(e)).join(","),t+="|ob:",t+=e.orderBy.map(e=>e.field.canonicalString()+e.dir).join(","),null==e.limit||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>r7(e)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>r7(e)).join(",")),e.Te=t}return e.Te}function iR(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++){var r,i;if(r=e.orderBy[n],i=t.orderBy[n],!(r.dir===i.dir&&r.field.isEqual(i.field)))return!1}if(e.filters.length!==t.filters.length)return!1;for(let r=0;r<e.filters.length;r++)if(!function e(t,r){return t instanceof ip?r instanceof ip&&t.op===r.op&&t.field.isEqual(r.field)&&r6(t.value,r.value):t instanceof ig?r instanceof ig&&t.op===r.op&&t.filters.length===r.filters.length&&t.filters.reduce((t,i,n)=>t&&e(i,r.filters[n]),!0):void t5(19439)}(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!iu(e.startAt,t.startAt)&&iu(e.endAt,t.endAt)}class iN{constructor(e,t=null,r=[],i=[],n=null,s="F",a=null,o=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=n,this.limitType=s,this.startAt=a,this.endAt=o,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function iO(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function iP(e){if(null===e.Ie){let t;e.Ie=[];let r=new Set;for(let t of e.explicitOrderBy)e.Ie.push(t),r.add(t.field.canonicalString());let i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(t=new rM(r_.comparator),e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t).forEach(t=>{r.has(t.canonicalString())||t.isKeyField()||e.Ie.push(new ic(t,i))}),r.has(r_.keyField().canonicalString())||e.Ie.push(new ic(r_.keyField(),i))}return e.Ie}function iD(e){return e.Ee||(e.Ee=function(e,t){if("F"===e.limitType)return iA(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{let t="desc"===e.dir?"asc":"desc";return new ic(e.field,t)});let r=e.endAt?new il(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new il(e.startAt.position,e.startAt.inclusive):null;return iA(e.path,e.collectionGroup,t,e.filters,e.limit,r,i)}}(e,iP(e))),e.Ee}function ix(e,t,r){return new iN(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,r,e.startAt,e.endAt)}function iL(e,t){return iR(iD(e),iD(t))&&e.limitType===t.limitType}function iM(e){return`${ik(iD(e))}|lt:${e.limitType}`}function iU(e){var t;let r;return`Query(target=${r=(t=iD(e)).path.canonicalString(),null!==t.collectionGroup&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(e=>(function e(t){return t instanceof ip?`${t.field.canonicalString()} ${t.op} ${r7(t.value)}`:t instanceof ig?t.op.toString()+" {"+t.getFilters().map(e).join(" ,")+"}":"Filter"})(e)).join(", ")}]`),null==t.limit||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(e=>`${e.field.canonicalString()} (${e.dir})`).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(e=>r7(e)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(e=>r7(e)).join(",")),`Target(${r})`}; limitType=${e.limitType})`}function iV(e,t){var r,i,n,s;let a,o,l;return t.isFoundDocument()&&(a=t.key.path,null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(a):rw.isDocumentKey(e.path)?e.path.isEqual(a):e.path.isImmediateParentOf(a))&&function(e,t){for(let r of iP(e))if(!r.field.isKeyField()&&null===t.data.field(r.field))return!1;return!0}(e,t)&&function(e,t){for(let r of e.filters)if(!r.matches(t))return!1;return!0}(e,t)&&(r=e,i=t,(!r.startAt||(n=r.startAt,o=ih(n,iP(r),i),n.inclusive?!!(o<=0):!!(o<0)))&&(!r.endAt||(s=r.endAt,l=ih(s,iP(r),i),s.inclusive?!!(l>=0):!!(l>0))))}class iF{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r){for(let[t,i]of r)if(this.equalsFn(t,e))return i}}has(e){return void 0!==this.get(e)}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(void 0===i)return this.inner[r]=[[e,t]],void this.innerSize++;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return void(i[r]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return 1===r.length?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){rP(this.inner,(t,r)=>{for(let[t,i]of r)e(t,i)})}isEmpty(){var e=this.inner;for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}size(){return this.innerSize}}let ij=new rD(rw.comparator),iB=new rD(rw.comparator);function i$(...e){let t=iB;for(let r of e)t=t.insert(r.key,r);return t}function iH(){return new iF(e=>e.toString(),(e,t)=>e.isEqual(t))}new rD(rw.comparator);let iz=new rM(rw.comparator);function iq(...e){let t=iz;for(let r of e)t=t.add(r);return t}let iK=new rM(rc);class iW{constructor(){this._=void 0}}class iG extends iW{}class iJ extends iW{constructor(e){super(),this.elements=e}}function iX(e,t){let r=i1(t);for(let t of e.elements)r.some(e=>r6(e,t))||r.push(t);return{arrayValue:{values:r}}}class iQ extends iW{constructor(e){super(),this.elements=e}}function iY(e,t){let r=i1(t);for(let t of e.elements)r=r.filter(e=>!r6(e,t));return{arrayValue:{values:r}}}class iZ extends iW{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function i0(e){return rH(e.integerValue||e.doubleValue)}function i1(e){return ie(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class i2{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new i2}static exists(e){return new i2(void 0,e)}static updateTime(e){return new i2(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function i6(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class i3{}function i4(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new ni(e.key,i2.none()):new i7(e.key,e.data,i2.none());{let r=e.data,i=ia.empty(),n=new rM(r_.comparator);for(let e of t.fields)if(!n.has(e)){let t=r.field(e);null===t&&e.length>1&&(e=e.popLast(),t=r.field(e)),null===t?i.delete(e):i.set(e,t),n=n.add(e)}return new i9(e.key,i,new rV(n.toArray()),i2.none())}}function i5(e,t,r,i){return e instanceof i7?function(e,t,r,i){if(!i6(e.precondition,t))return r;let n=e.value.clone(),s=nr(e.fieldTransforms,i,t);return n.setAll(s),t.convertToFoundDocument(t.version,n).setHasLocalMutations(),null}(e,t,r,i):e instanceof i9?function(e,t,r,i){if(!i6(e.precondition,t))return r;let n=nr(e.fieldTransforms,i,t),s=t.data;return(s.setAll(ne(e)),s.setAll(n),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===r)?null:r.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,r,i):i6(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):r}function i8(e,t){var r,i;return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(r=e.fieldTransforms,i=t.fieldTransforms,!!(void 0===r&&void 0===i||!(!r||!i)&&rp(r,i,(e,t)=>{var r,i;return e.field.isEqual(t.field)&&(r=e.transform,i=t.transform,r instanceof iJ&&i instanceof iJ||r instanceof iQ&&i instanceof iQ?rp(r.elements,i.elements,r6):r instanceof iZ&&i instanceof iZ?r6(r.Ae,i.Ae):r instanceof iG&&i instanceof iG)})))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class i7 extends i3{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class i9 extends i3{constructor(e,t,r,i,n=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=n,this.type=1}getFieldMask(){return this.fieldMask}}function ne(e){let t=new Map;return e.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){let i=e.data.field(r);t.set(r,i)}}),t}function nt(e,t,r){let i=new Map;t7(e.length===r.length,32656,{Re:r.length,Ve:e.length});for(let s=0;s<r.length;s++){var n;let a=e[s],o=a.transform,l=t.data.field(a.field);i.set(a.field,(n=r[s],o instanceof iJ?iX(o,l):o instanceof iQ?iY(o,l):n))}return i}function nr(e,t,r){let i=new Map;for(let n of e){let e=n.transform,s=r.data.field(n.field);i.set(n.field,function(e,t,r){var i;let n,s,a;return e instanceof iG?(i=t,n={fields:{[rK]:{stringValue:rq},[rG]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}},i&&rJ(i)&&(i=function e(t){let r=t.mapValue.fields[rW];return rJ(r)?e(r):r}(i)),i&&(n.fields[rW]=i),{mapValue:n}):e instanceof iJ?iX(e,t):e instanceof iQ?iY(e,t):(a=i0(s=function(e,t){return e instanceof iZ?r9(t)||t&&"doubleValue"in t?t:{integerValue:0}:null}(e,t))+i0(e.Ae),r9(s)&&r9(e.Ae)?{integerValue:""+a}:function(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:rN(t)?"-0":t}}(e.serializer,a))}(e,s,t))}return i}class ni extends i3{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class nn{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let t=0;t<this.mutations.length;t++){let i=this.mutations[t];i.key.isEqual(e.key)&&function(e,t,r){let i,n;e instanceof i7?(i=e.value.clone(),n=nt(e.fieldTransforms,t,r.transformResults),i.setAll(n),t.convertToFoundDocument(r.version,i).setHasCommittedMutations()):e instanceof i9?function(e,t,r){if(!i6(e.precondition,t))return t.convertToUnknownDocument(r.version);let i=nt(e.fieldTransforms,t,r.transformResults),n=t.data;n.setAll(ne(e)),n.setAll(i),t.convertToFoundDocument(r.version,n).setHasCommittedMutations()}(e,t,r):t.convertToNoDocument(r.version).setHasCommittedMutations()}(i,e,r[t])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=i5(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=i5(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=iH();return this.mutations.forEach(i=>{let n=e.get(i.key),s=n.overlayedDocument,a=this.applyToLocalView(s,n.mutatedFields),o=i4(s,a=t.has(i.key)?null:a);null!==o&&r.set(i.key,o),s.isValidDocument()||s.convertToNoDocument(rT.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),iq())}isEqual(e){return this.batchId===e.batchId&&rp(this.mutations,e.mutations,(e,t)=>i8(e,t))&&rp(this.baseMutations,e.baseMutations,(e,t)=>i8(e,t))}}class ns{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}(E=w||(w={}))[E.OK=0]="OK",E[E.CANCELLED=1]="CANCELLED",E[E.UNKNOWN=2]="UNKNOWN",E[E.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",E[E.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",E[E.NOT_FOUND=5]="NOT_FOUND",E[E.ALREADY_EXISTS=6]="ALREADY_EXISTS",E[E.PERMISSION_DENIED=7]="PERMISSION_DENIED",E[E.UNAUTHENTICATED=16]="UNAUTHENTICATED",E[E.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",E[E.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",E[E.ABORTED=10]="ABORTED",E[E.OUT_OF_RANGE=11]="OUT_OF_RANGE",E[E.UNIMPLEMENTED=12]="UNIMPLEMENTED",E[E.INTERNAL=13]="INTERNAL",E[E.UNAVAILABLE=14]="UNAVAILABLE",E[E.DATA_LOSS=15]="DATA_LOSS",new c([0xffffffff,0xffffffff],0);class na{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function no(e){let t;return t7(!!e,49232),rT.fromTimestamp(new rI((t=r$(e)).seconds,t.nanos))}function nl(e,t){let r=new ry(["projects",e.projectId,"databases",e.database]).child("documents");return void 0===t?r:r.child(t)}function nh(e){return r_.fromServerFormat(e.fieldPath)}class nu{constructor(e){this.yt=e}}class nc{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(+!!e.booleanValue);else if("integerValue"in e)this.Ft(t,15),t.Mt(rH(e.integerValue));else if("doubleValue"in e){let r=rH(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),rN(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),"string"==typeof r&&(r=r$(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(rz(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?is(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):ir(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):t5(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){let r=e.fields||{};for(let e of(this.Ft(t,55),Object.keys(r)))this.Ot(e,t),this.Ct(r[e],t)}kt(e,t){let r=e.fields||{};this.Ft(t,53);let i=r[r1].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(rH(i)),this.Ot(r1,t),this.Ct(r[r1],t)}Qt(e,t){let r=e.values||[];for(let e of(this.Ft(t,50),r))this.Ct(e,t)}Lt(e,t){this.Ft(t,37),rw.fromName(e).path.forEach(e=>{this.Ft(t,60),this.Ut(e,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}nc.Kt=new nc;class nd{constructor(){this.Cn=new nf}addToCollectionParentIndex(e,t){return this.Cn.add(t),rA.resolve()}getCollectionParents(e,t){return rA.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return rA.resolve()}deleteFieldIndex(e,t){return rA.resolve()}deleteAllFieldIndexes(e){return rA.resolve()}createTargetIndexes(e,t){return rA.resolve()}getDocumentsMatchingTarget(e,t){return rA.resolve(null)}getIndexType(e,t){return rA.resolve(0)}getFieldIndexes(e,t){return rA.resolve([])}getNextCollectionGroupToUpdate(e){return rA.resolve(null)}getMinOffset(e,t){return rA.resolve(rS.min())}getMinOffsetFromCollectionGroup(e,t){return rA.resolve(rS.min())}updateCollectionGroup(e,t,r){return rA.resolve()}updateIndexEntries(e,t){return rA.resolve()}}class nf{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new rM(ry.comparator),n=!i.has(r);return this.index[t]=i.add(r),n}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new rM(ry.comparator)).toArray()}}new Uint8Array(0);class np{static withCacheSize(e){return new np(e,np.DEFAULT_COLLECTION_PERCENTILE,np.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}np.DEFAULT_COLLECTION_PERCENTILE=10,np.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,np.DEFAULT=new np(0x2800000,np.DEFAULT_COLLECTION_PERCENTILE,np.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),np.DISABLED=new np(-1,0,0);class ng{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new ng(0)}static cr(){return new ng(-1)}}class nm{constructor(){this.changes=new iF(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,io.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return void 0!==r?rA.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class ny{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class nv{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==r&&i5(r.mutation,e,rV.empty(),rI.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,iq()).next(()=>t))}getLocalViewOfDocuments(e,t,r=iq()){let i=iH();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(e=>{let t=i$();return e.forEach((e,r)=>{t=t.insert(e,r.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){let r=iH();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,iq()))}populateOverlays(e,t,r){let i=[];return r.forEach(e=>{t.has(e)||i.push(e)}),this.documentOverlayCache.getOverlays(e,i).next(e=>{e.forEach((e,r)=>{t.set(e,r)})})}computeViews(e,t,r,i){let n=ij,s=iH(),a=iH();return t.forEach((e,t)=>{let a=r.get(t.key);i.has(t.key)&&(void 0===a||a.mutation instanceof i9)?n=n.insert(t.key,t):void 0!==a?(s.set(t.key,a.mutation.getFieldMask()),i5(a.mutation,t,a.mutation.getFieldMask(),rI.now())):s.set(t.key,rV.empty())}),this.recalculateAndSaveOverlays(e,n).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>a.set(e,new ny(t,s.get(e)??null))),a))}recalculateAndSaveOverlays(e,t){let r=iH(),i=new rD((e,t)=>e-t),n=iq();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(let n of e)n.keys().forEach(e=>{let s=t.get(e);if(null===s)return;let a=r.get(e)||rV.empty();a=n.applyToLocalView(s,a),r.set(e,a);let o=(i.get(n.batchId)||iq()).add(e);i=i.insert(n.batchId,o)})}).next(()=>{let s=[],a=i.getReverseIterator();for(;a.hasNext();){let i=a.getNext(),o=i.key,l=i.value,h=iH();l.forEach(e=>{if(!n.has(e)){let i=i4(t.get(e),r.get(e));null!==i&&h.set(e,i),n=n.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,o,h))}return rA.waitFor(s)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,r,i){return rw.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):null!==t.collectionGroup?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(n=>{let s=i-n.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-n.size):rA.resolve(iH()),a=-1,o=n;return s.next(t=>rA.forEach(t,(t,r)=>(a<r.largestBatchId&&(a=r.largestBatchId),n.get(t)?rA.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{o=o.insert(t,e)}))).next(()=>this.populateOverlays(e,t,n)).next(()=>this.computeViews(e,o,t,iq())).next(e=>{let t;return{batchId:a,changes:(t=iB,e.forEach((e,r)=>t=t.insert(e,r.overlayedDocument)),t)}}))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new rw(t)).next(e=>{let t=i$();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let n=t.collectionGroup,s=i$();return this.indexManager.getCollectionParents(e,n).next(a=>rA.forEach(a,a=>{let o=new iN(a.child(n),null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt);return this.getDocumentsMatchingCollectionQuery(e,o,r,i).next(e=>{e.forEach((e,t)=>{s=s.insert(e,t)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,r,i){let n;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(s=>(n=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,n,i))).next(e=>{n.forEach((t,r)=>{let i=r.getKey();null===e.get(i)&&(e=e.insert(i,io.newInvalidDocument(i)))});let r=i$();return e.forEach((e,i)=>{let s=n.get(e);void 0!==s&&i5(s.mutation,i,rV.empty(),rI.now()),iV(t,i)&&(r=r.insert(e,i))}),r})}}class n_{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return rA.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,{id:t.id,version:t.version,createTime:no(t.createTime)}),rA.resolve()}getNamedQuery(e,t){return rA.resolve(this.kr.get(t))}saveNamedQuery(e,t){var r;let i;return this.kr.set(t.name,{name:t.name,query:(i=function(e){var t,r,i,n,s,a,o;let l,h,u,c,d,f,p=(t=e.parent,t7((a=l=ry.fromString(t)).length>=4&&"projects"===a.get(0)&&"databases"===a.get(2),10190,{key:l.toString()}),4===(h=l).length?ry.emptyPath():(t7((o=h).length>4&&"documents"===o.get(4),29091,{key:o.toString()}),o.popFirst(5))),g=e.structuredQuery,m=g.from?g.from.length:0,y=null;if(m>0){t7(1===m,65062);let e=g.from[0];e.allDescendants?y=e.collectionId:p=p.child(e.collectionId)}let v=[];g.where&&(v=(u=function e(t){return void 0!==t.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":let t=nh(e.unaryFilter.field);return ip.create(t,"==",{doubleValue:NaN});case"IS_NULL":let r=nh(e.unaryFilter.field);return ip.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let i=nh(e.unaryFilter.field);return ip.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let n=nh(e.unaryFilter.field);return ip.create(n,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return t5(61313);default:return t5(60726)}}(t):void 0!==t.fieldFilter?ip.create(nh(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return t5(58110);default:return t5(50506)}}(t.fieldFilter.op),t.fieldFilter.value):void 0!==t.compositeFilter?ig.create(t.compositeFilter.filters.map(t=>e(t)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return t5(1026)}}(t.compositeFilter.op)):t5(30097,{filter:t})}(g.where))instanceof ig&&iy(r=u)&&im(r)?u.getFilters():[u]);let _=[];g.orderBy&&(_=g.orderBy.map(e=>new ic(nh(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))));let w=null;g.limit&&(w=null==(c="object"==typeof(i=g.limit)?i.value:i)?null:c);let E=null;g.startAt&&(d=!!(n=g.startAt).before,E=new il(n.values||[],d));let b=null;return g.endAt&&(f=!(s=g.endAt).before,b=new il(s.values||[],f)),new iN(p,y,_,v,w,"F",E,b)}({parent:(r=t.bundledQuery).parent,structuredQuery:r.structuredQuery}),"LAST"===r.limitType?ix(i,i.limit,"L"):i),readTime:no(t.readTime)}),rA.resolve()}}class nw{constructor(){this.overlays=new rD(rw.comparator),this.qr=new Map}getOverlay(e,t){return rA.resolve(this.overlays.get(t))}getOverlays(e,t){let r=iH();return rA.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&r.set(t,e)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((r,i)=>{this.St(e,t,i)}),rA.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.qr.get(r);return void 0!==i&&(i.forEach(e=>this.overlays=this.overlays.remove(e)),this.qr.delete(r)),rA.resolve()}getOverlaysForCollection(e,t,r){let i=iH(),n=t.length+1,s=new rw(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){let e=a.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===n&&e.largestBatchId>r&&i.set(e.getKey(),e)}return rA.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let n=new rD((e,t)=>e-t),s=this.overlays.getIterator();for(;s.hasNext();){let e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>r){let t=n.get(e.largestBatchId);null===t&&(t=iH(),n=n.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}let a=iH(),o=n.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach((e,t)=>a.set(e,t)),!(a.size()>=i)););return rA.resolve(a)}St(e,t,r){let i=this.overlays.get(r.key);if(null!==i){let e=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,e)}this.overlays=this.overlays.insert(r.key,new ns(t,r));let n=this.qr.get(t);void 0===n&&(n=iq(),this.qr.set(t,n)),this.qr.set(t,n.add(r.key))}}class nE{constructor(){this.sessionToken=rj.EMPTY_BYTE_STRING}getSessionToken(e){return rA.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,rA.resolve()}}class nb{constructor(){this.Qr=new rM(nI.$r),this.Ur=new rM(nI.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){let r=new nI(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Gr(new nI(e,t))}zr(e,t){e.forEach(e=>this.removeReference(e,t))}jr(e){let t=new rw(new ry([])),r=new nI(t,e),i=new nI(t,e+1),n=[];return this.Ur.forEachInRange([r,i],e=>{this.Gr(e),n.push(e.key)}),n}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){let t=new rw(new ry([])),r=new nI(t,e),i=new nI(t,e+1),n=iq();return this.Ur.forEachInRange([r,i],e=>{n=n.add(e.key)}),n}containsKey(e){let t=new nI(e,0),r=this.Qr.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class nI{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return rw.comparator(e.key,t.key)||rc(e.Yr,t.Yr)}static Kr(e,t){return rc(e.Yr,t.Yr)||rw.comparator(e.key,t.key)}}class nT{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new rM(nI.$r)}checkEmpty(e){return rA.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,i){let n=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new nn(n,t,r,i);for(let t of(this.mutationQueue.push(s),i))this.Zr=this.Zr.add(new nI(t.key,n)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return rA.resolve(s)}lookupMutationBatch(e,t){return rA.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){let r=this.ei(t+1),i=r<0?0:r;return rA.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return rA.resolve(0===this.mutationQueue.length?-1:this.tr-1)}getAllMutationBatches(e){return rA.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new nI(t,0),i=new nI(t,1/0),n=[];return this.Zr.forEachInRange([r,i],e=>{let t=this.Xr(e.Yr);n.push(t)}),rA.resolve(n)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new rM(rc);return t.forEach(e=>{let t=new nI(e,0),i=new nI(e,1/0);this.Zr.forEachInRange([t,i],e=>{r=r.add(e.Yr)})}),rA.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,n=r;rw.isDocumentKey(n)||(n=n.child(""));let s=new nI(new rw(n),0),a=new rM(rc);return this.Zr.forEachWhile(e=>{let t=e.key.path;return!!r.isPrefixOf(t)&&(t.length===i&&(a=a.add(e.Yr)),!0)},s),rA.resolve(this.ti(a))}ti(e){let t=[];return e.forEach(e=>{let r=this.Xr(e);null!==r&&t.push(r)}),t}removeMutationBatch(e,t){t7(0===this.ni(t.batchId,"removed"),55003),this.mutationQueue.shift();let r=this.Zr;return rA.forEach(t.mutations,i=>{let n=new nI(i.key,t.batchId);return r=r.delete(n),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,t){let r=new nI(t,0),i=this.Zr.firstAfterOrEqual(r);return rA.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,rA.resolve()}ni(e,t){return this.ei(e)}ei(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Xr(e){let t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class nS{constructor(e){this.ri=e,this.docs=new rD(rw.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),n=i?i.size:0,s=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-n,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return rA.resolve(r?r.document.mutableCopy():io.newInvalidDocument(t))}getEntries(e,t){let r=ij;return t.forEach(e=>{let t=this.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():io.newInvalidDocument(e))}),rA.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let n=ij,s=t.path,a=new rw(s.child("__id-9223372036854775808__")),o=this.docs.getIteratorFrom(a);for(;o.hasNext();){let{key:e,value:{document:a}}=o.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||0>=function(e,t){let r=e.readTime.compareTo(t.readTime);return 0!==r||0!==(r=rw.comparator(e.documentKey,t.documentKey))?r:rc(e.largestBatchId,t.largestBatchId)}(new rS(a.readTime,a.key,-1),r)||(i.has(a.key)||iV(t,a))&&(n=n.insert(a.key,a.mutableCopy()))}return rA.resolve(n)}getAllFromCollectionGroup(e,t,r,i){t5(9500)}ii(e,t){return rA.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new nC(this)}getSize(e){return rA.resolve(this.size)}}class nC extends nm{constructor(e){super(),this.Nr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)}),rA.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class nA{constructor(e){this.persistence=e,this.si=new iF(e=>ik(e),iR),this.lastRemoteSnapshotVersion=rT.min(),this.highestTargetId=0,this.oi=0,this._i=new nb,this.targetCount=0,this.ai=ng.ur()}forEachTarget(e,t){return this.si.forEach((e,r)=>t(r)),rA.resolve()}getLastRemoteSnapshotVersion(e){return rA.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return rA.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),rA.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),rA.resolve()}Pr(e){this.si.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.ai=new ng(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,rA.resolve()}updateTargetData(e,t){return this.Pr(t),rA.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,rA.resolve()}removeTargets(e,t,r){let i=0,n=[];return this.si.forEach((s,a)=>{a.sequenceNumber<=t&&null===r.get(a.targetId)&&(this.si.delete(s),n.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),rA.waitFor(n).next(()=>i)}getTargetCount(e){return rA.resolve(this.targetCount)}getTargetData(e,t){let r=this.si.get(t)||null;return rA.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),rA.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);let i=this.persistence.referenceDelegate,n=[];return i&&t.forEach(t=>{n.push(i.markPotentiallyOrphaned(e,t))}),rA.waitFor(n)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),rA.resolve()}getMatchingKeysForTargetId(e,t){let r=this._i.Hr(t);return rA.resolve(r)}containsKey(e,t){return rA.resolve(this._i.containsKey(t))}}class nk{constructor(e,t){this.ui={},this.overlays={},this.ci=new rR(0),this.li=!1,this.li=!0,this.hi=new nE,this.referenceDelegate=e(this),this.Pi=new nA(this),this.indexManager=new nd,this.remoteDocumentCache=new nS(e=>this.referenceDelegate.Ti(e)),this.serializer=new nu(t),this.Ii=new n_(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new nw,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new nT(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){t2("MemoryPersistence","Starting transaction:",e);let i=new nR(this.ci.next());return this.referenceDelegate.Ei(),r(i).next(e=>this.referenceDelegate.di(i).next(()=>e)).toPromise().then(e=>(i.raiseOnCommittedEvent(),e))}Ai(e,t){return rA.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,t)))}}class nR extends rC{constructor(e){super(),this.currentSequenceNumber=e}}class nN{constructor(e){this.persistence=e,this.Ri=new nb,this.Vi=null}static mi(e){return new nN(e)}get fi(){if(this.Vi)return this.Vi;throw t5(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),rA.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),rA.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),rA.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(e=>this.fi.add(e.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.fi.add(e.toString()))}).next(()=>r.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return rA.forEach(this.fi,r=>{let i=rw.fromPath(r);return this.gi(e,i).next(e=>{e||t.removeEntry(i,rT.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(e=>{e?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return rA.or([()=>rA.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class nO{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=iq(),i=iq();for(let e of t.docChanges)switch(e.type){case 0:r=r.add(e.doc.key);break;case 1:i=i.add(e.doc.key)}return new nO(e,t.fromCache,r,i)}}class nP{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class nD{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){let t;return!function(){let t=x()?.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(e.g.process)}catch(e){return!1}}()&&navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")?8:Number((t=K().match(/Android ([\d.]+)/i))?t[1].split(".").slice(0,2).join("."):"-1")>0?6:4}()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){let n={result:null};return this.ys(e,t).next(e=>{n.result=e}).next(()=>{if(!n.result)return this.ws(e,t,i,r).next(e=>{n.result=e})}).next(()=>{if(n.result)return;let r=new nP;return this.Ss(e,t,r).next(i=>{if(n.result=i,this.Vs)return this.bs(e,t,r,i.size)})}).next(()=>n.result)}bs(e,t,r,i){return r.documentReadCount<this.fs?(t1()<=l.DEBUG&&t2("QueryEngine","SDK will not create cache indexes for query:",iU(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),rA.resolve()):(t1()<=l.DEBUG&&t2("QueryEngine","Query:",iU(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(t1()<=l.DEBUG&&t2("QueryEngine","The SDK decides to create cache indexes for query:",iU(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,iD(t))):rA.resolve())}ys(e,t){if(iO(t))return rA.resolve(null);let r=iD(t);return this.indexManager.getIndexType(e,r).next(i=>0===i?null:(null!==t.limit&&1===i&&(r=iD(t=ix(t,null,"F"))),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{let n=iq(...i);return this.ps.getDocuments(e,n).next(i=>this.indexManager.getMinOffset(e,r).next(r=>{let s=this.Ds(t,i);return this.Cs(t,s,n,r.readTime)?this.ys(e,ix(t,null,"F")):this.vs(e,s,t,r)}))})))}ws(e,t,r,i){return iO(t)||i.isEqual(rT.min())?rA.resolve(null):this.ps.getDocuments(e,r).next(n=>{let s,a,o=this.Ds(t,n);return this.Cs(t,o,r,i)?rA.resolve(null):(t1()<=l.DEBUG&&t2("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),iU(t)),this.vs(e,o,t,(s=i.toTimestamp().seconds,a=i.toTimestamp().nanoseconds+1,new rS(rT.fromTimestamp(1e9===a?new rI(s+1,0):new rI(s,a)),rw.empty(),-1))).next(e=>e))})}Ds(e,t){let r=new rM((t,r)=>{let i=!1;for(let n of iP(e)){let e=function(e,t,r){var i;let n,s,a=e.field.isKeyField()?rw.comparator(t.key,r.key):(i=e.field,n=t.data.field(i),s=r.data.field(i),null!==n&&null!==s?r4(n,s):t5(42886));switch(e.dir){case"asc":return a;case"desc":return -1*a;default:return t5(19790,{direction:e.dir})}}(n,t,r);if(0!==e)return e;i=i||n.field.isKeyField()}return 0});return t.forEach((t,i)=>{iV(e,i)&&(r=r.add(i))}),r}Cs(e,t,r,i){if(null===e.limit)return!1;if(r.size!==t.size)return!0;let n="F"===e.limitType?t.last():t.first();return!!n&&(n.hasPendingWrites||n.version.compareTo(i)>0)}Ss(e,t,r){return t1()<=l.DEBUG&&t2("QueryEngine","Using full collection scan to execute query:",iU(t)),this.ps.getDocumentsMatchingQuery(e,t,rS.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}class nx{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new rD(rc),this.xs=new iF(e=>ik(e),iR),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new nv(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}async function nL(e,t){return await e.persistence.runTransaction("Handle user change","readonly",r=>{let i;return e.mutationQueue.getAllMutationBatches(r).next(n=>(i=n,e.Bs(t),e.mutationQueue.getAllMutationBatches(r))).next(t=>{let n=[],s=[],a=iq();for(let e of i)for(let t of(n.push(e.batchId),e.mutations))a=a.add(t.key);for(let e of t)for(let t of(s.push(e.batchId),e.mutations))a=a.add(t.key);return e.localDocuments.getDocuments(r,a).next(e=>({Ls:e,removedBatchIds:n,addedBatchIds:s}))})})}class nM{constructor(){this.activeTargetIds=iK}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){return JSON.stringify({activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()})}}class nU{constructor(){this.Mo=new nM,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new nM,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class nV{Oo(e){}shutdown(){}}let nF="ConnectivityMonitor";class nj{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){for(let e of(t2(nF,"Network connectivity changed: AVAILABLE"),this.qo))e(0)}ko(){for(let e of(t2(nF,"Network connectivity changed: UNAVAILABLE"),this.qo))e(1)}static v(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let nB=null;function n$(){return null===nB?nB=0x10000000+Math.round(0x80000000*Math.random()):nB++,"0x"+nB.toString(16)}let nH="RestConnection",nz={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class nq{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===rQ?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,n){let s=n$(),a=this.zo(e,t.toUriEncodedString());t2(nH,`Sending RPC '${e}' ${s}:`,a,r);let o={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(o,i,n);let{host:l}=new URL(a),h=j(l);return this.Jo(e,a,o,r,h).then(t=>(t2(nH,`Received RPC '${e}' ${s}: `,t),t),t=>{throw t3(nH,`RPC '${e}' ${s} failed with error: `,t,"url: ",a,"request:",r),t})}Ho(e,t,r,i,n,s){return this.Go(e,t,r,i,n)}jo(e,t,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+tZ,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,r)=>e[r]=t),r&&r.headers.forEach((t,r)=>e[r]=t)}zo(e,t){let r=nz[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class nK{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}let nW="WebChannelConnection";class nG extends nq{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,n){let s=n$();return new Promise((n,a)=>{let o=new d;o.setWithCredentials(!0),o.listenOnce(p.COMPLETE,()=>{try{switch(o.getLastErrorCode()){case g.NO_ERROR:let t=o.getResponseJson();t2(nW,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(t)),n(t);break;case g.TIMEOUT:t2(nW,`RPC '${e}' ${s} timed out`),a(new re(t9.DEADLINE_EXCEEDED,"Request time out"));break;case g.HTTP_ERROR:let r=o.getStatus();if(t2(nW,`RPC '${e}' ${s} failed with status:`,r,"response text:",o.getResponseText()),r>0){let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);let t=e?.error;if(t&&t.status&&t.message){let e,r=(e=t.status.toLowerCase().replace(/_/g,"-"),Object.values(t9).indexOf(e)>=0?e:t9.UNKNOWN);a(new re(r,t.message))}else a(new re(t9.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new re(t9.UNAVAILABLE,"Connection failed."));break;default:t5(9055,{l_:e,streamId:s,h_:o.getLastErrorCode(),P_:o.getLastError()})}}finally{t2(nW,`RPC '${e}' ${s} completed.`)}});let l=JSON.stringify(i);t2(nW,`RPC '${e}' ${s} sending request:`,i),o.send(t,"POST",l,r,15)})}T_(e,t,r){let i=n$(),n=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=_(),a=v(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(o.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(o.useFetchStreams=!0),this.jo(o.initMessageHeaders,t,r),o.encodeInitMessageHeaders=!0;let h=n.join("");t2(nW,`Creating RPC '${e}' stream ${i}: ${h}`,o);let u=s.createWebChannel(h,o);this.I_(u);let c=!1,d=!1,p=new nK({Yo:t=>{d?t2(nW,`Not sending because RPC '${e}' stream ${i} is closed:`,t):(c||(t2(nW,`Opening RPC '${e}' stream ${i} transport.`),u.open(),c=!0),t2(nW,`RPC '${e}' stream ${i} sending:`,t),u.send(t))},Zo:()=>u.close()}),g=(e,t,r)=>{e.listen(t,e=>{try{r(e)}catch(e){setTimeout(()=>{throw e},0)}})};return g(u,f.EventType.OPEN,()=>{d||(t2(nW,`RPC '${e}' stream ${i} transport opened.`),p.o_())}),g(u,f.EventType.CLOSE,()=>{d||(d=!0,t2(nW,`RPC '${e}' stream ${i} transport closed`),p.a_(),this.E_(u))}),g(u,f.EventType.ERROR,t=>{d||(d=!0,t3(nW,`RPC '${e}' stream ${i} transport errored. Name:`,t.name,"Message:",t.message),p.a_(new re(t9.UNAVAILABLE,"The operation could not be completed")))}),g(u,f.EventType.MESSAGE,t=>{if(!d){let r=t.data[0];t7(!!r,16349);let n=r?.error||r[0]?.error;if(n){t2(nW,`RPC '${e}' stream ${i} received error:`,n);let t=n.status,r=function(e){let t=w[e];if(void 0!==t){if(void 0===t)return t6("GRPC error has no .code"),t9.UNKNOWN;switch(t){case w.OK:return t9.OK;case w.CANCELLED:return t9.CANCELLED;case w.UNKNOWN:return t9.UNKNOWN;case w.DEADLINE_EXCEEDED:return t9.DEADLINE_EXCEEDED;case w.RESOURCE_EXHAUSTED:return t9.RESOURCE_EXHAUSTED;case w.INTERNAL:return t9.INTERNAL;case w.UNAVAILABLE:return t9.UNAVAILABLE;case w.UNAUTHENTICATED:return t9.UNAUTHENTICATED;case w.INVALID_ARGUMENT:return t9.INVALID_ARGUMENT;case w.NOT_FOUND:return t9.NOT_FOUND;case w.ALREADY_EXISTS:return t9.ALREADY_EXISTS;case w.PERMISSION_DENIED:return t9.PERMISSION_DENIED;case w.FAILED_PRECONDITION:return t9.FAILED_PRECONDITION;case w.ABORTED:return t9.ABORTED;case w.OUT_OF_RANGE:return t9.OUT_OF_RANGE;case w.UNIMPLEMENTED:return t9.UNIMPLEMENTED;case w.DATA_LOSS:return t9.DATA_LOSS;default:return t5(39323,{code:t})}}}(t),s=n.message;void 0===r&&(r=t9.INTERNAL,s="Unknown error status: "+t+" with message "+n.message),d=!0,p.a_(new re(r,s)),u.close()}else t2(nW,`RPC '${e}' stream ${i} received:`,r),p.u_(r)}}),g(a,y.STAT_EVENT,t=>{t.stat===m.PROXY?t2(nW,`RPC '${e}' stream ${i} detected buffering proxy`):t.stat===m.NOPROXY&&t2(nW,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{p.__()},0),p}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function nJ(){return"undefined"!=typeof document?document:null}class nX{constructor(e,t,r=1e3,i=1.5,n=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=n,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();let t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&t2("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){null!==this.m_&&(this.m_.skipDelay(),this.m_=null)}cancel(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}class nQ{}class nY extends nQ{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new re(t9.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([n,s])=>this.connection.Go(e,nl(t,r),i,n,s)).catch(e=>{throw"FirebaseError"===e.name?(e.code===t9.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new re(t9.UNKNOWN,e.toString())})}Ho(e,t,r,i,n){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Ho(e,nl(t,r),i,s,a,n)).catch(e=>{throw"FirebaseError"===e.name?(e.code===t9.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new re(t9.UNKNOWN,e.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class nZ{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){0===this.oa&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){"Online"===this.state?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,"Online"===e&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(t6(t),this.aa=!1):t2("OnlineStateTracker",t)}Pa(){null!==this._a&&(this._a.cancel(),this._a=null)}}let n0="RemoteStore";class n1{constructor(e,t,r,i,n){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=n,this.Aa.Oo(e=>{r.enqueueAndForget(async()=>{n3(this)&&(t2(n0,"Restarting streams for network reachability change."),await async function(e){e.Ea.add(4),await n6(e),e.Ra.set("Unknown"),e.Ea.delete(4),await n2(e)}(this))})}),this.Ra=new nZ(r,i)}}async function n2(e){if(n3(e))for(let t of e.da)await t(!0)}async function n6(e){for(let t of e.da)await t(!1)}function n3(e){return 0===e.Ea.size}async function n4(e,t){t?(e.Ea.delete(2),await n2(e)):t||(e.Ea.add(2),await n6(e),e.Ra.set("Unknown"))}class n5{constructor(e,t,r,i,n){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=n,this.deferred=new rt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,n){let s=new n5(e,t,Date.now()+r,i,n);return s.start(r),s}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new re(t9.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}class n8{constructor(){this.queries=n7(),this.onlineState="Unknown",this.Ca=new Set}terminate(){var e;let t;e=new re(t9.ABORTED,"Firestore shutting down"),t=this.queries,this.queries=n7(),t.forEach((t,r)=>{for(let t of r.Sa)t.onError(e)})}}function n7(){return new iF(e=>iM(e),iL)}(I=b||(b={})).Ma="default",I.Cache="cache";class n9{constructor(e,t,r,i,n,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=n,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new iF(e=>iM(e),iL),this.Iu=new Map,this.Eu=new Set,this.du=new rD(rw.comparator),this.Au=new Map,this.Ru=new nb,this.Vu={},this.mu=new Map,this.fu=ng.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return!0===this.gu}}function se(e,t,r){var i;if(e.isPrimaryClient&&0===r||!e.isPrimaryClient&&1===r){let r,n=[];e.Tu.forEach((e,r)=>{let i=r.view.va(t);i.snapshot&&n.push(i.snapshot)}),(i=e.eventManager).onlineState=t,r=!1,i.queries.forEach((e,i)=>{for(let e of i.Sa)e.va(t)&&(r=!0)}),r&&i.Ca.forEach(e=>{e.next()}),n.length&&e.Pu.H_(n),e.onlineState=t,e.isPrimaryClient&&e.sharedClientState.setOnlineState(t)}}async function st(e,t,r){let i=[],n=[],s=[];e.Tu.isEmpty()||(e.Tu.forEach((a,o)=>{s.push(e.pu(o,t,r).then(t=>{if((t||r)&&e.isPrimaryClient){let i=t?!t.fromCache:r?.targetChanges.get(o.targetId)?.current;e.sharedClientState.updateQueryState(o.targetId,i?"current":"not-current")}if(t){i.push(t);let e=nO.As(o.targetId,t);n.push(e)}}))}),await Promise.all(s),e.Pu.H_(i),await async function(e,t){try{await e.persistence.runTransaction("notifyLocalViewChanges","readwrite",r=>rA.forEach(t,t=>rA.forEach(t.Es,i=>e.persistence.referenceDelegate.addReference(r,t.targetId,i)).next(()=>rA.forEach(t.ds,i=>e.persistence.referenceDelegate.removeReference(r,t.targetId,i)))))}catch(e){if(!rk(e))throw e;t2("LocalStore","Failed to update sequence numbers: "+e)}for(let r of t){let t=r.targetId;if(!r.fromCache){let r=e.Ms.get(t),i=r.snapshotVersion,n=r.withLastLimboFreeSnapshotVersion(i);e.Ms=e.Ms.insert(t,n)}}}(e.localStore,n))}async function sr(e,t){if(!e.currentUser.isEqual(t)){t2("SyncEngine","User change. New user:",t.toKey());let r=await nL(e.localStore,t);e.currentUser=t,e.mu.forEach(e=>{e.forEach(e=>{e.reject(new re(t9.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.mu.clear(),e.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),await st(e,r.Ls)}}class si{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=new na(e.databaseInfo.databaseId,!0),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){var t,r;return t=this.persistence,r=new nD,new nx(t,r,e.initialUser,this.serializer)}Cu(e){return new nk(nN.mi,this.serializer)}Du(e){return new nU}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}si.provider={build:()=>new si};class sn{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>se(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=sr.bind(null,this.syncEngine),await n4(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new n8}createDatastore(e){var t;let r=new na(e.databaseInfo.databaseId,!0),i=new nG(e.databaseInfo);return t=e.authCredentials,new nY(t,e.appCheckCredentials,i,r)}createRemoteStore(e){var t,r;return t=this.localStore,r=this.datastore,new n1(t,r,e.asyncQueue,e=>se(this.syncEngine,e,0),nj.v()?new nj:new nV)}createSyncEngine(e,t){var r,i,n,s,a,o;let l;return r=this.localStore,i=this.remoteStore,n=this.eventManager,s=this.sharedClientState,a=e.initialUser,o=e.maxConcurrentLimboResolutions,l=new n9(r,i,n,s,a,o),t&&(l.gu=!0),l}async terminate(){await async function(e){t2(n0,"RemoteStore shutting down."),e.Ea.add(5),await n6(e),e.Aa.shutdown(),e.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}sn.provider={build:()=>new sn};let ss=new Map,sa="firestore.googleapis.com";class so{constructor(e){if(void 0===e.host){if(void 0!==e.ssl)throw new re(t9.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=sa,this.ssl=!0}else this.host=e.host,this.ssl=e.ssl??!0;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=0x2800000;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new re(t9.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,r,i){if(!0===t&&!0===i)throw new re(t9.INVALID_ARGUMENT,`${e} and ${r} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=function(e){let t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}(e.experimentalLongPollingOptions??{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new re(t9.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new re(t9.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new re(t9.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){var t,r;return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(t=this.experimentalLongPollingOptions,r=e.experimentalLongPollingOptions,t.timeoutSeconds===r.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class sl{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new so({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new re(t9.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new re(t9.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new so(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new ri;switch(e.type){case"firstParty":return new ro(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new re(t9.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){let e;return(e=ss.get(this))&&(t2("ComponentProvider","Removing Datastore"),ss.delete(this),e.terminate()),Promise.resolve()}}class sh{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new sh(this.firestore,e,this._query)}}class su{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new sc(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new su(this.firestore,e,this._key)}toJSON(){return{type:su._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(rb(t,su._jsonSchema))return new su(e,r||null,new rw(ry.fromString(t.referencePath)))}}su._jsonSchemaVersion="firestore/documentReference/1.0",su._jsonSchema={type:rE("string",su._jsonSchemaVersion),referencePath:rE("string")};class sc extends sh{constructor(e,t,r){super(e,t,new iN(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new su(this.firestore,null,new rw(e))}withConverter(e){return new sc(this.firestore,e,this._path)}}let sd="AsyncQueue";class sf{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new nX(this,"async_queue_retry"),this._c=()=>{let e=nJ();e&&t2(sd,"Visibility state changed to "+e.visibilityState),this.M_.w_()},this.ac=e;const t=nJ();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;let t=nJ();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});let t=new rt;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(0!==this.Xu.length){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!rk(e))throw e;t2(sd,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){let t=this.ac.then(()=>(this.rc=!0,e().catch(e=>{throw this.nc=e,this.rc=!1,t6("INTERNAL UNHANDLED ERROR: ",sp(e)),e}).then(e=>(this.rc=!1,e))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);let i=n5.createAndSchedule(this,e,t,r,e=>this.hc(e));return this.tc.push(i),i}uc(){this.nc&&t5(47125,{Pc:sp(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(let t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{for(let t of(this.tc.sort((e,t)=>e.targetTimeMs-t.targetTimeMs),this.tc))if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){let t=this.tc.indexOf(e);this.tc.splice(t,1)}}function sp(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}class sg extends sl{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new sf,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new sf(e),this._firestoreClient=void 0,await e}}}class sm{constructor(e){this._byteString=e}static fromBase64String(e){try{return new sm(rj.fromBase64String(e))}catch(e){throw new re(t9.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new sm(rj.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:sm._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(rb(e,sm._jsonSchema))return sm.fromBase64String(e.bytes)}}sm._jsonSchemaVersion="firestore/bytes/1.0",sm._jsonSchema={type:rE("string",sm._jsonSchemaVersion),bytes:rE("string")};class sy{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new re(t9.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new r_(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class sv{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new re(t9.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new re(t9.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return rc(this._lat,e._lat)||rc(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:sv._jsonSchemaVersion}}static fromJSON(e){if(rb(e,sv._jsonSchema))return new sv(e.latitude,e.longitude)}}sv._jsonSchemaVersion="firestore/geoPoint/1.0",sv._jsonSchema={type:rE("string",sv._jsonSchemaVersion),latitude:rE("number"),longitude:rE("number")};class s_{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}(this._values,e._values)}toJSON(){return{type:s_._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(rb(e,s_._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new s_(e.vectorValues);throw new re(t9.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}s_._jsonSchemaVersion="firestore/vectorValue/1.0",s_._jsonSchema={type:rE("string",s_._jsonSchemaVersion),vectorValues:rE("object")};let sw=RegExp("[~\\*/\\[\\]]");function sE(e,t,r,i,n){let s=i&&!i.isEmpty(),a=void 0!==n,o=`Function ${t}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${i}`),a&&(l+=` in document ${n}`),l+=")"),new re(t9.INVALID_ARGUMENT,o+e+l)}class sb{constructor(e,t,r,i,n){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=n}get id(){return this._key.path.lastSegment()}get ref(){return new su(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){let e=new sI(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(sT("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class sI extends sb{data(){return super.data()}}function sT(e,t){return"string"==typeof t?function(e,t,r){if(t.search(sw)>=0)throw sE(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,void 0);try{return new sy(...t.split("."))._internalPath}catch(r){throw sE(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,void 0)}}(e,t):t instanceof sy?t._internalPath:t._delegate._internalPath}class sS{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class sC extends sb{constructor(e,t,r,i,n,s){super(e,t,r,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=n}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new sA(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(sT("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new re(t9.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=sC._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()&&(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),this._firestore,this.ref.path,t.bundle="NOT SUPPORTED"),t}}sC._jsonSchemaVersion="firestore/documentSnapshot/1.0",sC._jsonSchema={type:rE("string",sC._jsonSchemaVersion),bundleSource:rE("string","DocumentSnapshot"),bundleName:rE("string"),bundle:rE("string")};class sA extends sC{data(e={}){return super.data(e)}}class sk{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new sS(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new sA(this._firestore,this._userDataWriter,r.key,r,new sS(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new re(t9.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(r=>{let i=new sA(e._firestore,e._userDataWriter,r.doc.key,r.doc,new sS(e._snapshot.mutatedKeys.has(r.doc.key),e._snapshot.fromCache),e.query.converter);return r.doc,{type:"added",doc:i,oldIndex:-1,newIndex:t++}})}{let r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{let i=new sA(e._firestore,e._userDataWriter,t.doc.key,t.doc,new sS(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),n=-1,s=-1;return 0!==t.type&&(n=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(s=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:function(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return t5(61501,{type:e})}}(t.type),doc:i,oldIndex:n,newIndex:s}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new re(t9.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=sk._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ru.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],r=[],i=[];return this.docs.forEach(e=>{null!==e._document&&(t.push(e._document),r.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),i.push(e.ref.path))}),this._firestore,this.query._query,e.bundleName,e.bundle="NOT SUPPORTED",e}}function sR(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}sk._jsonSchemaVersion="firestore/querySnapshot/1.0",sk._jsonSchema={type:rE("string",sk._jsonSchemaVersion),bundleSource:rE("string","QuerySnapshot"),bundleName:rE("string"),bundle:rE("string")},new WeakMap,function(e=!0){tZ=eJ,eV(new es("firestore",(t,{instanceIdentifier:r,options:i})=>{let n=t.getProvider("app").getImmediate(),s=new sg(new rs(t.getProvider("auth-internal")),new rh(n,t.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new re(t9.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new rY(e.options.projectId,t)}(n,r),n);return i={useFetchStreams:e,...i},s._setSettings(i),s},"PUBLIC").setMultipleInstances(!0)),e1(tX,tQ,void 0),e1(tX,tQ,"esm2020")}();let sN=new J("auth","Firebase",sR()),sO=new ep("@firebase/auth");function sP(e,...t){sO.logLevel<=l.ERROR&&sO.error(`Auth (${eJ}): ${e}`,...t)}function sD(e,...t){throw sU(e,...t)}function sx(e,...t){return sU(e,...t)}function sL(e,t,r){return new J("auth","Firebase",{...sR(),[t]:r}).create(t,{appName:e.name})}function sM(e){return sL(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function sU(e,...t){if("string"!=typeof e){let r=t[0],i=[...t.slice(1)];return i[0]&&(i[0].appName=e.name),e._errorFactory.create(r,...i)}return sN.create(e,...t)}function sV(e,t,...r){if(!e)throw sU(t,...r)}function sF(e){let t="INTERNAL ASSERTION FAILED: "+e;throw sP(t),Error(t)}function sj(){return"undefined"!=typeof self&&self.location?.href||""}function sB(){return"undefined"!=typeof self&&self.location?.protocol||null}class s${constructor(e,t){var r;this.shortDelay=e,this.longDelay=t,r="Short delay should be less than long delay!",t>e||sF(r),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(K())||"object"==typeof navigator&&"ReactNative"===navigator.product}get(){let e;return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===sB()||"https:"===sB()||"object"==typeof(e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==e.id||"connection"in navigator))||navigator.onLine?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function sH(e,t){var r,i;r=e.emulator,i="Emulator should always be set here",r||sF(i);let{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class sz{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void sF("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void sF("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void sF("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}let sq={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},sK=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],sW=new s$(3e4,6e4);function sG(e,t){return e.tenantId&&!t.tenantId?{...t,tenantId:e.tenantId}:t}async function sJ(e,t,r,i,n={}){return sX(e,n,async()=>{let n={},s={};i&&("GET"===t?s=i:n={body:JSON.stringify(i)});let a=Z({key:e.config.apiKey,...s}).slice(1),o=await e._getAdditionalHeaders();o["Content-Type"]="application/json",e.languageCode&&(o["X-Firebase-Locale"]=e.languageCode);let l={method:t,headers:o,...n};return("undefined"==typeof navigator||"Cloudflare-Workers"!==navigator.userAgent)&&(l.referrerPolicy="no-referrer"),e.emulatorConfig&&j(e.emulatorConfig.host)&&(l.credentials="include"),sz.fetch()(await sY(e,e.config.apiHost,r,a),l)})}async function sX(e,t,r){e._canInitEmulator=!1;let i={...sq,...t};try{let t=new sZ(e),n=await Promise.race([r(),t.promise]);t.clearNetworkTimeout();let s=await n.json();if("needConfirmation"in s)throw s0(e,"account-exists-with-different-credential",s);if(n.ok&&!("errorMessage"in s))return s;{let[t,r]=(n.ok?s.errorMessage:s.error.message).split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===t)throw s0(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===t)throw s0(e,"email-already-in-use",s);if("USER_DISABLED"===t)throw s0(e,"user-disabled",s);let a=i[t]||t.toLowerCase().replace(/[_\s]+/g,"-");if(r)throw sL(e,a,r);sD(e,a)}}catch(t){if(t instanceof G)throw t;sD(e,"network-request-failed",{message:String(t)})}}async function sQ(e,t,r,i,n={}){let s=await sJ(e,t,r,i,n);return"mfaPendingCredential"in s&&sD(e,"multi-factor-auth-required",{_serverResponse:s}),s}async function sY(e,t,r,i){let n=`${t}${r}?${i}`,s=e.config.emulator?sH(e.config,n):`${e.config.apiScheme}://${n}`;return sK.includes(r)&&(await e._persistenceManagerAvailable,"COOKIE"===e._getPersistenceType())?e._getPersistence()._getFinalTarget(s).toString():s}class sZ{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(sx(this.auth,"network-request-failed")),sW.get())})}}function s0(e,t,r){let i={appName:e.name};r.email&&(i.email=r.email),r.phoneNumber&&(i.phoneNumber=r.phoneNumber);let n=sx(e,t,i);return n.customData._tokenResponse=r,n}function s1(e){return void 0!==e&&void 0!==e.enterprise}class s2{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)switch(t.enforcementState){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function s6(e,t){return sJ(e,"GET","/v2/recaptchaConfig",sG(e,t))}async function s3(e,t){return sJ(e,"POST","/v1/accounts:delete",t)}async function s4(e,t){return sJ(e,"POST","/v1/accounts:lookup",t)}function s5(e){if(e)try{let t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}async function s8(e,t=!1){let r=en(e),i=await r.getIdToken(t),n=s9(i);sV(n&&n.exp&&n.auth_time&&n.iat,r.auth,"internal-error");let s="object"==typeof n.firebase?n.firebase:void 0,a=s?.sign_in_provider;return{claims:n,token:i,authTime:s5(s7(n.auth_time)),issuedAtTime:s5(s7(n.iat)),expirationTime:s5(s7(n.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}}function s7(e){return 1e3*Number(e)}function s9(e){let[t,r,i]=e.split(".");if(void 0===t||void 0===r||void 0===i)return sP("JWT malformed, contained fewer than 3 sections"),null;try{let e=D(r);if(!e)return sP("Failed to decode base64 JWT payload"),null;return JSON.parse(e)}catch(e){return sP("Caught error parsing JWT payload as JSON",e?.toString()),null}}function ae(e){let t=s9(e);return sV(t,"internal-error"),sV(void 0!==t.exp,"internal-error"),sV(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function at(e,t,r=!1){if(r)return t;try{return await t}catch(t){throw t instanceof G&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class ar{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){if(!e)return this.errorBackoff=3e4,Math.max(0,(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5);{let e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class ai{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=s5(this.lastLoginAt),this.creationTime=s5(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function an(e){var t,r;let i=e.auth,n=await e.getIdToken(),s=await at(e,s4(i,{idToken:n}));sV(s?.users.length,i,"internal-error");let a=s.users[0];e._notifyReloadListener(a);let o=a.providerUserInfo?.length?aa(a.providerUserInfo):[],l=(t=e.providerData,r=o,[...t.filter(e=>!r.some(t=>t.providerId===e.providerId)),...r]),h=e.isAnonymous,u=!(e.email&&a.passwordHash)&&!l?.length;Object.assign(e,{uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new ai(a.createdAt,a.lastLoginAt),isAnonymous:!!h&&u})}async function as(e){let t=en(e);await an(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function aa(e){return e.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function ao(e,t){let r=await sX(e,{},async()=>{let r=Z({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:n}=e.config,s=await sY(e,i,"/v1/token",`key=${n}`),a=await e._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";let o={method:"POST",headers:a,body:r};return e.emulatorConfig&&j(e.emulatorConfig.host)&&(o.credentials="include"),sz.fetch()(s,o)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function al(e,t){return sJ(e,"POST","/v2/accounts:revokeToken",sG(e,t))}class ah{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){sV(e.idToken,"internal-error"),sV(void 0!==e.idToken,"internal-error"),sV(void 0!==e.refreshToken,"internal-error");let t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):ae(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){sV(0!==e.length,"internal-error");let t=ae(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return t||!this.accessToken||this.isExpired?(sV(this.refreshToken,e,"user-token-expired"),this.refreshToken)?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:r,refreshToken:i,expiresIn:n}=await ao(e,t);this.updateTokensAndExpiration(r,i,Number(n))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*r}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:n}=t,s=new ah;return r&&(sV("string"==typeof r,"internal-error",{appName:e}),s.refreshToken=r),i&&(sV("string"==typeof i,"internal-error",{appName:e}),s.accessToken=i),n&&(sV("number"==typeof n,"internal-error",{appName:e}),s.expirationTime=n),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ah,this.toJSON())}_performRefresh(){return sF("not implemented")}}function au(e,t){sV("string"==typeof e||void 0===e,"internal-error",{appName:t})}class ac{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new ar(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new ai(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){let t=await at(this,this.stsTokenManager.getToken(this.auth,e));return sV(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return s8(this,e)}reload(){return as(this)}_assign(e){this!==e&&(sV(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>({...e})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new ac({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){sV(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await an(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(eH(this.auth.app))return Promise.reject(sM(this.auth));let e=await this.getIdToken();return await at(this,s3(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){let r=t.displayName??void 0,i=t.email??void 0,n=t.phoneNumber??void 0,s=t.photoURL??void 0,a=t.tenantId??void 0,o=t._redirectEventId??void 0,l=t.createdAt??void 0,h=t.lastLoginAt??void 0,{uid:u,emailVerified:c,isAnonymous:d,providerData:f,stsTokenManager:p}=t;sV(u&&p,e,"internal-error");let g=ah.fromJSON(this.name,p);sV("string"==typeof u,e,"internal-error"),au(r,e.name),au(i,e.name),sV("boolean"==typeof c,e,"internal-error"),sV("boolean"==typeof d,e,"internal-error"),au(n,e.name),au(s,e.name),au(a,e.name),au(o,e.name),au(l,e.name),au(h,e.name);let m=new ac({uid:u,auth:e,email:i,emailVerified:c,displayName:r,isAnonymous:d,photoURL:s,phoneNumber:n,tenantId:a,stsTokenManager:g,createdAt:l,lastLoginAt:h});return f&&Array.isArray(f)&&(m.providerData=f.map(e=>({...e}))),o&&(m._redirectEventId=o),m}static async _fromIdTokenResponse(e,t,r=!1){let i=new ah;i.updateFromServerResponse(t);let n=new ac({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await an(n),n}static async _fromGetAccountInfoResponse(e,t,r){let i=t.users[0];sV(void 0!==i.localId,"internal-error");let n=void 0!==i.providerUserInfo?aa(i.providerUserInfo):[],s=!(i.email&&i.passwordHash)&&!n?.length,a=new ah;a.updateFromIdToken(r);let o=new ac({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:s});return Object.assign(o,{uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:n,metadata:new ai(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!n?.length}),o}}let ad=new Map;function af(e){var t,r;t="Expected a class definition",e instanceof Function||sF(t);let i=ad.get(e);return i?(r="Instance stored in cache mismatched with class",i instanceof e||sF(r)):(i=new e,ad.set(e,i)),i}class ap{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){let t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}function ag(e,t,r){return`firebase:${e}:${t}:${r}`}ap.type="NONE";class am{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:n}=this.auth;this.fullUserKey=ag(this.userKey,i.apiKey,n),this.fullPersistenceKey=ag("persistence",i.apiKey,n),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"==typeof e){let t=await s4(this.auth,{idToken:e}).catch(()=>void 0);return t?ac._fromGetAccountInfoResponse(this.auth,t,e):null}return ac._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new am(af(ap),e,r);let i=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e),n=i[0]||af(ap),s=ag(r,e.config.apiKey,e.name),a=null;for(let r of t)try{let t=await r._get(s);if(t){let i;if("string"==typeof t){let r=await s4(e,{idToken:t}).catch(()=>void 0);if(!r)break;i=await ac._fromGetAccountInfoResponse(e,r,t)}else i=ac._fromJSON(e,t);r!==n&&(a=i),n=r;break}}catch{}let o=i.filter(e=>e._shouldAllowMigration);return n._shouldAllowMigration&&o.length&&(n=o[0],a&&await n._set(s,a.toJSON()),await Promise.all(t.map(async e=>{if(e!==n)try{await e._remove(s)}catch{}}))),new am(n,e,r)}}function ay(e){let t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";{if(aE(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(av(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(aI(t))return"Blackberry";if(aT(t))return"Webos";if(a_(t))return"Safari";if((t.includes("chrome/")||aw(t))&&!t.includes("edge/"))return"Chrome";if(ab(t))return"Android";let r=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(r?.length===2)return r[1]}return"Other"}function av(e=K()){return/firefox\//i.test(e)}function a_(e=K()){let t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function aw(e=K()){return/crios\//i.test(e)}function aE(e=K()){return/iemobile/i.test(e)}function ab(e=K()){return/android/i.test(e)}function aI(e=K()){return/blackberry/i.test(e)}function aT(e=K()){return/webos/i.test(e)}function aS(e=K()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function aC(e=K()){return aS(e)||ab(e)||aT(e)||aI(e)||/windows phone/i.test(e)||aE(e)}function aA(e,t=[]){let r;switch(e){case"Browser":r=ay(K());break;case"Worker":r=`${ay(K())}-${e}`;break;default:r=e}let i=t.length?t.join(","):"FirebaseCore-web";return`${r}/JsCore/${eJ}/${i}`}class ak{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=t=>new Promise((r,i)=>{try{let i=e(t);r(i)}catch(e){i(e)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(e){for(let e of(t.reverse(),t))try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:e?.message})}}}async function aR(e,t={}){return sJ(e,"GET","/v2/passwordPolicy",sG(e,t))}class aN{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??6,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),void 0!==t.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),void 0!==t.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),void 0!==t.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),void 0!==t.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){let t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){let r;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,n){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=n))}}class aO{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new aP(this),this.idTokenSubscription=new aP(this),this.beforeStateQueue=new ak(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=sN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=af(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted){if(this.persistenceManager=await am.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,this._deleted||(this._isInitialized=!0)}}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(this.currentUser||e){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let t=await s4(this,{idToken:e}),r=await ac._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(eH(this.app)){let e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}let t=await this.assertedPersistence.getCurrentUser(),r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let t=this.redirectUser?._redirectEventId,n=r?._redirectEventId,s=await this.tryRedirectSignIn(e);(!t||t===n)&&s?.user&&(r=s.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(e){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(e))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return(sV(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId)?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await an(e)}catch(e){if(e?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;let e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(eH(this.app))return Promise.reject(sM(this));let t=e?en(e):null;return t&&sV(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&sV(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return eH(this.app)?Promise.reject(sM(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return eH(this.app)?Promise.reject(sM(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(af(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=new aN(await aR(this));null===this.tenantId?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new J("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){let t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await al(this,t)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){let r=await this.getOrInitRedirectPersistenceManager(t);return null===e?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&af(e)||this._popupRedirectResolver;sV(t,this,"argument-error"),this.redirectPersistenceManager=await am.create(this,[af(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return(this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e)?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let n="function"==typeof t?t:t.next.bind(t),s=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(sV(a,this,"internal-error"),a.then(()=>{s||n(this.currentUser)}),"function"==typeof t){let n=e.addObserver(t,r,i);return()=>{s=!0,n()}}{let r=e.addObserver(t);return()=>{s=!0,r()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return sV(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=aA(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){let e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);let t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);let r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(eH(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&function(e,...t){sO.logLevel<=l.WARN&&sO.warn(`Auth (${eJ}): ${e}`,...t)}(`Error while retrieving App Check token: ${e.error}`),e?.token}}class aP{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){let r=new er(e,void 0);return r.subscribe.bind(r)}(e=>this.observer=e)}get next(){return sV(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let aD={async loadJS(){throw Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function ax(e){return`__${e}${Math.floor(1e6*Math.random())}`}class aL{constructor(){this.enterprise=new aM}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class aM{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}let aU="NO_RECAPTCHA";class aV{constructor(e){this.type="recaptcha-enterprise",this.auth=en(e)}async verify(e="verify",t=!1){async function r(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,r)=>{s6(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(i=>{if(void 0===i.recaptchaKey)r(Error("recaptcha Enterprise site key undefined"));else{let r=new s2(i);return null==e.tenantId?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,t(r.siteKey)}}).catch(e=>{r(e)})})}function i(t,r,i){let n=window.grecaptcha;s1(n)?n.enterprise.ready(()=>{n.enterprise.execute(t,{action:e}).then(e=>{r(e)}).catch(()=>{r(aU)})}):i(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new aL().execute("siteKey",{action:"verify"}):new Promise((e,n)=>{r(this.auth).then(r=>{if(!t&&s1(window.grecaptcha))i(r,e,n);else{var s;if("undefined"==typeof window)return void n(Error("RecaptchaVerifier is only supported in browser"));let t=aD.recaptchaEnterpriseScript;0!==t.length&&(t+=r),(s=t,aD.loadJS(s)).then(()=>{i(r,e,n)}).catch(e=>{n(e)})}}).catch(e=>{n(e)})})}}async function aF(e,t,r,i=!1,n=!1){let s,a=new aV(e);if(n)s=aU;else try{s=await a.verify(r)}catch(e){s=await a.verify(r,!0)}let o={...t};if("mfaSmsEnrollment"===r||"mfaSmsSignIn"===r){if("phoneEnrollmentInfo"in o){let e=o.phoneEnrollmentInfo.phoneNumber,t=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){let e=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return i?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function aj(e,t,r,i,n){if("EMAIL_PASSWORD_PROVIDER"===n)if(!e._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER"))return i(e,t).catch(async n=>{if("auth/missing-recaptcha-token"!==n.code)return Promise.reject(n);{console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let n=await aF(e,t,r,"getOobCode"===r);return i(e,n)}});else{let n=await aF(e,t,r,"getOobCode"===r);return i(e,n)}if("PHONE_PROVIDER"!==n)return Promise.reject(n+" provider is not supported.");if(e._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){let n=await aF(e,t,r);return i(e,n).catch(async n=>{if(e._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")==="AUDIT"&&("auth/missing-recaptcha-token"===n.code||"auth/invalid-app-credential"===n.code)){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${r} flow.`);let n=await aF(e,t,r,!1,!0);return i(e,n)}return Promise.reject(n)})}{let n=await aF(e,t,r,!1,!0);return i(e,n)}}async function aB(e){let t=en(e),r=new s2(await s6(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}));null==t.tenantId?t._agentRecaptchaConfig=r:t._tenantRecaptchaConfigs[t.tenantId]=r,r.isAnyProviderEnabled()&&new aV(t).verify()}function a$(e){let t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function aH(e){if(!e)return null;let t=Number(e);return isNaN(t)?null:t}class az{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return sF("not implemented")}_getIdTokenResponse(e){return sF("not implemented")}_linkToIdToken(e,t){return sF("not implemented")}_getReauthenticationResolver(e){return sF("not implemented")}}async function aq(e,t){return sJ(e,"POST","/v1/accounts:signUp",t)}async function aK(e,t){return sQ(e,"POST","/v1/accounts:signInWithPassword",sG(e,t))}async function aW(e,t){return sQ(e,"POST","/v1/accounts:signInWithEmailLink",sG(e,t))}async function aG(e,t){return sQ(e,"POST","/v1/accounts:signInWithEmailLink",sG(e,t))}class aJ extends az{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new aJ(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new aJ(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t="string"==typeof e?JSON.parse(e):e;if(t?.email&&t?.password){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);else if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return aj(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",aK,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return aW(e,{email:this._email,oobCode:this._password});default:sD(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return aj(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",aq,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return aG(e,{idToken:t,email:this._email,oobCode:this._password});default:sD(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function aX(e,t){return sQ(e,"POST","/v1/accounts:signInWithIdp",sG(e,t))}class aQ extends az{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new aQ(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):sD("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let{providerId:t,signInMethod:r,...i}="string"==typeof e?JSON.parse(e):e;if(!t||!r)return null;let n=new aQ(t,r);return n.idToken=i.idToken||void 0,n.accessToken=i.accessToken||void 0,n.secret=i.secret,n.nonce=i.nonce,n.pendingToken=i.pendingToken||null,n}_getIdTokenResponse(e){return aX(e,this.buildRequest())}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,aX(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,aX(e,t)}buildRequest(){let e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Z(t)}return e}}async function aY(e,t){return sJ(e,"POST","/v1/accounts:sendVerificationCode",sG(e,t))}async function aZ(e,t){return sQ(e,"POST","/v1/accounts:signInWithPhoneNumber",sG(e,t))}async function a0(e,t){let r=await sQ(e,"POST","/v1/accounts:signInWithPhoneNumber",sG(e,t));if(r.temporaryProof)throw s0(e,"account-exists-with-different-credential",r);return r}let a1={USER_NOT_FOUND:"user-not-found"};async function a2(e,t){return sQ(e,"POST","/v1/accounts:signInWithPhoneNumber",sG(e,{...t,operation:"REAUTH"}),a1)}class a6 extends az{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new a6({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new a6({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return aZ(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return a0(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return a2(e,this._makeVerificationRequest())}_makeVerificationRequest(){let{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:i}}toJSON(){let e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));let{verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:n}=e;return r||t||i||n?new a6({verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:n}):null}}class a3{constructor(e){const t=ee(et(e)),r=t.apiKey??null,i=t.oobCode??null,n=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(t.mode??null);sV(r&&i&&n,"argument-error"),this.apiKey=r,this.operation=n,this.code=i,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){let t,r,i,n=(r=(t=ee(et(e)).link)?ee(et(t)).deep_link_id:null,((i=ee(et(e)).deep_link_id)?ee(et(i)).link:null)||i||r||t||e);try{return new a3(n)}catch{return null}}}class a4{constructor(){this.providerId=a4.PROVIDER_ID}static credential(e,t){return aJ._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){let r=a3.parseLink(t);return sV(r,"argument-error"),aJ._fromEmailAndCode(e,r.code,r.tenantId)}}a4.PROVIDER_ID="password",a4.EMAIL_PASSWORD_SIGN_IN_METHOD="password",a4.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class a5{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class a8 extends a5{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class a7 extends a8{constructor(){super("facebook.com")}static credential(e){return aQ._fromParams({providerId:a7.PROVIDER_ID,signInMethod:a7.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return a7.credentialFromTaggedObject(e)}static credentialFromError(e){return a7.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return a7.credential(e.oauthAccessToken)}catch{return null}}}a7.FACEBOOK_SIGN_IN_METHOD="facebook.com",a7.PROVIDER_ID="facebook.com";class a9 extends a8{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return aQ._fromParams({providerId:a9.PROVIDER_ID,signInMethod:a9.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return a9.credentialFromTaggedObject(e)}static credentialFromError(e){return a9.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return a9.credential(t,r)}catch{return null}}}a9.GOOGLE_SIGN_IN_METHOD="google.com",a9.PROVIDER_ID="google.com";class oe extends a8{constructor(){super("github.com")}static credential(e){return aQ._fromParams({providerId:oe.PROVIDER_ID,signInMethod:oe.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return oe.credentialFromTaggedObject(e)}static credentialFromError(e){return oe.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return oe.credential(e.oauthAccessToken)}catch{return null}}}oe.GITHUB_SIGN_IN_METHOD="github.com",oe.PROVIDER_ID="github.com";class ot extends a8{constructor(){super("twitter.com")}static credential(e,t){return aQ._fromParams({providerId:ot.PROVIDER_ID,signInMethod:ot.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ot.credentialFromTaggedObject(e)}static credentialFromError(e){return ot.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return ot.credential(t,r)}catch{return null}}}ot.TWITTER_SIGN_IN_METHOD="twitter.com",ot.PROVIDER_ID="twitter.com";class or{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){return new or({user:await ac._fromIdTokenResponse(e,r,i),providerId:oi(r),_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){return await e._updateTokensIfNecessary(r,!0),new or({user:e,providerId:oi(r),_tokenResponse:r,operationType:t})}}function oi(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class on extends G{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,on.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new on(e,t,r,i)}}function os(e,t,r,i){return("reauthenticate"===t?r._getReauthenticationResolver(e):r._getIdTokenResponse(e)).catch(r=>{if("auth/multi-factor-auth-required"===r.code)throw on._fromErrorAndOperation(e,r,t,i);throw r})}async function oa(e,t,r=!1){let i=await at(e,t._linkToIdToken(e.auth,await e.getIdToken()),r);return or._forOperation(e,"link",i)}async function oo(e,t,r=!1){let{auth:i}=e;if(eH(i.app))return Promise.reject(sM(i));let n="reauthenticate";try{let s=await at(e,os(i,n,t,e),r);sV(s.idToken,i,"internal-error");let a=s9(s.idToken);sV(a,i,"internal-error");let{sub:o}=a;return sV(e.uid===o,i,"user-mismatch"),or._forOperation(e,n,s)}catch(e){throw e?.code==="auth/user-not-found"&&sD(i,"user-mismatch"),e}}async function ol(e,t,r=!1){if(eH(e.app))return Promise.reject(sM(e));let i="signIn",n=await os(e,i,t),s=await or._fromIdTokenResponse(e,i,n);return r||await e._updateCurrentUser(s.user),s}class oh{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?ou._fromServerResponse(e,t):"totpInfo"in t?oc._fromServerResponse(e,t):sD(e,"internal-error")}}class ou extends oh{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new ou(t)}}class oc extends oh{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new oc(t)}}function od(e,t){return sJ(e,"POST","/v2/accounts/mfaEnrollment:start",sG(e,t))}new WeakMap;let of="__sak";class op{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{if(!this.storage)return Promise.resolve(!1);return this.storage.setItem(of,"1"),this.storage.removeItem(of),Promise.resolve(!0)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class og extends op{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=aC(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(let t of Object.keys(this.listeners)){let r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){let r;if(!e.key)return void this.forAllChangedKeys((e,t,r)=>{this.notifyListeners(e,r)});let i=e.key;t?this.detachListener():this.stopPolling();let n=()=>{let e=this.storage.getItem(i);(t||this.localCache[i]!==e)&&this.notifyListeners(i,e)},s=this.storage.getItem(i);((r=K()).indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0)&&10===document.documentMode&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(n,10):n()}notifyListeners(e,t){this.localCache[e]=t;let r=this.listeners[e];if(r)for(let e of Array.from(r))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){let t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}og.type="LOCAL";class om extends op{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}om.type="SESSION";class oy{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){let t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;let r=new oy(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){let{eventId:t,eventType:r,data:i}=e.data,n=this.handlersMap[r];if(!n?.size)return;e.ports[0].postMessage({status:"ack",eventId:t,eventType:r});let s=Array.from(n).map(async t=>t(e.origin,i)),a=await Promise.all(s.map(async e=>{try{let t=await e;return{fulfilled:!0,value:t}}catch(e){return{fulfilled:!1,reason:e}}}));e.ports[0].postMessage({status:"done",eventId:t,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function ov(e="",t=10){let r="";for(let e=0;e<t;e++)r+=Math.floor(10*Math.random());return e+r}oy.receivers=[];class o_{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){let i,n,s="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!s)throw Error("connection_unavailable");return new Promise((a,o)=>{let l=ov("",20);s.port1.start();let h=setTimeout(()=>{o(Error("unsupported_event"))},r);n={messageChannel:s,onMessage(e){if(e.data.eventId===l)switch(e.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{o(Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(e.data.response);break;default:clearTimeout(h),clearTimeout(i),o(Error("invalid_response"))}}},this.handlers.add(n),s.port1.addEventListener("message",n.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[s.port2])}).finally(()=>{n&&this.removeMessageHandler(n)})}}function ow(){return window}function oE(){return void 0!==ow().WorkerGlobalScope&&"function"==typeof ow().importScripts}async function ob(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}let oI="firebaseLocalStorageDb",oT="firebaseLocalStorage",oS="fbase_key";class oC{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function oA(e,t){return e.transaction([oT],t?"readwrite":"readonly").objectStore(oT)}function ok(){let e=indexedDB.open(oI,1);return new Promise((t,r)=>{e.addEventListener("error",()=>{r(e.error)}),e.addEventListener("upgradeneeded",()=>{let t=e.result;try{t.createObjectStore(oT,{keyPath:oS})}catch(e){r(e)}}),e.addEventListener("success",async()=>{let r=e.result;r.objectStoreNames.contains(oT)?t(r):(r.close(),await new oC(indexedDB.deleteDatabase(oI)).toPromise(),t(await ok()))})})}async function oR(e,t,r){return new oC(oA(e,!0).put({[oS]:t,value:r})).toPromise()}async function oN(e,t){let r=oA(e,!1).get(t),i=await new oC(r).toPromise();return void 0===i?null:i.value}function oO(e,t){return new oC(oA(e,!0).delete(t)).toPromise()}class oP{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await ok()),this.db}async _withRetries(e){let t=0;for(;;)try{let t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return oE()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=oy._getInstance(oE()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await ob(),!this.activeServiceWorker)return;this.sender=new o_(this.activeServiceWorker);let e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&(navigator?.serviceWorker?.controller||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;let e=await ok();return await oR(e,of,"1"),await oO(e,of),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>oR(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){let t=await this._withRetries(t=>oN(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>oO(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){let e=await this._withRetries(e=>new oC(oA(e,!1).getAll()).toPromise());if(!e||0!==this.pendingWrites)return[];let t=[],r=new Set;if(0!==e.length)for(let{fbase_key:i,value:n}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(n)&&(this.notifyListeners(i,n),t.push(i));for(let e of Object.keys(this.localCache))this.localCache[e]&&!r.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;let r=this.listeners[e];if(r)for(let e of Array.from(r))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}function oD(e,t){return sJ(e,"POST","/v2/accounts/mfaSignIn:start",sG(e,t))}oP.type="LOCAL",ax("rcb"),new s$(3e4,6e4);let ox="recaptcha";async function oL(e,t,r){if(!e._getRecaptchaConfig())try{await aB(e)}catch(e){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let i;if(i="string"==typeof t?{phoneNumber:t}:t,"session"in i){let t=i.session;if("phoneNumber"in i){sV("enroll"===t.type,e,"internal-error");let n={idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},s=async(e,t)=>{if(t.phoneEnrollmentInfo.captchaResponse===aU){sV(r?.type===ox,e,"argument-error");let i=await oM(e,t,r);return od(e,i)}return od(e,t)},a=aj(e,n,"mfaSmsEnrollment",s,"PHONE_PROVIDER");return(await a.catch(e=>Promise.reject(e))).phoneSessionInfo.sessionInfo}{sV("signin"===t.type,e,"internal-error");let n=i.multiFactorHint?.uid||i.multiFactorUid;sV(n,e,"missing-multi-factor-info");let s={mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},a=async(e,t)=>{if(t.phoneSignInInfo.captchaResponse===aU){sV(r?.type===ox,e,"argument-error");let i=await oM(e,t,r);return oD(e,i)}return oD(e,t)},o=aj(e,s,"mfaSmsSignIn",a,"PHONE_PROVIDER");return(await o.catch(e=>Promise.reject(e))).phoneResponseInfo.sessionInfo}}{let t={phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"},n=async(e,t)=>{if(t.captchaResponse===aU){sV(r?.type===ox,e,"argument-error");let i=await oM(e,t,r);return aY(e,i)}return aY(e,t)},s=aj(e,t,"sendVerificationCode",n,"PHONE_PROVIDER");return(await s.catch(e=>Promise.reject(e))).sessionInfo}}finally{r?._reset()}}async function oM(e,t,r){sV(r.type===ox,e,"argument-error");let i=await r.verify();sV("string"==typeof i,e,"argument-error");let n={...t};if("phoneEnrollmentInfo"in n){let e=n.phoneEnrollmentInfo.phoneNumber,t=n.phoneEnrollmentInfo.captchaResponse,r=n.phoneEnrollmentInfo.clientType,s=n.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(n,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:i,captchaResponse:t,clientType:r,recaptchaVersion:s}}),n}if(!("phoneSignInInfo"in n))return Object.assign(n,{recaptchaToken:i}),n;{let e=n.phoneSignInInfo.captchaResponse,t=n.phoneSignInInfo.clientType,r=n.phoneSignInInfo.recaptchaVersion;return Object.assign(n,{phoneSignInInfo:{recaptchaToken:i,captchaResponse:e,clientType:t,recaptchaVersion:r}}),n}}class oU{constructor(e){this.providerId=oU.PROVIDER_ID,this.auth=en(e)}verifyPhoneNumber(e,t){return oL(this.auth,e,en(t))}static credential(e,t){return a6._fromVerification(e,t)}static credentialFromResult(e){return oU.credentialFromTaggedObject(e)}static credentialFromError(e){return oU.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{phoneNumber:t,temporaryProof:r}=e;return t&&r?a6._fromTokenResponse(t,r):null}}oU.PROVIDER_ID="phone",oU.PHONE_SIGN_IN_METHOD="phone";class oV extends az{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return aX(e,this._buildIdpRequest())}_linkToIdToken(e,t){return aX(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return aX(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function oF(e){return ol(e.auth,new oV(e),e.bypassAuthState)}function oj(e){let{auth:t,user:r}=e;return sV(r,t,"internal-error"),oo(r,new oV(e),e.bypassAuthState)}async function oB(e){let{auth:t,user:r}=e;return sV(r,t,"internal-error"),oa(r,new oV(e),e.bypassAuthState)}class o${constructor(e,t,r,i,n=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=n,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}})}async onAuthEvent(e){let{urlResponse:t,sessionId:r,postBody:i,tenantId:n,error:s,type:a}=e;if(s)return void this.reject(s);let o={auth:this.auth,requestUri:t,sessionId:r,tenantId:n||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(o))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return oF;case"linkViaPopup":case"linkViaRedirect":return oB;case"reauthViaPopup":case"reauthViaRedirect":return oj;default:sD(this.auth,"internal-error")}}resolve(e){var t,r;t=this.pendingPromise,r="Pending promise was never set",t||sF(r),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){var t,r;t=this.pendingPromise,r="Pending promise was never set",t||sF(r),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}let oH=new s$(2e3,1e4);class oz extends o${constructor(e,t,r,i,n){super(e,t,i,n),this.provider=r,this.authWindow=null,this.pollId=null,oz.currentPopupAction&&oz.currentPopupAction.cancel(),oz.currentPopupAction=this}async executeNotNull(){let e=await this.execute();return sV(e,this.auth,"internal-error"),e}async onExecution(){var e,t;e=1===this.filter.length,t="Popup operations only handle one event",e||sF(t);let r=ov();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],r),this.authWindow.associatedEvent=r,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(sx(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(sx(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,oz.currentPopupAction=null}pollUserCancellation(){let e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(sx(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,oH.get())};e()}}oz.currentPopupAction=null;let oq=new Map;class oK extends o${constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=oq.get(this.auth._key());if(!e){try{let t=await oW(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}oq.set(this.auth._key(),e)}return this.bypassAuthState||oq.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"===e.type)return void this.resolve(null);if(e.eventId){let t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function oW(e,t){var r;let i=ag("pendingRedirect",(r=t).config.apiKey,r.name),n=af(e._redirectPersistence);if(!await n._isAvailable())return!1;let s=await n._get(i)==="true";return await n._remove(i),s}function oG(e,t){oq.set(e._key(),t)}async function oJ(e,t,r=!1){if(eH(e.app))return Promise.reject(sM(e));let i=en(e),n=t?af(t):(sV(i._popupRedirectResolver,i,"argument-error"),i._popupRedirectResolver),s=new oK(i,n,r),a=await s.execute();return a&&!r&&(delete a.user._redirectEventId,await i._persistUserIfCurrent(a.user),await i._setRedirectUser(null,t)),a}class oX{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return oY(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!oY(e)){let r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(sx(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(oQ(e))}saveEventToCache(e){this.cachedEventUids.add(oQ(e)),this.lastProcessedEventTime=Date.now()}}function oQ(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function oY({type:e,error:t}){return"unknown"===e&&t?.code==="auth/no-auth-event"}async function oZ(e,t={}){return sJ(e,"GET","/v1/projects",t)}let o0=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,o1=/^https?/;async function o2(e){if(e.config.emulator)return;let{authorizedDomains:t}=await oZ(e);for(let e of t)try{if(function(e){let t=sj(),{protocol:r,hostname:i}=new URL(t);if(e.startsWith("chrome-extension://")){let n=new URL(e);return""===n.hostname&&""===i?"chrome-extension:"===r&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===r&&n.hostname===i}if(!o1.test(r))return!1;if(o0.test(e))return i===e;let n=e.replace(/\./g,"\\.");return RegExp("^(.+\\."+n+"|"+n+")$","i").test(i)}(e))return}catch{}sD(e,"unauthorized-domain")}let o6=new s$(3e4,6e4);function o3(){let e=ow().___jsl;if(e?.H){for(let t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}}let o4=null,o5=new s$(5e3,15e3),o8={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},o7=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);async function o9(e){let t,r,i,n,s,a=await (o4=o4||new Promise((t,r)=>{function i(){o3(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{o3(),r(sx(e,"network-request-failed"))},timeout:o6.get()})}if(ow().gapi?.iframes?.Iframe)t(gapi.iframes.getContext());else if(ow().gapi?.load)i();else{var n;let t=ax("iframefcb");return ow()[t]=()=>{gapi.load?i():r(sx(e,"network-request-failed"))},(n=`${aD.gapiScript}?onload=${t}`,aD.loadJS(n)).catch(e=>r(e))}}).catch(e=>{throw o4=null,e})),o=ow().gapi;return sV(o,e,"internal-error"),a.open({where:document.body,url:(sV((t=e.config).authDomain,e,"auth-domain-config-required"),r=t.emulator?sH(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,i={apiKey:t.apiKey,appName:e.name,v:eJ},(n=o7.get(e.config.apiHost))&&(i.eid=n),(s=e._getFrameworks()).length&&(i.fw=s.join(",")),`${r}?${Z(i).slice(1)}`),messageHandlersFilter:o.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:o8,dontclear:!0},t=>new Promise(async(r,i)=>{await t.restyle({setHideOnLeave:!1});let n=sx(e,"network-request-failed"),s=ow().setTimeout(()=>{i(n)},o5.get());function a(){ow().clearTimeout(s),r(t)}t.ping(a).then(a,()=>{i(n)})}))}let le={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class lt{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}let lr=encodeURIComponent("fac");async function li(e,t,r,i,n,s){sV(e.config.authDomain,e,"auth-domain-config-required"),sV(e.config.apiKey,e,"invalid-api-key");let a={apiKey:e.config.apiKey,appName:e.name,authType:r,redirectUrl:i,v:eJ,eventId:n};if(t instanceof a5)for(let[r,i]of(t.setDefaultLanguage(e.languageCode),a.providerId=t.providerId||"",!function(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())&&(a.customParameters=JSON.stringify(t.getCustomParameters())),Object.entries(s||{})))a[r]=i;if(t instanceof a8){let e=t.getScopes().filter(e=>""!==e);e.length>0&&(a.scopes=e.join(","))}for(let t of(e.tenantId&&(a.tid=e.tenantId),Object.keys(a)))void 0===a[t]&&delete a[t];let o=await e._getAppCheckToken(),l=o?`#${lr}=${encodeURIComponent(o)}`:"";return`${function({config:e}){return e.emulator?sH(e,"emulator/auth/handler"):`https://${e.authDomain}/__/auth/handler`}(e)}?${Z(a).slice(1)}${l}`}let ln="webStorageSupport",ls=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=om,this._completeRedirectFn=oJ,this._overrideRedirectResult=oG}async _openPopup(e,t,r,i){var n,s;n=this.eventManagers[e._key()]?.manager,s="_initialize() not called before _openPopup()",n||sF(s);let a=await li(e,t,r,sj(),i);return function(e,t,r,i=500,n=600){let s=Math.max((window.screen.availHeight-n)/2,0).toString(),a=Math.max((window.screen.availWidth-i)/2,0).toString(),o="",l={...le,width:i.toString(),height:n.toString(),top:s,left:a},h=K().toLowerCase();r&&(o=aw(h)?"_blank":r),av(h)&&(t=t||"http://localhost",l.scrollbars="yes");let u=Object.entries(l).reduce((e,[t,r])=>`${e}${t}=${r},`,"");if(function(e=K()){return aS(e)&&!!window.navigator?.standalone}(h)&&"_self"!==o){var c,d;let e,r;return c=t||"",d=o,(e=document.createElement("a")).href=c,e.target=d,(r=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),e.dispatchEvent(r),new lt(null)}let f=window.open(t||"",o,u);sV(f,e,"popup-blocked");try{f.focus()}catch(e){}return new lt(f)}(e,a,ov())}async _openRedirect(e,t,r,i){var n;return await this._originValidation(e),n=await li(e,t,r,sj(),i),ow().location.href=n,new Promise(()=>{})}_initialize(e){let t=e._key();if(this.eventManagers[t]){var r;let{manager:e,promise:i}=this.eventManagers[t];return e?Promise.resolve(e):(r="If manager is not set, promise should be",i||sF(r),i)}let i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){let t=await o9(e),r=new oX(e);return t.register("authEvent",t=>(sV(t?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(t.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(ln,{type:ln},r=>{let i=r?.[0]?.[ln];void 0!==i&&t(!!i),sD(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=o2(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return aC()||a_()||aS()}};var la="@firebase/auth",lo="1.11.1";class ll{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return(this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser)?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(t=>{e(t?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){sV(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}let lh=V("authIdTokenMaxAge")||300,lu=null;aD={loadJS:e=>new Promise((t,r)=>{let i=document.createElement("script");i.setAttribute("src",e),i.onload=t,i.onerror=e=>{let t=sx("internal-error");t.customData=e,r(t)},i.type="text/javascript",i.charset="UTF-8",(document.getElementsByTagName("head")?.[0]??document).appendChild(i)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},o="Browser",eV(new es("auth",(e,{options:t})=>{let r,i,n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:l,authDomain:h}=n.options;sV(l&&!l.includes(":"),"invalid-api-key",{appName:n.name});let u=new aO(n,s,a,{apiKey:l,authDomain:h,clientPlatform:o,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:aA(o)});return i=(Array.isArray(r=t?.persistence||[])?r:[r]).map(af),t?.errorMap&&u._updateErrorMap(t.errorMap),u._initializeWithPersistence(i,t?.popupRedirectResolver),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),eV(new es("auth-internal",e=>new ll(en(e.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),e1(la,lo,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(o)),e1(la,lo,"esm2020"),e.s([],58556),e.i(58556);let lc=eZ().length?eY():eX({apiKey:"AIzaSyAJI3SYJGTx7RshdX8OXG8v2T6KMKyGMLk",authDomain:"planpath-458b1.firebaseapp.com",projectId:"planpath-458b1",storageBucket:"planpath-458b1.firebasestorage.app",messagingSenderId:"272519881718",appId:"1:272519881718:web:136859f0c4d81dcf6c5dd7",measurementId:"G-T4Q4HMJMYF"});var ld=lc;let lf=eF("object"==typeof ld?ld:eY(),"firestore").getImmediate({identifier:"string"==typeof ld?ld:rQ});if(!lf._initialized){let e=M("firestore");e&&function(e,t,r,i={}){e=function(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new re(t9.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let r=function(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{var t;let r=(t=e).constructor?t.constructor.name:null;return r?`a custom ${r} object`:"an object"}}return"function"==typeof e?"a function":t5(12329,{type:typeof e})}(e);throw new re(t9.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${r}`)}}return e}(e,sl);let n=j(t),s=e._getSettings(),a={...s,emulatorOptions:e._getEmulatorOptions()},o=`${t}:${r}`;n&&(B(`https://${o}`),q("Firestore",!0)),s.host!==sa&&s.host!==o&&t3("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let l={...s,host:o,ssl:n,emulatorOptions:i};if(!Q(l,a)&&(e._setSettings(l),i.mockUserToken)){let t,r;if("string"==typeof i.mockUserToken)t=i.mockUserToken,r=tY.MOCK_USER;else{t=$(i.mockUserToken,e._app?.options.projectId);let n=i.mockUserToken.sub||i.mockUserToken.user_id;if(!n)throw new re(t9.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");r=new tY(n)}e._authCredentials=new rn(new rr(t,r))}}(lf,...e)}let lp=function(e=eY(),t){let r=eF(e=en(e),tH).getImmediate({identifier:void 0}),i=M("storage");return i&&function(e,t,r,i={}){!function(e,t,r,i={}){e.host=`${t}:${r}`;let n=j(t);n&&(B(`https://${e.host}/b`),q("Storage",!0)),e._isUsingEmulator=!0,e._protocol=n?"https":"http";let{mockUserToken:s}=i;s&&(e._overrideAuthToken="string"==typeof s?s:$(s,e.app.options.projectId))}(e,t,r,i)}(r,...i),r}(lc);function lg(){let[e,t]=(0,S.useState)(""),[r,i]=(0,S.useState)(""),[n,s]=(0,S.useState)(""),[a,o]=(0,S.useState)(null),[l,h]=(0,S.useState)(!1),[u,c]=(0,S.useState)(""),[d,f]=(0,S.useState)(null),p=e=>{e.split("/");let t="California",r="General",i="General";return e.includes("California Building Code")&&(t="California"),e.includes("LA County")&&(r="Los Angeles"),e.includes("El Segundo")&&(i="El Segundo"),{state:t,county:r,city:i}},g=async e=>{if(e.preventDefault(),!d||0===d.length)return;h(!0),c(`Uploading ${d.length} files...`);let t=0,r=0;for(let e=0;e<d.length;e++){let i=d[e];c(`Uploading ${e+1}/${d.length}: ${i.name}...`);let n=i.webkitRelativePath||i.name;if(i.name.startsWith("."))continue;let{state:s,county:a,city:o}=p(n),l=`knowledge-base/${s}/${a}/${o}/${i.name}`;try{let e=tq(lp,l);await tz(e,i),t++}catch(e){console.error(`Failed to upload ${i.name}`,e),r++}}c(`Upload complete: ${t} successful, ${r} failed.`),h(!1),f(null)},m=async t=>{if(t.preventDefault(),a&&e){h(!0),c("");try{let t=`knowledge-base/${e}/${r||"General"}/${n||"General"}/${a.name}`,i=tq(lp,t);await tz(i,a),c(`Successfully uploaded ${a.name} to ${t}`),o(null)}catch(e){console.error(e),c("Error uploading file. Check console for details.")}finally{h(!1)}}};return(0,T.jsx)("div",{className:"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,T.jsxs)("div",{className:"max-w-4xl mx-auto space-y-8",children:[(0,T.jsxs)("div",{className:"bg-white rounded-xl shadow-md overflow-hidden p-8",children:[(0,T.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Bulk Upload Codes Folder"}),(0,T.jsx)("p",{className:"text-gray-600 mb-4",children:'Select the root "Codes" folder. The system will automatically map "California", "LA County", and "El Segundo" folders to the correct hierarchy.'}),(0,T.jsxs)("form",{onSubmit:g,className:"space-y-4",children:[(0,T.jsx)("div",{children:(0,T.jsx)("input",{type:"file",webkitdirectory:"",directory:"",multiple:!0,onChange:e=>f(e.target.files),className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"})}),(0,T.jsx)("button",{type:"submit",disabled:l||!d,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:bg-gray-400",children:l?"Uploading Folder...":"Upload All Files"})]})]}),(0,T.jsxs)("div",{className:"bg-white rounded-xl shadow-md overflow-hidden p-8",children:[(0,T.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Single File Upload"}),(0,T.jsxs)("form",{onSubmit:m,className:"space-y-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"State"}),(0,T.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 border p-2",placeholder:"e.g. New York",required:!0})]}),(0,T.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"County (Optional)"}),(0,T.jsx)("input",{type:"text",value:r,onChange:e=>i(e.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 border p-2",placeholder:"e.g. Kings"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"City (Optional)"}),(0,T.jsx)("input",{type:"text",value:n,onChange:e=>s(e.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 border p-2",placeholder:"e.g. New York City"})]})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Document (PDF/Text)"}),(0,T.jsx)("input",{type:"file",onChange:e=>o(e.target.files?.[0]||null),className:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100",required:!0})]}),(0,T.jsx)("button",{type:"submit",disabled:l,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:l?"Uploading...":"Upload to Knowledge Base"})]}),u&&(0,T.jsx)("div",{className:`mt-4 p-4 rounded-md ${u.includes("Error")?"bg-red-50 text-red-700":"bg-green-50 text-green-700"}`,children:u})]})]})})}!function(e=eY()){let t=eF(e,"auth");if(t.isInitialized())return t.getImmediate();let r=function(e,t){let r=eF(e,"auth");if(r.isInitialized()){let e=r.getImmediate();if(Q(r.getOptions(),t??{}))return e;sD(e,"already-initialized")}return r.initialize({options:t})}(e,{popupRedirectResolver:ls,persistence:[oP,og,om]}),i=V("authTokenSyncURL");if(i&&"boolean"==typeof isSecureContext&&isSecureContext){let e=new URL(i,location.origin);if(location.origin===e.origin){let t,i=(t=e.toString(),async e=>{let r=e&&await e.getIdTokenResult(),i=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(i&&i>lh)return;let n=r?.token;lu!==n&&(lu=n,await fetch(t,{method:n?"POST":"DELETE",headers:n?{Authorization:`Bearer ${n}`}:{}}))});en(r).beforeAuthStateChanged(i,()=>i(r.currentUser)),en(r).onIdTokenChanged(e=>i(e),void 0,void 0)}}let n=L("auth");n&&function(e,t,r){let i=en(e);sV(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");let n=a$(t),{host:s,port:a}=function(e){let t=a$(e),r=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!r)return{host:"",port:null};let i=r[2].split("@").pop()||"",n=/^(\[[^\]]+\])(:|$)/.exec(i);if(n){let e=n[1];return{host:e,port:aH(i.substr(e.length+1))}}{let[e,t]=i.split(":");return{host:e,port:aH(t)}}}(t),o=null===a?"":`:${a}`,l={url:`${n}//${s}${o}/`},h=Object.freeze({host:s,port:a,protocol:n.replace(":",""),options:Object.freeze({disableWarnings:!1})});if(!i._canInitEmulator){sV(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),sV(Q(l,i.config.emulator)&&Q(h,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=l,i.emulatorConfig=h,i.settings.appVerificationDisabledForTesting=!0,j(s)?(B(`${n}//${s}${o}`),q("Auth",!0)):function(){function e(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}(r,`http://${n}`)}(lc),e.s(["default",()=>lg],72906)}]);