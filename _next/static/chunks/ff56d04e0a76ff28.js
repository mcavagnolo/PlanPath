(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,33525,(e,t,l)=>{"use strict";Object.defineProperty(l,"__esModule",{value:!0}),Object.defineProperty(l,"warnOnce",{enumerable:!0,get:function(){return s}});let s=e=>{}},72906,e=>{"use strict";var t=e.i(43476),l=e.i(71645),s=e.i(57688);e.i(61086);var r=e.i(27215),a=e.i(59141),i=e.i(39447);let n=({node:e,onDelete:l,onAddFolder:s})=>"file"===e.type?".keep"===e.name?null:(0,t.jsxs)("div",{className:"pl-6 py-1 text-sm text-gray-600 flex items-center gap-2 group",children:[(0,t.jsx)("span",{className:"opacity-50",children:"ðŸ“„"}),(0,t.jsx)("span",{className:"flex-1 truncate",children:e.name}),(0,t.jsx)("button",{onClick:()=>l(e.path,"file"),className:"opacity-0 group-hover:opacity-100 text-red-500 hover:text-red-700 p-1",title:"Delete File",children:"ðŸ—‘ï¸"})]}):(0,t.jsxs)("details",{className:"pl-2",children:[(0,t.jsxs)("summary",{className:"cursor-pointer py-1 text-sm font-medium text-gray-800 hover:text-blue-600 select-none flex items-center gap-2 group",children:[(0,t.jsx)("span",{children:"ðŸ“"}),(0,t.jsx)("span",{className:"flex-1",children:e.name}),(0,t.jsxs)("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100",children:[(0,t.jsx)("button",{onClick:t=>{t.preventDefault(),s(e.path)},className:"text-green-600 hover:text-green-800 p-1",title:"Add Subfolder",children:"âž•"}),(0,t.jsx)("button",{onClick:t=>{t.preventDefault(),l(e.path,"folder")},className:"text-red-500 hover:text-red-700 p-1",title:"Delete Folder",children:"ðŸ—‘ï¸"})]})]}),(0,t.jsxs)("div",{className:"border-l border-gray-200 ml-2.5",children:[e.children?.map(e=>(0,t.jsx)(n,{node:e,onDelete:l,onAddFolder:s},e.path)),e.children?.length===0&&(0,t.jsx)("div",{className:"pl-6 py-1 text-xs text-gray-400 italic",children:"Empty folder"})]})]});function o(){let[e,o]=(0,l.useState)(null),[d,c]=(0,l.useState)(!1),[u,m]=(0,l.useState)(""),[x,h]=(0,l.useState)([]),[f,g]=(0,l.useState)(!1),[p,b]=(0,l.useState)(""),[y,j]=(0,l.useState)(""),[v,N]=(0,l.useState)(""),[w,C]=(0,l.useState)(""),[k,P]=(0,l.useState)({states:[],counties:[],cities:[]});(0,l.useEffect)(()=>{(0,i.fetchJurisdictionOptions)().then(P)},[]);let[S,$]=(0,l.useState)(null),F=e=>{switch(e){case"State":return k.states;case"County":return k.counties;case"City":return k.cities;default:return[]}},A=async e=>{let t=(0,r.ref)(a.storage,e);try{let e=await (0,r.listAll)(t),l=[];for(let t of e.prefixes)l.push({name:t.name,path:t.fullPath,type:"folder",children:await A(t.fullPath)});for(let t of e.items)l.push({name:t.name,path:t.fullPath,type:"file"});return l}catch(e){return console.error("Error fetching file tree:",e),[]}},B=()=>{g(!0),A("knowledge-base").then(e=>h(e)).finally(()=>g(!1))};(0,l.useEffect)(()=>{B()},[]);let D=async e=>{if(e.preventDefault(),!S||0===S.length)return;if(!v||!w)return void alert("Please select a destination folder.");c(!0),m(`Uploading ${S.length} files...`);let t=0,l=0;for(let e=0;e<S.length;e++){let s=S[e];m(`Uploading ${e+1}/${S.length}: ${s.name}...`);let i=s.webkitRelativePath||s.name;if(s.name.startsWith("."))continue;let n=`knowledge-base/${v}/${w}/${i}`;try{let e=(0,r.ref)(a.storage,n);await (0,r.uploadBytes)(e,s),t++}catch(e){console.error(`Failed to upload ${s.name}`,e),l++}}m(`Upload complete: ${t} successful, ${l} failed.`),c(!1),$(null),B()},U=async t=>{if(t.preventDefault(),e&&p&&y){c(!0),m("");try{let t=`knowledge-base/${p}/${y}/${e.name}`,l=(0,r.ref)(a.storage,t);await (0,r.uploadBytes)(l,e),m(`Successfully uploaded ${e.name} to ${t}`),o(null),B()}catch(e){console.error(e),m("Error uploading file. Check console for details.")}finally{c(!1)}}},E=async e=>{let t=(0,r.ref)(a.storage,e),l=await (0,r.listAll)(t);for(let e of l.prefixes)await E(e.fullPath);for(let e of l.items)await (0,r.deleteObject)(e)},O=async(e,t)=>{if(confirm(`Are you sure you want to delete this ${t}?`)){g(!0);try{"file"===t?await (0,r.deleteObject)((0,r.ref)(a.storage,e)):await E(e),m(`${"file"===t?"File":"Folder"} deleted successfully.`),B()}catch(e){console.error(e),m(`Error deleting ${t}.`)}finally{g(!1)}}},K=async e=>{let t=prompt("Enter new folder name:");if(!t)return;let l=t.replace(/[^a-zA-Z0-9 -]/g,"").trim();if(!l)return void alert("Invalid folder name.");g(!0);try{let t=(0,r.ref)(a.storage,`${e}/${l}/.keep`);await (0,r.uploadBytes)(t,new Blob(["placeholder"])),m(`Folder "${l}" created.`),B()}catch(e){console.error(e),m("Error creating folder.")}finally{g(!1)}};return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)("header",{className:"bg-[#fff9ea] shadow-sm",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8 flex items-center justify-between",children:[(0,t.jsx)("div",{className:"flex items-center",children:(0,t.jsx)(s.default,{src:"/PlanPath/logos/PlanPath Logo wName (Horizontal).png",alt:"PlanPath Logo",width:200,height:50,className:"h-12 w-auto",priority:!0})}),(0,t.jsxs)("nav",{children:[(0,t.jsx)("a",{href:"/PlanPath/",className:"text-gray-500 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium",children:"Home"}),(0,t.jsx)("a",{href:"#",className:"text-gray-500 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium",children:"Documentation"})]})]})}),(0,t.jsx)("main",{className:"py-12 px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Knowledge Base Administration"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-md overflow-hidden p-8",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Bulk Upload Codes Folder"}),(0,t.jsxs)("form",{onSubmit:D,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Category"}),(0,t.jsxs)("select",{value:v,onChange:e=>{N(e.target.value),C("")},className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 border p-2",required:!0,children:[(0,t.jsx)("option",{value:"",children:"Select Category"}),(0,t.jsx)("option",{value:"State",children:"State"}),(0,t.jsx)("option",{value:"County",children:"County"}),(0,t.jsx)("option",{value:"City",children:"City"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Jurisdiction"}),(0,t.jsxs)("select",{value:w,onChange:e=>C(e.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 border p-2",required:!0,disabled:!v,children:[(0,t.jsx)("option",{value:"",children:"Select Jurisdiction"}),F(v).map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Folder"}),(0,t.jsx)("input",{type:"file",webkitdirectory:"",directory:"",multiple:!0,onChange:e=>$(e.target.files),className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"})]}),(0,t.jsx)("button",{type:"submit",disabled:d||!S||!v||!w,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:bg-gray-400",children:d?"Uploading Folder...":"Upload All Files"})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-md overflow-hidden p-8",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Single File Upload"}),(0,t.jsxs)("form",{onSubmit:U,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Category"}),(0,t.jsxs)("select",{value:p,onChange:e=>{b(e.target.value),j("")},className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 border p-2",required:!0,children:[(0,t.jsx)("option",{value:"",children:"Select Category"}),(0,t.jsx)("option",{value:"State",children:"State"}),(0,t.jsx)("option",{value:"County",children:"County"}),(0,t.jsx)("option",{value:"City",children:"City"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Jurisdiction"}),(0,t.jsxs)("select",{value:y,onChange:e=>j(e.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 border p-2",required:!0,disabled:!p,children:[(0,t.jsx)("option",{value:"",children:"Select Jurisdiction"}),F(p).map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Document (PDF/Text)"}),(0,t.jsx)("input",{type:"file",onChange:e=>o(e.target.files?.[0]||null),className:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100",required:!0})]}),(0,t.jsx)("button",{type:"submit",disabled:d,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:d?"Uploading...":"Upload to Knowledge Base"})]})]}),u&&(0,t.jsx)("div",{className:`p-4 rounded-md ${u.includes("Error")?"bg-red-50 text-red-700":"bg-green-50 text-green-700"}`,children:u})]}),(0,t.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-md h-fit",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Knowledge Base Files"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>K("knowledge-base"),className:"text-sm text-green-600 hover:text-green-800 underline",disabled:f,children:"+ New Root Folder"}),(0,t.jsx)("span",{className:"text-gray-300",children:"|"}),(0,t.jsx)("button",{onClick:B,className:"text-sm text-blue-600 hover:text-blue-800 underline",disabled:f,children:f?"Refreshing...":"Refresh"})]})]}),(0,t.jsx)("div",{className:"border rounded-md p-4 bg-gray-50 min-h-[400px] max-h-[800px] overflow-y-auto",children:f&&0===x.length?(0,t.jsx)("div",{className:"text-center text-gray-500 py-8",children:"Loading files..."}):0===x.length?(0,t.jsx)("div",{className:"text-center text-gray-500 py-8",children:"No files found in Knowledge Base"}):x.map(e=>(0,t.jsx)(n,{node:e,onDelete:O,onAddFolder:K},e.path))})]})]})]})}),(0,t.jsx)("footer",{className:"bg-[#fff9ea] border-t border-gray-200 mt-12",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8 flex flex-col items-center",children:[(0,t.jsx)(s.default,{src:"/PlanPath/logos/PlanPath Logo.png",alt:"PlanPath Icon",width:32,height:32,className:"h-8 w-8 mb-2"}),(0,t.jsx)("p",{className:"text-center text-sm text-gray-500",children:"Â© 2025 PlanPath. All rights reserved."})]})})]})}e.s(["default",()=>o])}]);