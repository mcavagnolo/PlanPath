(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,33525,(e,l,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"warnOnce",{enumerable:!0,get:function(){return s}});let s=e=>{}},72906,e=>{"use strict";var l=e.i(43476),t=e.i(71645),s=e.i(57688);e.i(61086);var a=e.i(27215),r=e.i(59141),n=e.i(39447);let i=({node:e,onDelete:t,onAddFolder:s})=>"file"===e.type?".keep"===e.name?null:(0,l.jsxs)("div",{className:"pl-6 py-1 text-sm text-gray-600 flex items-center gap-2 group",children:[(0,l.jsx)("span",{className:"opacity-50",children:"ðŸ“„"}),(0,l.jsx)("span",{className:"flex-1 truncate",children:e.name}),(0,l.jsx)("button",{onClick:()=>t(e.path,"file"),className:"opacity-0 group-hover:opacity-100 text-red-500 hover:text-red-700 p-1",title:"Delete File",children:"ðŸ—‘ï¸"})]}):(0,l.jsxs)("details",{className:"pl-2",children:[(0,l.jsxs)("summary",{className:"cursor-pointer py-1 text-sm font-medium text-gray-800 hover:text-blue-600 select-none flex items-center gap-2 group",children:[(0,l.jsx)("span",{children:"ðŸ“"}),(0,l.jsx)("span",{className:"flex-1",children:e.name}),(0,l.jsxs)("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100",children:[(0,l.jsx)("button",{onClick:l=>{l.preventDefault(),s(e.path)},className:"text-green-600 hover:text-green-800 p-1",title:"Add Subfolder",children:"âž•"}),(0,l.jsx)("button",{onClick:l=>{l.preventDefault(),t(e.path,"folder")},className:"text-red-500 hover:text-red-700 p-1",title:"Delete Folder",children:"ðŸ—‘ï¸"})]})]}),(0,l.jsxs)("div",{className:"border-l border-gray-200 ml-2.5",children:[e.children?.map(e=>(0,l.jsx)(i,{node:e,onDelete:t,onAddFolder:s},e.path)),e.children?.length===0&&(0,l.jsx)("div",{className:"pl-6 py-1 text-xs text-gray-400 italic",children:"Empty folder"})]})]});function o(){let[e,o]=(0,t.useState)(""),[d,c]=(0,t.useState)(""),[u,m]=(0,t.useState)(""),[x,f]=(0,t.useState)(null),[h,g]=(0,t.useState)(!1),[p,b]=(0,t.useState)(""),[y,j]=(0,t.useState)([]),[v,N]=(0,t.useState)(!1),[w,C]=(0,t.useState)({states:[],counties:[],cities:[]});(0,t.useEffect)(()=>{(0,n.fetchJurisdictionOptions)().then(C)},[]);let[P,S]=(0,t.useState)(null),k=e=>{let l="Uncategorized",t="General";return e.includes("California Building Code")?(l="State",t="California"):e.includes("LA County")?(l="County",t="Los Angeles"):e.includes("El Segundo")&&(l="City",t="El Segundo"),{category:l,jurisdiction:t}},$=async e=>{let l=(0,a.ref)(r.storage,e);try{let e=await (0,a.listAll)(l),t=[];for(let l of e.prefixes)t.push({name:l.name,path:l.fullPath,type:"folder",children:await $(l.fullPath)});for(let l of e.items)t.push({name:l.name,path:l.fullPath,type:"file"});return t}catch(e){return console.error("Error fetching file tree:",e),[]}},A=()=>{N(!0),$("knowledge-base").then(e=>j(e)).finally(()=>N(!1))};(0,t.useEffect)(()=>{A()},[]);let F=async e=>{if(e.preventDefault(),!P||0===P.length)return;g(!0),b(`Uploading ${P.length} files...`);let l=0,t=0;for(let e=0;e<P.length;e++){let s=P[e];b(`Uploading ${e+1}/${P.length}: ${s.name}...`);let n=s.webkitRelativePath||s.name;if(s.name.startsWith("."))continue;let{category:i,jurisdiction:o}=k(n),d=`knowledge-base/${i}/${o}/${s.name}`;try{let e=(0,a.ref)(r.storage,d);await (0,a.uploadBytes)(e,s),l++}catch(e){console.error(`Failed to upload ${s.name}`,e),t++}}b(`Upload complete: ${l} successful, ${t} failed.`),g(!1),S(null),A()},B=async l=>{if(l.preventDefault(),x&&e){g(!0),b("");try{let l=`knowledge-base/${e}/${d||"General"}/${u||"General"}/${x.name}`,t=(0,a.ref)(r.storage,l);await (0,a.uploadBytes)(t,x),b(`Successfully uploaded ${x.name} to ${l}`),f(null),A()}catch(e){console.error(e),b("Error uploading file. Check console for details.")}finally{g(!1)}}},E=async e=>{let l=(0,a.ref)(r.storage,e),t=await (0,a.listAll)(l);for(let e of t.prefixes)await E(e.fullPath);for(let e of t.items)await (0,a.deleteObject)(e)},U=async(e,l)=>{if(confirm(`Are you sure you want to delete this ${l}?`)){N(!0);try{"file"===l?await (0,a.deleteObject)((0,a.ref)(r.storage,e)):await E(e),b(`${"file"===l?"File":"Folder"} deleted successfully.`),A()}catch(e){console.error(e),b(`Error deleting ${l}.`)}finally{N(!1)}}},D=async e=>{let l=prompt("Enter new folder name:");if(!l)return;let t=l.replace(/[^a-zA-Z0-9 -]/g,"").trim();if(!t)return void alert("Invalid folder name.");N(!0);try{let l=(0,a.ref)(r.storage,`${e}/${t}/.keep`);await (0,a.uploadBytes)(l,new Blob(["placeholder"])),b(`Folder "${t}" created.`),A()}catch(e){console.error(e),b("Error creating folder.")}finally{N(!1)}};return(0,l.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,l.jsx)("header",{className:"bg-[#fff9ea] shadow-sm",children:(0,l.jsxs)("div",{className:"max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8 flex items-center justify-between",children:[(0,l.jsx)("div",{className:"flex items-center",children:(0,l.jsx)(s.default,{src:"/PlanPath/logos/PlanPath Logo wName (Horizontal).png",alt:"PlanPath Logo",width:200,height:50,className:"h-12 w-auto",priority:!0})}),(0,l.jsxs)("nav",{children:[(0,l.jsx)("a",{href:"/PlanPath/",className:"text-gray-500 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium",children:"Home"}),(0,l.jsx)("a",{href:"#",className:"text-gray-500 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium",children:"Documentation"})]})]})}),(0,l.jsx)("main",{className:"py-12 px-4 sm:px-6 lg:px-8",children:(0,l.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Knowledge Base Administration"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,l.jsxs)("div",{className:"space-y-8",children:[(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-md overflow-hidden p-8",children:[(0,l.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Bulk Upload Codes Folder"}),(0,l.jsx)("p",{className:"text-gray-600 mb-4",children:'Select the root "Codes" folder. The system will automatically map "California", "LA County", and "El Segundo" folders to the correct hierarchy.'}),(0,l.jsxs)("form",{onSubmit:F,className:"space-y-4",children:[(0,l.jsx)("div",{children:(0,l.jsx)("input",{type:"file",webkitdirectory:"",directory:"",multiple:!0,onChange:e=>S(e.target.files),className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"})}),(0,l.jsx)("button",{type:"submit",disabled:h||!P,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:bg-gray-400",children:h?"Uploading Folder...":"Upload All Files"})]})]}),(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-md overflow-hidden p-8",children:[(0,l.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Single File Upload"}),(0,l.jsxs)("form",{onSubmit:B,className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"State"}),(0,l.jsxs)("select",{value:e,onChange:e=>o(e.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 border p-2",required:!0,children:[(0,l.jsx)("option",{value:"",children:"Select State"}),w.states.map(e=>(0,l.jsx)("option",{value:e,children:e},e))]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"County (Optional)"}),(0,l.jsxs)("select",{value:d,onChange:e=>c(e.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 border p-2",children:[(0,l.jsx)("option",{value:"",children:"Select County"}),w.counties.map(e=>(0,l.jsx)("option",{value:e,children:e},e))]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"City (Optional)"}),(0,l.jsxs)("select",{value:u,onChange:e=>m(e.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 border p-2",children:[(0,l.jsx)("option",{value:"",children:"Select City"}),w.cities.map(e=>(0,l.jsx)("option",{value:e,children:e},e))]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Document (PDF/Text)"}),(0,l.jsx)("input",{type:"file",onChange:e=>f(e.target.files?.[0]||null),className:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100",required:!0})]}),(0,l.jsx)("button",{type:"submit",disabled:h,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:h?"Uploading...":"Upload to Knowledge Base"})]})]}),p&&(0,l.jsx)("div",{className:`p-4 rounded-md ${p.includes("Error")?"bg-red-50 text-red-700":"bg-green-50 text-green-700"}`,children:p})]}),(0,l.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-md h-fit",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,l.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Knowledge Base Files"}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("button",{onClick:()=>D("knowledge-base"),className:"text-sm text-green-600 hover:text-green-800 underline",disabled:v,children:"+ New Root Folder"}),(0,l.jsx)("span",{className:"text-gray-300",children:"|"}),(0,l.jsx)("button",{onClick:A,className:"text-sm text-blue-600 hover:text-blue-800 underline",disabled:v,children:v?"Refreshing...":"Refresh"})]})]}),(0,l.jsx)("div",{className:"border rounded-md p-4 bg-gray-50 min-h-[400px] max-h-[800px] overflow-y-auto",children:v&&0===y.length?(0,l.jsx)("div",{className:"text-center text-gray-500 py-8",children:"Loading files..."}):0===y.length?(0,l.jsx)("div",{className:"text-center text-gray-500 py-8",children:"No files found in Knowledge Base"}):y.map(e=>(0,l.jsx)(i,{node:e,onDelete:U,onAddFolder:D},e.path))})]})]})]})}),(0,l.jsx)("footer",{className:"bg-[#fff9ea] border-t border-gray-200 mt-12",children:(0,l.jsxs)("div",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8 flex flex-col items-center",children:[(0,l.jsx)(s.default,{src:"/PlanPath/logos/PlanPath Logo.png",alt:"PlanPath Icon",width:32,height:32,className:"h-8 w-8 mb-2"}),(0,l.jsx)("p",{className:"text-center text-sm text-gray-500",children:"Â© 2025 PlanPath. All rights reserved."})]})})]})}e.s(["default",()=>o])}]);